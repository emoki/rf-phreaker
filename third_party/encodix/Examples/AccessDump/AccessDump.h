/**************************************************************************
	Access Dump Example - (c) Dafocus 2007	
**************************************************************************/
#ifndef __ACCESS_DUMP_H
#define __ACCESS_DUMP_H
#include "ed_access.h"

/*=========================================================================
	Pointer to a table of custom access dump functions per type.
	If set to other than NULL, the dump functions there described are
	privileged on the default ones.
	The table must be terminated by an entry 
=========================================================================*/
struct TAccessDumpCustom {
	// Pointer to the TEDClassBase* generated by Encodix
	const TEDClassBase* const* ClassPointer;
	
	// Custom function to be called for that type
	void (*CustomAccessDump) (const TEDDataBase* Data, ostream& out, unsigned indent);
};

extern TAccessDumpCustom* AccessDumpCustomTable;

/*=========================================================================
	Executes the dump of a TEDDataBase using a custom implementation
=========================================================================*/
void AccessDump (const TEDDataBase* Data, ostream& out, unsigned indent=0, bool avoidCustom=false);

#define INDENT AccessDumpIndent(indent)
#define INDENTP(a) AccessDumpIndent(a)
class AccessDumpIndent {
	public:
		AccessDumpIndent (unsigned _indent): indent (_indent) {}
		unsigned indent;
};

inline ostream& operator<< (ostream& o, const AccessDumpIndent& k)
{
	unsigned i;
	for (i=0; i<k.indent; i++) o << "  ";
	return o;
}


#endif