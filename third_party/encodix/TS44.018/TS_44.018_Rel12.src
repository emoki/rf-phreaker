/****************************************************************************
	3GPP TS 44.018 V12.6.0 (2015-06)
	Parts that refer to 44.060 are taken from 3GPP TS 44.060 V12.5.0 (2015-06)
	Parts that refer to 24.008 are taken from 3GPP TS 24.008 V12.10.0 (2015-06)
	DAFOCUS INTERNAL REVISION 14144
****************************************************************************/

declare gsm-0407      message set RRDownlink;
declare gsm-0407      message set RRUplink;
declare gsm-0407-plen message set RRPLENDownlink;

`INCLUDE RR_short_Rel12.src`
`INCLUDE csn1lib.src`

/*-----------------------------------------------------------------------
		MESSAGE: ADDITIONAL ASSIGNMENT
		CHAPTER: TS 44.018 9.1.1
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 ADDITIONAL_ASSIGNMENT_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00111011;

		 ChannelDescription                   M V   3       TChDesc             ; # 10.5.2.5
	72 MobileAllocation                     C TLV 3-10    MobileAllocation    ; # 10.5.2.21
	7C StartingTime                         O TV  3       StartingTime        ; # 10.5.2.38
	6D ExtendedTSCSet                       O TV  2       ExtendedTSCSet      ; # 10.5.2.82
};


/*-----------------------------------------------------------------------
		MESSAGE: ASSIGNMENT COMMAND
		CHAPTER: TS 44.018 9.1.2
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 ASSIGNMENT_COMMAND_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00101110;

		 DescOfTheFirstChannelAfterTime       M V   3       TChDesc2            ; # 10.5.2.5a
		 PowerCommand                         M V   1       PowerCommand        ; # 10.5.2.28
	05 FrequencyListAfterTime               C TLV 4-132   CellChannel         ; # 10.5.2.13
	62 CellChannelDescription               O TV  17      CellChannel         ; # 10.5.2.1b
	10 DescriptionOfTheMultislotCfg         C TLV 3-12    binary              ; # 10.5.2.21b
	63 ModeOfTheFirstChannelChannelSet1     O TV  2       ChannelMode         ; # 10.5.2.6
	11 ModeOfChannelSet2                    O TV  2       ChannelMode         ; # 10.5.2.6
	13 ModeOfChannelSet3                    O TV  2       ChannelMode         ; # 10.5.2.6
	14 ModeOfChannelSet4                    O TV  2       ChannelMode         ; # 10.5.2.6
	15 ModeOfChannelSet5                    O TV  2       ChannelMode         ; # 10.5.2.6
	16 ModeOfChannelSet6                    O TV  2       ChannelMode         ; # 10.5.2.6
	17 ModeOfChannelSet7                    O TV  2       ChannelMode         ; # 10.5.2.6
	18 ModeOfChannelSet8                    O TV  2       ChannelMode         ; # 10.5.2.6
	64 DescOfTheSecondChannelAfterTime      O TV  4       TChDesc             ; # 10.5.2.5
	66 ModeOfTheSecondChannel               O TV  2       integer             ; # 10.5.2.7
	72 MobileAllocationAfterTime            C TLV 3-10    MobileAllocation    ; # 10.5.2.21
	7C StartingTime                         O TV  3       StartingTime        ; # 10.5.2.38
	19 FrequencyListBeforeTime              C TLV 4-132   CellChannel         ; # 10.5.2.13
	1C DescOfTheFirstChannelBeforeTime      O TV  4       TChDesc2            ; # 10.5.2.5a
	1D DescOfTheSecondChannelBeforeTime     O TV  4       TChDesc             ; # 10.5.2.5
	1E FrequencyChannelSequenceBeforeTime   C TV  10      FreqChannelSeq      ; # 10.5.2.12
	21 MobileAllocationBeforeTime           C TLV 3-10    MobileAllocation    ; # 10.5.2.21
	9- CipherModeSetting                    O TV  1       CipherModeSetting   ; # 10.5.2.9
	01 VgcsTargetModeIndication             O TLV 3       integer             ; # 10.5.2.42a
	03 MultiRateCfg                         O TLV 4-8     MultirateSpeechCfgIE; # 10.5.2.21aa
	04 VGCSCipheringParameters              O TLV 3-15    VGCSCipheringParameters; # 10.5.2.42b
	6D ExtendedTSCSetAfterTime              O TV  2       ExtendedTSCSet      ; # 10.5.2.82
	6E ExtendedTSCSetBeforeTime             O TV  2       ExtendedTSCSet      ; # 10.5.2.82
};


/*-----------------------------------------------------------------------
		MESSAGE: ASSIGNMENT COMPLETE
		CHAPTER: TS 44.018 9.1.3
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 ASSIGNMENT_COMPLETE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00101001;

		 RrCause                              M V   1       RRCause             ; # 10.5.2.31
};


/*-----------------------------------------------------------------------
		MESSAGE: ASSIGNMENT FAILURE
		CHAPTER: TS 44.018 9.1.4
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 ASSIGNMENT_FAILURE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00101111;

		 RrCause                              M V   1       RRCause             ; # 10.5.2.31
};


/*-----------------------------------------------------------------------
		MESSAGE: CHANNEL MODE MODIFY
		CHAPTER: TS 44.018 9.1.5
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 CHANNEL_MODE_MODIFY_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00010000;

		 ChannelDescription                   M V   3       TChDesc2            ; # 10.5.2.5a
		 ChannelMode                          M V   1       ChannelMode         ; # 10.5.2.6
	01 VgcsTargetModeIndication             O TLV 3       integer             ; # 10.5.2.42a
	03 MultiRateCfg                         O TLV 4-8     MultirateSpeechCfgIE; # 10.5.2.21aa
	04 VGCSCipheringParameters              O	TLV	3-15    VGCSCipheringParameters; # 10.5.2.42b
	6D ExtendedTSCSet                       O TV  2       ExtendedTSCSet      ; # 10.5.2.82
};


/*-----------------------------------------------------------------------
		MESSAGE: CHANNEL MODE MODIFY ACKNOWLEDGE
		CHAPTER: TS 44.018 9.1.6
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 CHANNEL_MODE_MODIFY_ACKNOWLEDGE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00010111;

		 ChannelDescription                   M V   3       TChDesc2            ; # 10.5.2.5a
		 ChannelMode                          M V   1       ChannelMode         ; # 10.5.2.6
	6D ExtendedTSCSet                       O TV  2       ExtendedTSCSet      ; # 10.5.2.82
};


/*-----------------------------------------------------------------------
		MESSAGE: CHANNEL RELEASE
		CHAPTER: TS 44.018 9.1.7
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 CHANNEL_RELEASE_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00001101;

		 RrCause                              M V   1       RRCause             ; # 10.5.2.31
	73 BaRange                              O TLV >=3     BaRange             ; # 10.5.2.1a
	74 GroupChannelDescription              O TLV 4-13    GrpChannelDesc      ; # 10.5.2.14b
	8- GroupCipherKeyNum                    C TV  1       integer             ; # 10.5.1.10
	C- GprsResumption                       O TV  1       GPRSResumption      ; # 10.5.2.14c
	75 BaListPref                           O TLV >=3     BA_List_Pref        ; # 10.5.2.1c
	76 UTRANFreqList                        O TLV >=3     UTRANFreqList       ; # 10.5.2.1d
	62 CellChannelDescription               O TV  17      CellChannel         ; # 10.5.2.1b
	77 CellSelIndAfterReleaseTCHandSDCCH	  O	TLV	>=4     CellSelIndAfterReleaseTCHandSDCCH; # 10.5.2.1e
	A- EnhancedDTMCSReleaseIndication				O	TV	1       integer             ; # 10.5.2.14e
	04 VGCSCipheringParameters              O	TLV	3-15    VGCSCipheringParameters; # 10.5.2.42b
	78 GroupChannelDescription2	            O TLV 13      GroupChannelDescription2; # 10.5.2.14f
	79 TalkerIdentity                       O TLV 3-20    TalkerIdentity      ; # 10.5.2.65
	7A TalkerPriorityStatus                 O TLV 3       TalkerPriorityStatus; # 10.5.2.64
	7B VGCSAMRConfiguration                 O TLV 3       VGCSAMRConfiguration; # 10.5.2.68
	7C IndividualPriorities                 O TLV >=3     IndividualPriorities; # 10.5.2.75
};


/*-----------------------------------------------------------------------
		MESSAGE: CHANNEL REQUEST
		CHAPTER: TS 44.018 9.1.8
		Received on RACH
-----------------------------------------------------------------------*/
dcl-type ChannelRequest {
	size 1 octet;
	type struct {
		# Actual message content
		MessageContent: octet;

		# Textual translation of the contents
		Description:  integer enum {
			 0 = "Emergency call"
			 1 = "Call re-establishment; TCH/F was in use, or TCH/H was in use but the network does not set NECI bit to 1"
			 2 = "Call re-establishment; TCH/H was in use and the network sets NECI bit to 1 "
			 3 = "Call re-establishment; TCH/H + TCH/H was in use and the network sets NECI bit to 1"
			 4 = "Answer to paging - Any channel"
			 5 = "Answer to paging - SDCCH"
			 6 = "Answer to paging - TCH/F"
			 7 = "Answer to paging - TCH/H or TCH/F"
			 8 = "Originating call and TCH/F is needed, or originating call and the network does not set NECI bit to 1, or procedures that can be completed with a SDCCH and the network does not set NECI bit to 1."
			 9 = "Originating speech call from dual rate mobile station when TCH/H is sufficient and supported by the MS for speech calls and the network sets NECI bit to 1."
			10 = "Originating data call from dual rate mobile station when TCH/H is sufficient and supported by the MS for data calls and the network sets NECI bit to 1."
			11 = "Location updating and the network does not set NECI bit to 1"
			12 = "Location updating and the network sets NECI bit to 1"
			13 = "Other procedures which can be completed with note 1an SDCCH and the network sets NECI bit to 1"
			14 = "One phase packet access with request for single timeslot uplink transmission; one PDCH is needed."
			15 = "Single block packet access; one block period on a PDCH is needed for two phase packet access or other RR signalling purpose."
			16 = "LMU establishment"
			17 = "Single block MBMS access; one block period on a PDCH is needed for transfer of MBMS SERVICE REQUEST message."
			default = "Reserved"
		};

		# Random reference field
		RandomReference: octet;
	}

  encode %{
		PUSH_INT (Source->MessageContent, 8);
		return 8;
  }%

  decode %{
  	Destin->MessageContent = (unsigned char)SHIFT_INT (8);
		if ((Destin->MessageContent & 0xE0) == 0xA0) {Destin->Description =  0; Destin->RandomReference = Destin->MessageContent & 0x1F;} /* Case 101xxxxx */
		else if ((Destin->MessageContent & 0xE0) == 0xC0) {Destin->Description =  1; Destin->RandomReference = Destin->MessageContent & 0x1F;} /* Case 110xxxxx */
		else if ((Destin->MessageContent & 0xFC) == 0x68) {Destin->Description =  2; Destin->RandomReference = Destin->MessageContent & 0x03;} /* Case 011010xx */
		else if ((Destin->MessageContent & 0xFC) == 0x6C) {Destin->Description =  3; Destin->RandomReference = Destin->MessageContent & 0x03;} /* Case 011011xx */
		else if ((Destin->MessageContent & 0xE0) == 0x80) {Destin->Description =  4; Destin->RandomReference = Destin->MessageContent & 0x1F;} /* Case 100xxxxx */
		else if ((Destin->MessageContent & 0xF0) == 0x10) {Destin->Description =  5; Destin->RandomReference = Destin->MessageContent & 0x0F;} /* Case 0001xxxx */
		else if ((Destin->MessageContent & 0xF0) == 0x20) {Destin->Description =  6; Destin->RandomReference = Destin->MessageContent & 0x0F;} /* Case 0010xxxx */
		else if ((Destin->MessageContent & 0xF0) == 0x30) {Destin->Description =  7; Destin->RandomReference = Destin->MessageContent & 0x0F;} /* Case 0011xxxx */
		else if ((Destin->MessageContent & 0xE0) == 0xE0) {Destin->Description =  8; Destin->RandomReference = Destin->MessageContent & 0x1F;} /* Case 111xxxxx */
		else if ((Destin->MessageContent & 0xF0) == 0x40) {Destin->Description =  9; Destin->RandomReference = Destin->MessageContent & 0x0F;} /* Case 0100xxxx */
		else if ((Destin->MessageContent & 0xF0) == 0x50) {Destin->Description = 10; Destin->RandomReference = Destin->MessageContent & 0x0F;} /* Case 0101xxxx */
		else if ((Destin->MessageContent & 0xE0) == 0x00) {Destin->Description = 11; Destin->RandomReference = Destin->MessageContent & 0x1F;} /* Case 000xxxxx */
		else if ((Destin->MessageContent & 0xF0) == 0x00) {Destin->Description = 12; Destin->RandomReference = Destin->MessageContent & 0x0F;} /* Case 0000xxxx */
		else if ((Destin->MessageContent & 0xF0) == 0x10) {Destin->Description = 13; Destin->RandomReference = Destin->MessageContent & 0x0F;} /* Case 0001xxxx */
		else if ((Destin->MessageContent & 0xFC) == 0x78) {Destin->Description = 14; Destin->RandomReference = Destin->MessageContent & 0x03;} /* Case 011110xx */
		else if ((Destin->MessageContent & 0xFA) == 0x78) {Destin->Description = 14; Destin->RandomReference = ((Destin->MessageContent & 0x04) >> 1)|(Destin->MessageContent & 0x01);} /* Case 01111x0x */
		else if ((Destin->MessageContent & 0xF9) == 0x78) {Destin->Description = 14; Destin->RandomReference = (Destin->MessageContent & 0x07)>>1;} /* Case 01111xx0 */
		else if ((Destin->MessageContent & 0xF8) == 0x70) {Destin->Description = 15; Destin->RandomReference = Destin->MessageContent & 0x07;} /* Case 01110xxx */
		else if ((Destin->MessageContent & 0xFF) == 0x67) {Destin->Description = 16;} /* Case 01100111 */
		else if ((Destin->MessageContent & 0xF9) == 0x60) {Destin->Description = 17; Destin->RandomReference = (Destin->MessageContent & 0x07)>>1;} /* Case 01100xx0 */
		else if ((Destin->MessageContent & 0xFB) == 0x61) {Destin->Description = 18; Destin->RandomReference = (Destin->MessageContent & 0x07)>>2;} /* Case 01100x01 */
		else if ((Destin->MessageContent & 0xFF) == 0x63) {Destin->Description = 18;} /* Case 01100011 */
		else if ((Destin->MessageContent & 0xFF) == 0x7F) {Destin->Description = 18;} /* Case 01111111 */

		return 8;
  }%
}

/*-----------------------------------------------------------------------
		MESSAGE: CIPHERING MODE COMMAND
		CHAPTER: TS 44.018 9.1.9
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 CIPHERING_MODE_COMMAND_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00110101;

		 CiphModeSetting                      M V   1/2     CipherModeSetting   ; # 10.5.2.9
		 CipherResp                           M V   1/2     CipherResponse      ; # 10.5.2.10
};


/*-----------------------------------------------------------------------
		MESSAGE: CIPHERING MODE COMPLETE
		CHAPTER: TS 44.018 9.1.10
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 CIPHERING_MODE_COMPLETE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00110010;

	17 MobileEquipmentId                    O TLV 3-11    RRMobileId          ; # 10.5.1.4
};


/*-----------------------------------------------------------------------
		MESSAGE: CLASSMARK CHANGE
		CHAPTER: TS 44.018 9.1.11
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 CLASSMARK_CHANGE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00010110;

		 MobileStationClassmark               M LV  4       RRMobileStationClassmark2; # 10.5.1.6
	20 AdditionalMobileStationClassmarkInfo C TLV 3-14    RRClassmark3Value   ; # 10.5.1.7
};

/*-----------------------------------------------------------------------
		MESSAGE: UTRAN CLASSMARK CHANGE
		CHAPTER: TS 44.018 9.1.11a
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 UTRAN_CLASSMARK_CHANGE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01100000;

		 UTRANClassmark                       M LV >=2    binary        ; # 10.5.2.7a
};

/*-----------------------------------------------------------------------
		MESSAGE: CDMA2000 CLASSMARK CHANGE
		CHAPTER: TS 44.018 9.1.11b
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 CDMA2000_CLASSMARK_CHANGE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01100010;

	   TerminalInformation                           M LV >=1 binary;
	   SecurityStatus                                M LV >=1 binary;
	   BandClassInformation                          M LV >=1 binary;
	   PowerClassInformation                         M LV >=1 binary;
	   OperatingModeInformation                      M LV >=1 binary;
	   ServiceOptionInformation                      M LV >=1 binary;
	   MultiplexOptionInformation                    M LV >=1 binary;
	   PowerControlInformation                       M LV >=1 binary;
	   CapabilityInformation                         M LV >=1 binary;
	   ChannelConfigurationCapabilityInformation     M LV >=1 binary;
	   ExtendedMultiplexOptionInformation            M LV >=1 binary;
	   BandSubclassInformation                       M LV >=1 binary;
	   EncryptionCapability                          M LV >=1 binary;
};

/*-----------------------------------------------------------------------
		MESSAGE: GERAN IU MODE CLASSMARK CHANGE
		CHAPTER: TS 44.018 9.1.11d
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 GERAN_IU_MODE_CLASSMARK_CHANGE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01100101;

	   GERANIuModeClassmark                           M LV >=15 binary;
};

/*-----------------------------------------------------------------------
		MESSAGE: CLASSMARK ENQUIRY
		CHAPTER: TS 44.018 9.1.12
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 CLASSMARK_ENQUIRY_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00010011;

	10 ClassmarkEnquiryMask                 O TLV 3       ClassmarkEnquiryMask; # 10.5.2.7c
};


/*-----------------------------------------------------------------------
		MESSAGE: CONFIGURATION CHANGE COMMAND
		CHAPTER: TS 44.018 9.1.12b
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 CONFIGURATION_CHANGE_COMMAND_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00110000;

		 DescriptionOfTheMultislotCfg         M LV  2-11    binary              ; # 10.5.2.21b
	63 ModeOfChannelSet1                    O TV  2       ChannelMode         ; # 10.5.2.6
	11 ModeOfChannelSet2                    O TV  2       ChannelMode         ; # 10.5.2.6
	13 ModeOfChannelSet3                    O TV  2       ChannelMode         ; # 10.5.2.6
	14 ModeOfChannelSet4                    O TV  2       ChannelMode         ; # 10.5.2.6
	15 ModeOfChannelSet5                    O TV  2       ChannelMode         ; # 10.5.2.6
	16 ModeOfChannelSet6                    O TV  2       ChannelMode         ; # 10.5.2.6
	17 ModeOfChannelSet7                    O TV  2       ChannelMode         ; # 10.5.2.6
	18 ModeOfChannelSet8                    O TV  2       ChannelMode         ; # 10.5.2.6
};


/*-----------------------------------------------------------------------
		MESSAGE: CONFIGURATION CHANGE ACKNOWLEDGE
		CHAPTER: TS 44.018 9.1.12c
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 CONFIGURATION_CHANGE_ACKNOWLEDGE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00110001;

};


/*-----------------------------------------------------------------------
		MESSAGE: CONFIGURATION CHANGE REJECT
		CHAPTER: TS 44.018 9.1.12d
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 CONFIGURATION_CHANGE_REJECT_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00110011;

		 RrCause                              M V   1       RRCause             ; # 10.5.2.31
};

/*-----------------------------------------------------------------------
		MESSAGE: DTM ASSIGNMENT COMMAND
		CHAPTER: TS 44.018 9.1.12e.dn
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 DTM_ASSIGNMENT_COMMAND_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01001100;

		 RrCause                              M V   1       RRCause             ; # 10.5.2.31
};

/*-----------------------------------------------------------------------
		MESSAGE: DTM ASSIGNMENT COMMAND
		CHAPTER: TS 44.018 9.1.12e.up
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 DTM_ASSIGNMENT_COMMAND_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01001100;

		 CsPowerCommand                       M V   1       PowerCommand        ; # 10.5.2.28
		 DescOfTheCsCh                        M V   3       TChDesc             ; # 10.5.2.5
		 GprsBroadcastInfo                    M LV  >=7     GPRSBCastInfo       ; # 10.5.2.14d
	10 CellChDesc                           O TV  17      CellChannel         ; # 10.5.2.1b
	11 ChMode                               O TV  2       ChannelMode         ; # 10.5.2.6
	12 FrequencyList                        C TLV 4-132   CellChannel         ; # 10.5.2.13
	13 MobileAllocation                     C TLV 3-10    MobileAllocation    ; # 10.5.2.21
	14 TbfStartingTime                      O TV  3       StartingTime        ; # 10.5.2.38
	15 DescOfTheUplinkPktChAss              O TLV >=3     RRPacketUplinkAssignment; # 10.5.2.25c
	16 DescOfTheDownlinkPktChAss            O TLV >=3     RRPktDownlinkAssi   ; # 10.5.2.25d
	17 MultiRateconfiguration               O TLV 4-8     MultirateSpeechCfgIE; # 10.5.2.21aa
	9- CipheringModeSetting                 O TV  1       CipherModeSetting   ; # 10.5.2.9
	18 MobileAllocationC2                   O TLV 3-10    MobileAllocation    ; # 10.5.2.21
	19 FrequencyListC2                      O TLV 4-132   CellChannel         ; # 10.5.2.13
	20 DescDownlinkPacketChannelAssigType2  O TLV >=3     RRPacketDownlinkAssignmentType2; # 10.5.2.25e
	21 ChannelDescriptionC2                 O TV  3       TChDesc3            ; # 10.5.2.5c
	6D ExtendedTSCSet                       O TV  2       ExtendedTSCSet      ; # 10.5.2.82
};


/*-----------------------------------------------------------------------
		MESSAGE: DTM ASSIGNMENT FAILURE
		CHAPTER: TS 44.018 9.1.12f
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 DTM_ASSIGNMENT_FAILURE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01001000;

		 RrCause                              M V   1       RRCause             ; # 10.5.2.31
};


/*-----------------------------------------------------------------------
		MESSAGE: DTM INFORMATION
		CHAPTER: TS 44.018 9.1.12g
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 DTM_INFORMATION_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01001101;

		 RouteingAreaId                       M V   6       RoutingAreaIdentity   ; # 10.5.5.15
		 DtmInfoRestOctets                    M LV  2       force DTMInfoRestOctets; # 10.5.2.11a
};


/*-----------------------------------------------------------------------
		MESSAGE: DTM REJECT
		CHAPTER: TS 44.018 9.1.12h
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 DTM_REJECT_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01001001;

		 DtmWaitIndication                    M V   1       integer             ; # 10.5.2.43
};


/*-----------------------------------------------------------------------
		MESSAGE: DTM REQUEST
		CHAPTER: TS 44.018 9.1.12i
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 DTM_REQUEST_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01001010;

		 Tlli                                 M V   4       integer             ; # 10.5.2.41a
		 ChReqDesc                            M LV  >=5     ChReqDesc2          ; # 10.5.2.8b
};


/*-----------------------------------------------------------------------
		MESSAGE: FREQUENCY REDEFINITION
		CHAPTER: TS 44.018 9.1.13
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 FREQUENCY_REDEFINITION_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00010100;

		 ChannelDescription                   M V   3       TChDesc             ; # 10.5.2.5
		 MobileAllocation                     M LV  1-9     MobileAllocation    ; # 10.5.2.21
		 StartingTime                         M V   2       StartingTime        ; # 10.5.2.38
	62 CellChannelDescription               O TV  17      CellChannel         ; # 10.5.2.1b
	9- CarrierIndication                    O TV  1       octet               ; # 10.5.2.69
	11 MobileAllocationC2                   O TLV 3-10    MobileAllocation    ; # 10.5.2.21
	12 ChannelDescriptionC2                 O TV  3       TChDesc3            ; # 10.5.2.5c
	6D ExtendedTSCSet                       O TV  2       ExtendedTSCSet      ; # 10.5.2.82
};


/*-----------------------------------------------------------------------
		MESSAGE: PDCH ASSIGNMENT COMMAND
		CHAPTER: TS 44.018 9.1.13a
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 PDCH_ASSIGNMENT_COMMAND_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00100011;

		 DescriptionOfTheChannelAfterTime     M V   3       TChDesc             ; # 10.5.2.5
	62 CellChannelDescription               O TV  17      CellChannel         ; # 10.5.2.1b
	05 FrequencyListAfterTime               C TLV 4-132   CellChannel         ; # 10.5.2.13
	72 MobileAllocationAfterTime            C TLV 3-10    MobileAllocation    ; # 10.5.2.21
	7C StartingTime                         O TV  3       StartingTime        ; # 10.5.2.38
	19 FrequencyListBeforeTime              C TLV 4-132   CellChannel         ; # 10.5.2.13
	1C DescriptionOfTheChannelBeforeTime    O TV  4       TChDesc             ; # 10.5.2.5
	1E FrequencyChannelSequenceBeforeTime   C TV  10      FreqChannelSeq      ; # 10.5.2.12
	21 MobileAllocationBeforeTime           C TLV 3-10    MobileAllocation    ; # 10.5.2.21
	22 RrPacketUplinkAssignment             C TLV >=3     PacketChannelDescription; # 10.5.2.25a
	23 RrPacketDownlinkAssignment           C TLV >=3     DedicatedModeOrTBF  ; # 10.5.2.25b
};


/*-----------------------------------------------------------------------
		MESSAGE: GPRS SUSPENSION REQUEST
		CHAPTER: TS 44.018 9.1.13b
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 GPRS_SUSPENSION_REQUEST_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00110100;

		 TemporaryLogicalLinkId               M V   4       integer             ; # 10.5.2.41a
		 RouteingAreaId                       M V   6       RoutingAreaIdentity ; # 10.5.5.15
		 SuspensionCause                      M V   1       integer             ; # 10.5.2.47
	01 ServiceSupport                       O TV  2       ServiceSupport      ; # 10.5.2.57
};

/*-----------------------------------------------------------------------
		MESSAGE: Handover access
		CHAPTER: TS 44.018 9.1.14
		Single octet, out of standard.
-----------------------------------------------------------------------*/


/*-----------------------------------------------------------------------
		MESSAGE: HANDOVER COMMAND
		CHAPTER: TS 44.018 9.1.15
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 HANDOVER_COMMAND_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00101011;

		 CellDescription                      M V   2       CellDescription     ; # 10.5.2.2
		 DescriptionOfTheFirstChannelAfterTime M V  3       TChDesc2            ; # 10.5.2.5a
		 HandoverRef                          M V   1       integer             ; # 10.5.2.15
		 PowerCommandAndAccessType            M V   1       PowerCommandAndAccessType; # 10.5.2.28a
	D- SynchronizationIndication            O TV  1       SyncInd             ; # 10.5.2.39
	02 FrequencyShortListAfterTime          C TV  10      force CellChannel   ; # 10.5.2.14
	05 FrequencyListAfterTime               C TLV 4-131   CellChannel         ; # 10.5.2.13
	62 CellChannelDescription               C TV  17      CellChannel         ; # 10.5.2.1b
	10 DescriptionOfTheMultislotCfg         C TLV 3-12    binary              ; # 10.5.2.21b
	63 ModeOfTheFirstChannelChannelSet1     O TV  2       ChannelMode         ; # 10.5.2.6
	11 ModeOfChannelSet2                    O TV  2       ChannelMode         ; # 10.5.2.6
	13 ModeOfChannelSet3                    O TV  2       ChannelMode         ; # 10.5.2.6
	14 ModeOfChannelSet4                    O TV  2       ChannelMode         ; # 10.5.2.6
	15 ModeOfChannelSet5                    O TV  2       ChannelMode         ; # 10.5.2.6
	16 ModeOfChannelSet6                    O TV  2       ChannelMode         ; # 10.5.2.6
	17 ModeOfChannelSet7                    O TV  2       ChannelMode         ; # 10.5.2.6
	18 ModeOfChannelSet8                    O TV  2       ChannelMode         ; # 10.5.2.6
	64 DescriptionOfTheSecondChannelAfterTime O TV  4       TChDesc             ; # 10.5.2.5
	66 ModeOfTheSecondChannel               O TV  2       integer             ; # 10.5.2.7
	69 FrequencyChannelSequenceAfterTime    C TV  10      FreqChannelSeq      ; # 10.5.2.12
	72 MobileAllocationAfterTime            C TLV 3-10    MobileAllocation    ; # 10.5.2.21
	7C StartingTime                         O TV  3       StartingTime        ; # 10.5.2.38
	7B RealTimeDifference                   C TLV 3       integer             ; # 10.5.2.41
	7D TimingAdvance                        C TV  2       TimingAdvance       ; # 10.5.2.40
	12 FrequencyShortListBeforeTime         C TV  10      force CellChannel   ; # 10.5.2.14
	19 FrequencyListBeforeTime              C TLV 4-131   CellChannel         ; # 10.5.2.13
	1C DescriptionFirstChannelBeforeTime    O TV  4       TChDesc2            ; # 10.5.2.5a
	1D DescriptionSecondChannelBeforeTime   O TV  4       TChDesc             ; # 10.5.2.5
	1E FrequencyChannelSequenceBeforeTime   C TV  10      FreqChannelSeq      ; # 10.5.2.12
	21 MobileAllocationBeforeTime           C TLV 3-10    MobileAllocation    ; # 10.5.2.21
	9- CipherModeSetting                    O TV  1       CipherModeSetting   ; # 10.5.2.9
	01 VgcsTargetModeIndication             O TLV 3       integer             ; # 10.5.2.42a
	03 MultiRateCfg                         O TLV 4-8     MultirateSpeechCfgIE; # 10.5.2.21aa
	76 DynamicARFCNMapping                  O TLV 6-34    DynamicARFCNMapping ; # 10.5.2.11b
	04 VGCSCipheringParameters              O TLV 3-15    VGCSCipheringParameters; # 10.5.2.42b
	51 DedicatedServiceInformation          O TV  2       DedicatedServiceInformation; # 10.5.2.59
	A- PLMNIndex                            O TV  1       integer enum {        # 10.5.2.81
				0001001 = "PLMN identity of the Common PLMN broadcast in SYSTEM INFORMATION TYPE 3/4"
				0010010 = "PLMN identity of the first Additional PLMN in the network sharing information broadcast in SYSTEM INFORMATION TYPE 22"
				0011011 = "PLMN identity of the second Additional PLMN in the network sharing information broadcast broadcast in SYSTEM INFORMATION TYPE 22"
				0100100 = "PLMN identity of the third Additional PLMN in the network sharing information broadcast in SYSTEM INFORMATION TYPE 22"
				0101101 = "PLMN identity of the fourth Additional PLMN in the network sharing information broadcast in SYSTEM INFORMATION TYPE 22"
				default = "Reserved"
			};
	6D ExtendedTSCSetAfterTime              O TV  2       ExtendedTSCSet      ; # 10.5.2.82
	6E ExtendedTSCSetBeforeTime             O TV  2       ExtendedTSCSet      ; # 10.5.2.82
};


/*-----------------------------------------------------------------------
		MESSAGE: INTER SYSTEM TO UTRAN HANDOVER COMMAND
		CHAPTER: TS 44.018 9.1.15a
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 INTER_SYSTEM_TO_UTRAN_HANDOVER_COMMAND_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01100011;

		 HandoverToUtranCommand               M LV  >=2     binary              ; # 10.5.2.51
		 CNtoMSTransparentInformation         M V   >=0     binary              ; # 10.5.2.80
};


/*-----------------------------------------------------------------------
		MESSAGE: INTER SYSTEM TO CDMA2000 HANDOVER COMMAND
		CHAPTER: TS 44.018 9.1.15b
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 INTER_SYSTEM_TO_CDMA2000_HANDOVER_COMMAND_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01100100;

		 HandoverToCdma2000Command            M LV  >=4     binary              ; # 10.5.2.52
};

/*-----------------------------------------------------------------------
		MESSAGE: HANDOVER TO GERAN Iu MODE COMMAND
		CHAPTER: TS 44.018 9.1.15c
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 HANDOVER_TO_GERAN_Iu_MODE_COMMAND_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01100101;

		 RadioBearerReconfiguration            M LV  >=2     binary              ; # 3GPP TS 44.118
};

/*-----------------------------------------------------------------------
		MESSAGE: Inter System To E-UTRAN Handover Command
		CHAPTER: TS 44.018 9.1.15d
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 INTER_SYSTEM_TO_EUTRAN_HANDOVER_COMMAND_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01100110;

		DL_DCCHMessage	                      M LV  >=2     binary              ; # 10.5.2.79
		CNtoMStTransparentInformation         M LV  >=2     binary              ; # 10.5.2.80
};

/*-----------------------------------------------------------------------
		MESSAGE: HANDOVER COMPLETE
		CHAPTER: TS 44.018 9.1.16
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 HANDOVER_COMPLETE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00101100;

		 RrCause                              M V   1       RRCause             ; # 10.5.2.31
	77 MobileObservedTimeDifference         O TLV 5       MobileTimeDiff      ; # 10.5.2.21a
	67 MobileObservedTimeDifferenceHyperframe O TLV 7     MobileTimeDiffHyperframe; # 10.5.2.21ab
};


/*-----------------------------------------------------------------------
		MESSAGE: HANDOVER FAILURE
		CHAPTER: TS 44.018 9.1.17
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 HANDOVER_FAILURE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00101000;

		 RrCause                              M V   1       RRCause             ; # 10.5.2.31
	9- PSCause                              O TV  1       integer enum {        # 10.5.2.67
																														b0000 = "DTM multislot capabilities violated"
																														b0001 = "No uplink TBF"
																														b0010 = "Too many TBFs"
																														default = "reserved"
																												};
};


/*-----------------------------------------------------------------------
		MESSAGE: IMMEDIATE ASSIGNMENT
		CHAPTER: TS 44.018 9.1.18
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen IMMEDIATE_ASSIGNMENT_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00111111;

		 PageMode                             M V   1/2     PageMode            ; # 10.5.2.26
		 DedicatedModeOrTbf                   M V   1/2     DedicatedModeOrTBF4b; # 10.5.2.25ba
		 ChannelDescription                   C V   3       TChDesc             %{!(DATA.DedicatedModeOrTbf.TD)}%; # 10.5.2.5 Present if DedicatedModeOrTbf indicates that the message assigns a dedicated mode resource.
		 PacketChannelDescription             C V   3       PacketChannelDescription %{(DATA.DedicatedModeOrTbf.TD)}%; # 10.5.2.25a Present if DedicatedModeOrTbf indicates that the message assigns a Temporary Block Flow (TBF).
		 ReqRef                               M V   3       RequestReference    ; # 10.5.2.30
		 TimingAdvance                        M V   1       TimingAdvance       ; # 10.5.2.40
		 MobileAllocation                     M LV  1-9     MobileAllocation    ; # 10.5.2.21
	7C StartingTime                         O TV  3       StartingTime        ; # 10.5.2.38
	**EndOfL2Length**;
		 IaRestOctets                         M V   0-11    force IARestOctets  ; # 10.5.2.16
#	6D ExtendedTSCSet                       O TV  2       ExtendedTSCSet      ; # 10.5.2.82
};

/*-----------------------------------------------------------------------
		MESSAGE: IMMEDIATE PACKET ASSIGNMENT
		CHAPTER: TS 44.018 9.1.18b
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen IMMEDIATE_PACKET_ASSIGNMENT_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01101001;

		 PageMode                             M V   1/2     PageMode            ; # 10.5.2.26
		 FeatureIndicator                     M V   1/2     FeatureIndicator    ; # 10.5.2.76
	**EndOfL2Length**;
		 IPARestOctets                        M V   19    	IPARestOctets       ; # 10.5.2.78
};


/*-----------------------------------------------------------------------
		MESSAGE: IMMEDIATE ASSIGNMENT EXTENDED
		CHAPTER: TS 44.018 9.1.19
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen IMMEDIATE_ASSIGNMENT_EXTENDED_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00111001;

		 PageMode                             M V   1/2     PageMode            ; # 10.5.2.26
		 FeatureIndicator                     M V   1/2     FeatureIndicator    ; # 10.5.2.76
		 ChannelDescription1                  M V   3       TChDesc             ; # 10.5.2.5
		 ReqRef1                              M V   3       RequestReference    ; # 10.5.2.30
		 TimingAdvance1                       M V   1       TimingAdvance       ; # 10.5.2.40
		 ChannelDescription2                  M V   3       TChDesc             ; # 10.5.2.5
		 ReqRef2                              M V   3       RequestReference    ; # 10.5.2.30
		 TimingAdvance2                       M V   1       TimingAdvance       ; # 10.5.2.40
		 MobileAllocation                     M LV  1-5     MobileAllocation    ; # 10.5.2.21
	7C StartingTime                         O TV  3       StartingTime        ; # 10.5.2.38
	**EndOfL2Length**;
		 IaxRestOctets                        M V   0-4     IAXRestOctets       ; # 10.5.2.18
};


/*-----------------------------------------------------------------------
		MESSAGE: IMMEDIATE ASSIGNMENT REJECT
		CHAPTER: TS 44.018 9.1.20
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen IMMEDIATE_ASSIGNMENT_REJECT_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00111010;
	L2PseudoLength        = 19;

		 PageMode                             M V   1/2     PageMode            ; # 10.5.2.26
		 FeatureIndicator                     M V   1/2     FeatureIndicator    ; # 10.5.2.76
		 ReqRef1                              M V   3       RequestReference    ; # 10.5.2.30
		 WaitIndication1                      M V   1       integer             ; # 10.5.2.43
		 ReqRef2                              M V   3       RequestReference    ; # 10.5.2.30
		 WaitIndication2                      M V   1       integer             ; # 10.5.2.43
		 ReqRef3                              M V   3       RequestReference    ; # 10.5.2.30
		 WaitIndication3                      M V   1       integer             ; # 10.5.2.43
		 ReqRef4                              M V   3       RequestReference    ; # 10.5.2.30
		 WaitIndication4                      M V   1       integer             ; # 10.5.2.43

		 IarRestOctets                        M V   3       force IARRestOctets ; # 10.5.2.17
};


/*-----------------------------------------------------------------------
		MESSAGE: MEASUREMENT REPORT
		CHAPTER: TS 44.018 9.1.21
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 MEASUREMENT_REPORT_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00010101;

		 MeasurementResults                   M V   16      MeasurementResults  ; # 10.5.2.20
};


/*-----------------------------------------------------------------------
		MESSAGE: NOTIFICATION NCH
		CHAPTER: TS 44.018 9.1.21b
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen NOTIFICATION_NCH_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00100000;
	L2PseudoLength        = 1;

		 NtNRestOctets                        M V   1-20    NTNRestOctets       ; # 10.5.2.22c
};


/*-----------------------------------------------------------------------
		MESSAGE: NOTIFICATION RESPONSE
		CHAPTER: TS 44.018 9.1.21d
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 NOTIFICATION_RESPONSE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00100110;

		 MobileStationClassmark               M LV  4       RRMobileStationClassmark2; # 10.5.1.6
		 MobileId                             M LV  2-9     RRMobileId          ; # 10.5.1.4
		 GroupOrBroadcastCallRef              M V   5       DescGrpOrBcastCallRef; # 10.5.1.9
};


/*-----------------------------------------------------------------------
		MESSAGE: RR CELL CHANGE ORDER
		CHAPTER: TS 44.018 9.1.21e
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 RR_CELL_CHANGE_ORDER_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00001000;

		 CellDescription                      M V   2       CellDescription     ; # 10.5.2.2
		 NcModeForTargetCell                  M V   1/2     NCMode              ; # 10.5.2.21c
		 SpareHalfOctet                       M V   1/2     force void default=0; # 10.5.1.8
	19 P3GTargetCell                        O TLV 3-6                         ; # 10.5.2.56
};


/*-----------------------------------------------------------------------
		MESSAGE: PACKET ASSIGNMENT
		CHAPTER: TS 44.018 9.1.21f
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 PACKET_ASSIGNMENT_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01001011;

		 GprsBroadcastInfo                    M LV  >=7     GPRSBCastInfo       ; # 10.5.2.14d
	22 DescOfTheUplinkPktChAss              O TLV >=3     RRPacketUplinkAssignment; # 10.5.2.25c
	23 DescOfTheDownlinkPktChAss            O TLV >=3     RRPktDownlinkAssi   ; # 10.5.2.25d
	10 CellChannelDescription               O TV  17      CellChannel         ; # 10.5.2.1b
	12 FrequencyList                        C TLV 4-132   CellChannel         ; # 10.5.2.13
	13 MobileAllocation                     C TLV 3-10    MobileAllocation    ; # 10.5.2.21
	14 ChannelDescriptionC2                 O TV  3       TChDesc3            ; # 10.5.2.5c
	24 DescDownlinkPacketChannelAssigType2  O TLV >=3     RRPacketDownlinkAssignmentType2; # 10.5.2.25e
	6D ExtendedTSCSet                       O TV  2       ExtendedTSCSet      ; # 10.5.2.82
};


/*-----------------------------------------------------------------------
		MESSAGE: PACKET NOTIFICATION
		CHAPTER: TS 44.018 9.1.21g
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 PACKET_NOTIFICATION_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01001110;

	10 PktTmsi                              C TV  5       integer             ; # 10.5.2.42
	11 MobileId                             C TLV 3-11    RRMobileId          ; # 10.5.1.4
};


/*-----------------------------------------------------------------------
		MESSAGE: PAGING REQUEST TYPE 1
		CHAPTER: TS 44.018 9.1.22
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen PAGING_REQUEST_TYPE_1_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00100001;

		 PageMode                             M V   1/2     PageMode            ; # 10.5.2.26
		 ChannelsNeededForMobiles1And2        M V   1/2     ChannelNeeded       ; # 10.5.2.8
		 MobileId1                            M LV  2-9     RRMobileId          ; # 10.5.1.4
	17 MobileId2                            O TLV 3-10    RRMobileId          ; # 10.5.1.4
	**EndOfL2Length**;
		 P1RestOctets                         M V   0-17    P1RestOctets        ; # 10.5.2.23
};


/*-----------------------------------------------------------------------
		MESSAGE: PAGING REQUEST TYPE 2
		CHAPTER: TS 44.018 9.1.23
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen PAGING_REQUEST_TYPE_2_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00100010;

		 PageMode                             M V   1/2     PageMode            ; # 10.5.2.26
		 ChannelsNeededForMobiles1And2        M V   1/2     ChannelNeeded       ; # 10.5.2.8
		 MobileId1                            M V   4       integer             ; # 10.5.2.42
		 MobileId2                            M V   4       integer             ; # 10.5.2.42
	17 MobileId3                            O TLV 3-10    RRMobileId          ; # 10.5.1.4

	**EndOfL2Length**;
		 P2RestOctets                         M V   1-11    P2RestOctets        ; # 10.5.2.24
};


/*-----------------------------------------------------------------------
		MESSAGE: PAGING REQUEST TYPE 3
		CHAPTER: TS 44.018 9.1.24
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen PAGING_REQUEST_TYPE_3_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00100100;
	L2PseudoLength        = 19;

		 PageMode                             M V   1/2     PageMode            ; # 10.5.2.26
		 ChannelsNeededForMobiles1And2        M V   1/2     ChannelNeeded       ; # 10.5.2.8
		 MobileId1                            M V   4       integer             ; # 10.5.2.42
		 MobileId2                            M V   4       integer             ; # 10.5.2.42
		 MobileId3                            M V   4       integer             ; # 10.5.2.42
		 MobileId4                            M V   4       integer             ; # 10.5.2.42
		 P3RestOctets                         M V   3       force P3RestOctets  ; # 10.5.2.25
};


/*-----------------------------------------------------------------------
		MESSAGE: PAGING RESPONSE
		CHAPTER: TS 44.018 9.1.25
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 PAGING_RESPONSE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00100111;

		 CiphKeySequenceNum                   M V   1/2     CipheringKeySequenceNumber; # 10.5.1.2
		 SpareHalfOctet                       M V   1/2     force void default=0; # 10.5.1.8
		 MobileStationClassmark               M LV  4       RRMobileStationClassmark2; # 10.5.1.6
		 MobileId                             M LV  2-9     RRMobileId          ; # 10.5.1.4
	C- AdditionalUpdateParameters           O TV  1       AdditionalUpdateParameters; # TS24.008 10.5.3.14
};


/*-----------------------------------------------------------------------
		MESSAGE: PARTIAL RELEASE
		CHAPTER: TS 44.018 9.1.26
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 PARTIAL_RELEASE_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00001010;

		 ChannelDescription                   M V   3       TChDesc             ; # 10.5.2.5
};


/*-----------------------------------------------------------------------
		MESSAGE: PARTIAL RELEASE COMPLETE
		CHAPTER: TS 44.018 9.1.27
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 PARTIAL_RELEASE_COMPLETE_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00001111;

};


/*-----------------------------------------------------------------------
		MESSAGE: PHYSICAL INFORMATION
		CHAPTER: TS 44.018 9.1.28
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 PHYSICAL_INFORMATION_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00101101;

		 TimingAdvance                        M V   1       TimingAdvance       ; # 10.5.2.40
};


/*-----------------------------------------------------------------------
		MESSAGE: RR INITIALISATION REQUEST
		CHAPTER: TS 44.018 9.1.28.a
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 RR_INITIALISATION_REQUEST_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00111100;

		 CiphKeySequenceNum                   M V   1/2     CipheringKeySequenceNumber; # 10.5.1.2
		 MacModeAndChannelCodingReq           M V   1/2     MACModeAndChCodReq  ; # 10.5.2.4a
		 MobileStationClassmark               M LV  4       RRMobileStationClassmark2; # 10.5.1.6
		 Tlli                                 M V   4       integer             ; # 10.5.2.41a
		 ChannelReqDescription                M V   5       ChannelRequestDesc  ; # 10.5.2.8a
		 GprsMeasurementResults               M V   2       GPRSMeasurementResult; # 10.5.2.20a
};


/*-----------------------------------------------------------------------
		MESSAGE: RR STATUS
		CHAPTER: TS 44.018 9.1.29
	DIRECTION: BOTH
-----------------------------------------------------------------------*/
gsm-0407 RR_STATUS {
	in message set RRUplink, RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00010010;

		 RrCause                              M V   1       RRCause             ; # 10.5.2.31
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 1
		CHAPTER: TS 44.018 9.1.31
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_1_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00011001;
	L2PseudoLength        = 21;

		 CellChannelDescription               M V   16      CellChannel         ; # 10.5.2.1b
		 RachControlParam                     M V   3       RACHCtrlParam       ; # 10.5.2.29
		 Si1RestOctets                        M V   1       force SI1RestOctets ; # 10.5.2.32
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 2
		CHAPTER: TS 44.018 9.1.32
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_2_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00011010;
	L2PseudoLength        = 22;

		 BcchFrequencyList                    M V   16      NeighbourCellDescription; # 10.5.2.22
		 NccPermitted                         M V   1       integer             ; # 10.5.2.27
		 RachControlParam                     M V   3       RACHCtrlParam       ; # 10.5.2.29
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 2BIS
		CHAPTER: TS 44.018 9.1.33
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_2BIS_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00000010;
	L2PseudoLength        = 21;

		 ExtendedBcchFrequencyList            M V   16      NeighbourCellDescription; # 10.5.2.22
		 RachControlParameters                M V   3       RACHCtrlParam       ; # 10.5.2.29
		 Si2bisRestOctets                     M V   1       force SI2bisRestOctets; # 10.5.2.33
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 2TER
		CHAPTER: TS 44.018 9.1.34
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_2TER_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00000011;
	L2PseudoLength        = 18;

		 ExtendedBcchFrequencyList            M V   16      NeighbourCellDescription2; # 10.5.2.22a
		 Si2terRestOctets                     M V   4       force SI2terRestOctets   ; # 10.5.2.33a
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 2QUATER
		CHAPTER: TS 44.018 9.1.34a
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_2QUATER_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00000111;
	L2PseudoLength        = 1;

		 Si2QuaterRestOctets                  M V   20      force SI2quaterRestOctets ; # 10.5.2.33b
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 3
		CHAPTER: TS 44.018 9.1.35
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_3_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00011011;
	L2PseudoLength        = 18;

		 CellId                               M V   2       integer             ; # 10.5.1.1
		 LocationAreaId                       M V   5       RRLocationAreaId    ; # 10.5.1.3
		 ControlChannelDescription            M V   3       CtrlChannelDesc     ; # 10.5.2.11
		 CellOpt                              M V   1       CellOptions         ; # 10.5.2.3
		 CellSelectionParameters              M V   2       CellSelParam        ; # 10.5.2.4
		 RachControlParameters                M V   3       RACHCtrlParam       ; # 10.5.2.29
		 Si3RestOctets                        M V   4       force SI3RestOctet  ; # 10.5.2.34
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 4
		CHAPTER: TS 44.018 9.1.36
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_4_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00011100;

		 LocationAreaId                       M V   5       RRLocationAreaId    ; # 10.5.1.3
		 CellSelectionParameters              M V   2       CellSelParam        ; # 10.5.2.4
		 RachControlParameters                M V   3       RACHCtrlParam       ; # 10.5.2.29
	64 CbchChannelDescription               O TV  4       TChDesc             ; # 10.5.2.5
	72 CbchMobileAllocation                 C TLV 3-6     MobileAllocation    ; # 10.5.2.21
	**EndOfL2Length**;
		 Si4RestOctets                        M V   0-10    force SI4_Rest_Octets  ; # 10.5.2.35
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 5
		CHAPTER: TS 44.018 9.1.37
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_5_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00011101;
	L2PseudoLength        = 18;

		 BcchFrequencyList                    M V   16      NeighbourCellDescription; # 10.5.2.22
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 5BIS
		CHAPTER: TS 44.018 9.1.38
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_5BIS_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00000101;
	L2PseudoLength        = 18;

		 ExtOfTheBcchFrequencyListDescription M V   16      NeighbourCellDescription; # 10.5.2.22
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 5TER
		CHAPTER: TS 44.018 9.1.39
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_5TER_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00000110;
	L2PseudoLength        = 18;

		 ExtendedBcchFrequencyList            M V   16      NeighbourCellDescription2; # 10.5.2.22a
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 6
		CHAPTER: TS 44.018 9.1.40
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_6_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00011110;
	L2PseudoLength        = 11;

		 CellId                               M V   2       integer             ; # 10.5.1.1
		 LocationAreaId                       M V   5       RRLocationAreaId    ; # 10.5.1.3
		 CellOpt                              M V   1       CellOptions         ; # 10.5.2.3
		 NccPermitted                         M V   1       integer             ; # 10.5.2.27
		 Si6RestOctets                        M V  >=1      SI6RestOctet        ; # 10.5.2.35a
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 7
		CHAPTER: TS 44.018 9.1.41
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_7_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00011111;
	L2PseudoLength        = 1;

		 Si7RestOctets                        M V   20      force SI7_Rest_Octets  ; # 10.5.2.36
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 8
		CHAPTER: TS 44.018 9.1.42
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_8_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00011000;
	L2PseudoLength        = 1;

		 Si8RestOctets                        M V   20      force SI8_Rest_Octets  ; # 10.5.2.37
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 9
		CHAPTER: TS 44.018 9.1.43
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_9_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00000100;
	L2PseudoLength        = 1;

		 RachControlParam                     M V   3       RACHCtrlParam       ; # 10.5.2.29
		 Si9RestOctets                        M V   17                          ; # 10.5.2.37a
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 13
		CHAPTER: TS 44.018 9.1.43a
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_13_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00000000;
	L2PseudoLength        = 0;

		 Si13RestOctets                       M V   >=1      SI13RestOctets   ; # 10.5.2.37b
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 16
		CHAPTER: TS 44.018 9.1.43d
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_16_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00111101;
	L2PseudoLength        = 1;

		 Si16RestOctets                       M V   >=1      force SI16RestOctet ; # 10.5.2.37e
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 17
		CHAPTER: TS 44.018 9.1.43e
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_17_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00111110;
	L2PseudoLength        = 1;

		 Si17RestOctets                       M V   >=1      force SI16RestOctet ; # 10.5.2.37f
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 19
		CHAPTER: TS 44.018 9.1.43f
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_19_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01000001;
	L2PseudoLength        = 1;

		 Si19RestOctets                       M V   >=1                          ; # 10.5.2.37g
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 18
		CHAPTER: TS 44.018 9.1.43g
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_18_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01000000;
	L2PseudoLength        = 1;

		 Si18RestOctets                       M V   >=1      SI18RestOctet       ; # 10.5.2.37h
};


/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 20
		CHAPTER: TS 44.018 9.1.43h
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_20_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01000010;
	L2PseudoLength        = 1;

		 Si20RestOctets                       M V   >=1      SI18RestOctet       ; # 10.5.2.37i
};

/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 14
		CHAPTER: TS 44.018 9.1.43i
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_14_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00000001;
	L2PseudoLength        = 18;

		 Si14RestOctets                       M V   16        SI14RestOctets     ; # 10.5.2.37j
};

/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 15
		CHAPTER: TS 44.018 9.1.43j
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_15_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01000011;
	L2PseudoLength        = 1;

		 Si15RestOctets                       M V   20          SI15RestOctets  ; # 10.5.2.37k
};

/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 13alt
		CHAPTER: TS 44.018 9.1.43k
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_13alt_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01000100;
	L2PseudoLength        = 0;

		 Si13altRestOctets                       M V   20       SI13altRestOctets ; # 10.5.2.37L
};

/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 21
		CHAPTER: TS 44.018 9.1.43m
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_21_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01000110;
	L2PseudoLength        = 0;

		 Si21RestOctets                       M V   >=1       SI21RestOctets ; # 10.5.2.37m
};

/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 22
		CHAPTER: TS 44.018 9.1.43n
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_22_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01000111;
	L2PseudoLength        = 2;

		 Si22RestOctets                       M V   20       force SI22RestOctets ; # 10.5.2.37n
};

/*-----------------------------------------------------------------------
		MESSAGE: SYSTEM INFORMATION TYPE 23
		CHAPTER: TS 44.018 9.1.43o
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen SYSTEM_INFORMATION_TYPE_23_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01001111;
	L2PseudoLength        = 2;

		 Si23RestOctets                       M V   20       force SI23RestOctets ; # 10.5.2.37o
};

/*-----------------------------------------------------------------------
		MESSAGE: TALKER INDICATION
		CHAPTER: TS 44.018 9.1.44
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 TALKER_INDICATION_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00010001;

		 MobileStationClassmark               M LV  4       RRMobileStationClassmark2; # 10.5.1.6
		 MobileId                             M LV  2-9     RRMobileId          ; # 10.5.1.4
	B- CipheringKeySequenceNumber           O TV  1       integer             ; # 10.5.1.2
};

/*-----------------------------------------------------------------------
		MESSAGE: PRIORITY UPLINK REQUEST
		CHAPTER: TS 44.018 9.1.44a
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 PRIORITY_DNLINK_REQUEST {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01100110;

	EstablishmentCauseRandomReference M V 1     EstablishmentCauseRandomReference ; # 10.5.2.30a
	Token                             M V 4     integer   ; # 10.5.2.66
	ReducedGroupCallReference         M V 4     ReducedGroupCallReference  ; # 10.5.2.63
	MobileIdentity                    M LV 2-9  RRMobileId; # 10.5.1.4
};



/*-----------------------------------------------------------------------
		MESSAGE: DATA INDICATION
		CHAPTER: TS 44.018 9.1.44b
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 DATA_INDICATION {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01100111;

		MobileIdentity                   M  V 4  integer    ; # 10.5.2.42
		ApplicationData                  M  V 9  binary    ; # 10.5.2.72
		DataIdentity                     M  V 1  DataIdentity    ; # 10.5.2.73
};


/*-----------------------------------------------------------------------
		MESSAGE: DATA INDICATION 2
		CHAPTER: TS 44.018 9.1.44c
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 DATA_INDICATION_2 {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 01101000;

		MobileIdentity                   M  V 4  integer    ; # 10.5.2.42
		ReducedGroupCallReference        M  V 4  ReducedGroupCallReference; # 10.5.2.63
		ApplicationData                  M  V 9  binary    ; # 10.5.2.72
		DataIdentity                     M  V 1  DataIdentity    ; # 10.5.2.73
};


/*-----------------------------------------------------------------------
		MESSAGE: DOWNLINK BUSY
		CHAPTER: TS 44.018 9.1.46
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 UPLINK_BUSY_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00101010;

	31  TalkerPriorityAndEmergencyIndication  O TLV 3     TalkerPriorityStatus; # 10.5.2.64
	32  Token                                 O TV  5     integer             ; # 10.5.2.66
	33  TalkerIdentity                        O TLV 3-20  TalkerIdentity      ; # 10.5.2.65
	8-  UplinkAccessIndication                O TV  1     octet               ; # 10.5.2.74
};


/*-----------------------------------------------------------------------
		MESSAGE: DOWNLINK RELEASE
		CHAPTER: TS 44.018 9.1.48
	DIRECTION: BOTH
-----------------------------------------------------------------------*/
gsm-0407 UPLINK_RELEASE {
	in message set RRUplink, RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00001110;

		 RrCause                              M V   1       RRCause             ; # 10.5.2.31
};


/*-----------------------------------------------------------------------
		MESSAGE: VGCS DOWNLINK GRANT
		CHAPTER: TS 44.018 9.1.49
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407 VGCS_DNLINK_GRANT_DN {
	in message set RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00001001;

		 ReqRef                               M V   3       RequestReference    ; # 10.5.2.30
		 TimingAdvance                        M V   1       TimingAdvance       ; # 10.5.2.40
};

/*-----------------------------------------------------------------------
		MESSAGE: System information type 10ter $(ASCI)$
		CHAPTER: TS 44.018 9.1.50b
	DIRECTION: DOWNLINK
	SEE RR_short_Rel9.src
-----------------------------------------------------------------------*/

/*-----------------------------------------------------------------------
		MESSAGE: EXTENDED MEASUREMENT ORDER
		CHAPTER: TS 44.018 9.1.51
	DIRECTION: DOWNLINK
-----------------------------------------------------------------------*/
gsm-0407-plen EXTENDED_MEASUREMENT_ORDER_DN {
	in message set RRPLENDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00110111;
	L2PseudoLength        = 18;

		 ExtendedMeasurementFrequencyList     M V   16      CellChannel         ; # 10.5.2.46
};


/*-----------------------------------------------------------------------
		MESSAGE: EXTENDED MEASUREMENT REPORT
		CHAPTER: TS 44.018 9.1.52
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
gsm-0407 EXTENDED_MEASUREMENT_REPORT_UP {
	in message set RRUplink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00110110;

		 ExtendedMeasurementResults           M V   16      ExtMeasurementResults ; # 10.5.2.45
};


/*-----------------------------------------------------------------------
		MESSAGE: APPLICATION INFORMATION
		CHAPTER: TS 44.018 9.1.53
	DIRECTION: BOTH
-----------------------------------------------------------------------*/
gsm-0407 APPLICATION_INFORMATION {
	in message set RRUplink, RRDownlink;
	ProtocolDiscriminator = 0110;
	MessageType           = 00111000;

		 ApduId                               M V   1/2     integer             ; # 10.5.2.48
		 ApduFlags                            M V   1/2     APDUFlags           ; # 10.5.2.49
		 ApduData                             M LV  >=2     binary              ; # 10.5.2.50
};


/*-----------------------------------------------------------------------
		MESSAGE: MEASUREMENT INFORMATION
		CHAPTER: TS 44.018 9.1.54
	DIRECTION: BOTH
	SEE RR_short_Rel9.src
-----------------------------------------------------------------------*/

/*-----------------------------------------------------------------------
		MESSAGE: ENHANCED MEASUREMENT REPORT
		CHAPTER: TS 44.018 9.1.55
	DIRECTION: BOTH
	SEE RR_short_Rel9.src
-----------------------------------------------------------------------*/

/*-----------------------------------------------------------------------
		MESSAGE: SERVICE INFORMATION
		CHAPTER: TS 44.018 9.1.56
	DIRECTION: UPLINK
-----------------------------------------------------------------------*/
# NOTE: CAN'T BE IMPLEMENTED. On TS 44.018 V8.3.0 (2008-05) its messages
# ID clashes with "EXTENDED MEASUREMENT REPORT". Probably an error that
# will be corrected later.
#
#gsm-0407 SERVICE_INFORMATION {
#	in message set RRUplink;
#	ProtocolDiscriminator = 0110;
#	MessageType           = 00110110;
#
#	   TemporaryLogicalLinkIdentity    M V 4 integer            ; # 10.5.2.41a
#	   RouteingAreaIdentification      M V 6 RoutingAreaIdentity; # 10.5.5.15
#	   ServiceSupport                  M V 1 ServiceSupport     ; # 10.5.2.57
#};
#




#IESTART
#BEGIN TS44.018,9.1.21a
#------------------------------------
# TS 44.018, 9.1.21a
#------------------------------------
csn.1 {
	<Group Call information> ::=
		<Group Call Reference : bit(36)>
		{0|1 <Group Channel Description>} ;

	slave <Group Channel Description> ::=
		<Channel Description : bit(24)>
		{0					-- Non hopping case
		|
		1 {
			0 <Mobile Allocation : bit**>
			|
			1 <Frequency Short List : bit(64)>}
		};

	slave <Emergency_Ind> ::=
		L | <Emergency_Ind{void}: null> H;

}
#BEGIN TS44.018,10.5.1.2
#------------------------------------
# TS 44.018, 10.5.1.2
#------------------------------------
bit-field CipheringKeySequenceNumber {
	size: 4 bits;
	bits 1-3: KeySequence integer;
	bit  4: spare void default=0;
}


#------------------------------------
# 3GPP 24.008, 10.5.1.9
#------------------------------------
bit-field DescGrpOrBcastCallRef {
	size: 5 octet;
	bit 14-40: BinaryCoding binary;
	bit 13: SF boolean;
	bits 9-11: CallPriority integer;
	bits 5-8: CypheringInfo integer;
	bits 1-4: spare void default = 0;
}


#BEGIN TS44.018,10.5.2.1a
#------------------------------------
# TS 44.018, 10.5.2.1a
#------------------------------------
dcl-type BaRange {
	size 1 octets ... 256 octets;
	type sequence [32] struct {
		Lower: integer;
		Higher: integer;
	}

	encode %{
		int i;

		PUSH_INT (Source->items, 8);

		/* Write the 10-bits fields */
		for (i=0; i<Source->items; i++) {
			PUSH_INT (VAR_c_BaRange_data (Source->data [i]).Lower, 10);
			PUSH_INT (VAR_c_BaRange_data (Source->data [i]).Higher, 10);
		}

		/* Calculate how many bits are left to complete an octet */
		i = 8 - (CURPOS & 7);
		if (i != 8) PUSH_INT (0, i);

		return CURPOS-BitOffset;
	}%

	decode %{
		int i;

		SETITEMS_c_BaRange (Destin, SHIFT_INT (8));
		/* Make sure we don't go out of range */
		if (Destin->items > sizeof (Destin->data)/sizeof (Destin->data[0])) {
			return ED_SYNTAX_ERROR;
		}
		/* Read the 10-bits fields */
		for (i=0; i<Destin->items; i++) {
			VAR_c_BaRange_data (Destin->data [i]).Lower = SHIFT_INT (10);
			VAR_c_BaRange_data (Destin->data [i]).Higher = SHIFT_INT (10);
		}

		/* Calculate how many bits are left to complete an octet */
		i = 8 - (CURPOS & 7);

		if (i != 8) CURPOS += i;

		return CURPOS-BitOffset;
	}%
}

#BEGIN TS44.018,10.5.2.1b
#------------------------------------
# TS 44.018, 10.5.2.1b
#
# WARNING
# The sizes given to the arrays are not the theorical maximum.
# Change them to the right compromise of data size vs. elements required.
#------------------------------------
dcl-type CellChannel {
	size 2 octets ... 130 octets;
	type union {
		BitMap0: sequence [124] boolean;
		Range1024: struct {
			W: sequence [64] integer;
			F0: boolean;
		}
		Range512: struct {
			W: sequence [64] integer;
			OrigARFCN: integer;
		}
		Range256: struct {
			W: sequence [64] integer;
			OrigARFCN: integer;
		}
		Range128: struct {
			W: sequence [64] integer;
			OrigARFCN: integer;
		}
		Variable: struct {
			RRFCN: sequence [111] boolean;
			OrigARFCN: integer;
		}
	}

	encode %{
		int i, len;
		switch (GETPRESENT_c_CellChannel (Source)) {
			/*---------------------------------------------------------
				DETECT BITMAP 0 FORMAT (signature 00XXX)
			---------------------------------------------------------*/
			case U_c_CellChannel_BitMap0: {
				PUSH_INT (0, 4); /* Signature */
				for (i=0; i<VAR_c_CellChannel_BitMap0 (Source->u.BitMap0).items; i++) {
					PUSH_INT ((VAR_c_CellChannel_BitMap0 (Source->u.BitMap0).data [(VAR_c_CellChannel_BitMap0 (Source->u.BitMap0).items)-i-1]? 1 : 0), 1);
				}
				break;
			}
			/*---------------------------------------------------------
				DETECT BITMAP 1024 RANGE (signature 10000XX)
			---------------------------------------------------------*/
			case U_c_CellChannel_Range1024: {
				PUSH_INT (0x10, 5); /* Signature */

				PUSH_INT ((VAR_c_CellChannel_Range1024 (Source->u.Range1024).F0? 1 : 0), 1);

				for (i=0; i < VAR_c_CellChannel_Range1024 (Source->u.Range1024).W.items; i++) {
					if (i==0) len = 10;
					else if (i>=1 && i<=2) len = 9;
					else if (i>=3 && i<=6) len = 8;
					else if (i>=7 && i<=14) len = 7;
					else if (i>=15 && i<=30) len = 6;
					else if (i>=31 && i<=62) len = 5;
					else if (i>=63 && i<=126) len = 4;
					else len = 3;
					PUSH_INT (VAR_c_CellChannel_Range1024 (Source->u.Range1024).W.data [i], len);
				}
				break;
			}
			/*---------------------------------------------------------
				DETECT BITMAP 512 RANGE (signature 1000100)
			---------------------------------------------------------*/
			case U_c_CellChannel_Range512: {
				PUSH_INT (0x44, 7); /* Signature */

				PUSH_INT (VAR_c_CellChannel_Range512 (Source->u.Range512).OrigARFCN, 10);

				for (i=0; i < VAR_c_CellChannel_Range512 (Source->u.Range512).W.items; i++) {
					if (i==0) len = 9;
					else if (i>=1 && i<=2) len = 8;
					else if (i>=3 && i<=6) len = 7;
					else if (i>=7 && i<=14) len = 6;
					else if (i>=15 && i<=30) len = 5;
					else if (i>=31 && i<=62) len = 4;
					else if (i>=63 && i<=126) len = 3;
					else len = 2;
					PUSH_INT (VAR_c_CellChannel_Range512 (Source->u.Range512).W.data [i], len);
				}

				break;
			}
			/*---------------------------------------------------------
				DETECT BITMAP 256 RANGE (signature 1000101)
			---------------------------------------------------------*/
			case U_c_CellChannel_Range256: {
				PUSH_INT (0x45, 7); /* Signature */

				PUSH_INT (VAR_c_CellChannel_Range256 (Source->u.Range256).OrigARFCN, 10);

				for (i=0; i<VAR_c_CellChannel_Range256 (Source->u.Range256).W.items; i++) {
					if (i==0) len = 8;
					else if (i>=1 && i<=2) len = 7;
					else if (i>=3 && i<=6) len = 6;
					else if (i>=7 && i<=14) len = 5;
					else if (i>=15 && i<=30) len = 4;
					else if (i>=31 && i<=62) len = 3;
					else if (i>=63 && i<=126) len = 2;
					else len = 1;
					PUSH_INT (VAR_c_CellChannel_Range256 (Source->u.Range256).W.data [i], len);
				}

				break;
			}
			/*---------------------------------------------------------
				DETECT BITMAP 128 RANGE (signature 1000110)
			---------------------------------------------------------*/
			case U_c_CellChannel_Range128: {
				PUSH_INT (0x46, 7); /* Signature */

				PUSH_INT (VAR_c_CellChannel_Range128 (Source->u.Range128).OrigARFCN, 10);

				for (i=0; i<VAR_c_CellChannel_Range128 (Source->u.Range128).W.items; i++) {
					if (i==0) len = 7;
					else if (i>=1 && i<=2) len = 6;
					else if (i>=3 && i<=6) len = 5;
					else if (i>=7 && i<=14) len = 4;
					else if (i>=15 && i<=30) len = 3;
					else if (i>=31 && i<=62) len = 2;
					else len = 1;

					PUSH_INT (VAR_c_CellChannel_Range128 (Source->u.Range128).W.data [i], len);
				}

				break;
			}
			/*---------------------------------------------------------
				DETECT BITMAP VARIABLE (signature 1000111)
			---------------------------------------------------------*/
			case U_c_CellChannel_Variable: {
				PUSH_INT (0x47, 7); /* Signature */

				PUSH_INT (VAR_c_CellChannel_Variable (Source->u.Variable).OrigARFCN, 10);

				for (i=0; i<VAR_c_CellChannel_Variable (Source->u.Variable).RRFCN.items; i++) {
					PUSH_INT (VAR_c_CellChannel_Variable (Source->u.Variable).RRFCN.data [i], 1);
				}

				break;
			}
			/*---------------------------------------------------------
				UNKNOWN CODING!
			---------------------------------------------------------*/
			default: return ED_SYNTAX_ERROR;
		}

		/* Pad with zeroes */
		len = (8 - (CURPOS & 7)) & 7;
		if (len > 0) PUSH_INT (0, len);

		return CURPOS-BitOffset;
	}%

	decode %{
		int i, len;

		/* Determine which type of encoding we have */
		int Signature = EDBitsToInt (Buffer, CURPOS, 7);

		/* Make sure spare bits are set to 0 */
		Signature &= 0x47;

		/*---------------------------------------------------------
			DETECT BITMAP 0 FORMAT (signature 00XXX)
		---------------------------------------------------------*/
		if ((Signature & 0x60) == 0x00) {
			int len = Length-4;
			if (len > 124) len = 124;
			SETPRESENT_c_CellChannel_BitMap0 (Destin);
			CURPOS += 4;
			ADDITEMS_c_CellChannel_BitMap0 (&(VAR_c_CellChannel_BitMap0 (Destin->u.BitMap0)), len);
			for (i=0; i<len; i++) {
				VAR_c_CellChannel_BitMap0 (Destin->u.BitMap0).data [len-i-1] = (unsigned char)SHIFT_INT (1);
			}
			VAR_c_CellChannel_BitMap0 (Destin->u.BitMap0).items = i;
		}
		/*---------------------------------------------------------
			DETECT BITMAP 1024 RANGE (signature 10000XX)
		---------------------------------------------------------*/
		else if ((Signature & 0x64) == 0x40) {
			SETPRESENT_c_CellChannel_Range1024 (Destin);
			CURPOS += 5;
			VAR_c_CellChannel_Range1024 (Destin->u.Range1024).F0 = (unsigned char)SHIFT_INT (1);

			for (i=0; i<64; i++) {
				if (i==0) len = 10;
				else if (i>=1 && i<=2) len = 9;
				else if (i>=3 && i<=6) len = 8;
				else if (i>=7 && i<=14) len = 7;
				else if (i>=15 && i<=30) len = 6;
				else if (i>=31 && i<=62) len = 5;
				else if (i>=63 && i<=126) len = 4;
				else len = 3;
				if (CURPOS - BitOffset + len > Length) break;
				ADDITEMS_c_CellChannel_Range1024_W (&(VAR_c_CellChannel_Range1024 (Destin->u.Range1024).W), 1);
				VAR_c_CellChannel_Range1024 (Destin->u.Range1024).W.data [i] = SHIFT_INT (len);
			}
			VAR_c_CellChannel_Range1024 (Destin->u.Range1024).W.items = i;
		}
		/*---------------------------------------------------------
			DETECT BITMAP 512 RANGE (signature 1000100)
		---------------------------------------------------------*/
		else if ((Signature & 0x67) == 0x44) {
			SETPRESENT_c_CellChannel_Range512 (Destin);
			CURPOS += 7;
			VAR_c_CellChannel_Range512 (Destin->u.Range512).OrigARFCN = SHIFT_INT (10);

			for (i=0; i<64; i++) {
				if (i==0) len = 9;
				else if (i>=1 && i<=2) len = 8;
				else if (i>=3 && i<=6) len = 7;
				else if (i>=7 && i<=14) len = 6;
				else if (i>=15 && i<=30) len = 5;
				else if (i>=31 && i<=62) len = 4;
				else if (i>=63 && i<=126) len = 3;
				else len = 2;
				if (CURPOS - BitOffset + len > Length) break;
				ADDITEMS_c_CellChannel_Range512_W (&(VAR_c_CellChannel_Range512 (Destin->u.Range512).W), 1);
				VAR_c_CellChannel_Range512 (Destin->u.Range512).W.data [i] = SHIFT_INT (len);
			}
			VAR_c_CellChannel_Range512 (Destin->u.Range512).W.items = i;
		}
		/*---------------------------------------------------------
			DETECT BITMAP 256 RANGE (signature 1000101)
		---------------------------------------------------------*/
		else if ((Signature & 0x67) == 0x45) {
			SETPRESENT_c_CellChannel_Range256 (Destin);
			CURPOS += 7;
			VAR_c_CellChannel_Range256 (Destin->u.Range256).OrigARFCN = SHIFT_INT (10);

			for (i=0; i<64; i++) {
				if (i==0) len = 8;
				else if (i>=1 && i<=2) len = 7;
				else if (i>=3 && i<=6) len = 6;
				else if (i>=7 && i<=14) len = 5;
				else if (i>=15 && i<=30) len = 4;
				else if (i>=31 && i<=62) len = 3;
				else if (i>=63 && i<=126) len = 2;
				else len = 1;
				if (CURPOS - BitOffset + len > Length) break;
				ADDITEMS_c_CellChannel_Range256_W (&(VAR_c_CellChannel_Range256 (Destin->u.Range256).W), 1);
				VAR_c_CellChannel_Range256 (Destin->u.Range256).W.data [i] = SHIFT_INT (len);
			}
			VAR_c_CellChannel_Range256 (Destin->u.Range256).W.items = i;
		}
		/*---------------------------------------------------------
			DETECT BITMAP 128 RANGE (signature 1000110)
		---------------------------------------------------------*/
		else if ((Signature & 0x67) == 0x46) {
			SETPRESENT_c_CellChannel_Range128 (Destin);
			CURPOS += 7;

			VAR_c_CellChannel_Range128 (Destin->u.Range128).OrigARFCN = SHIFT_INT (10);

			for (i=0; i<64; i++) {
				if (i==0) len = 7;
				else if (i>=1 && i<=2) len = 6;
				else if (i>=3 && i<=6) len = 5;
				else if (i>=7 && i<=14) len = 4;
				else if (i>=15 && i<=30) len = 3;
				else if (i>=31 && i<=62) len = 2;
				else len = 1;
				if (CURPOS - BitOffset + len > Length) break;
				ADDITEMS_c_CellChannel_Range128_W (&(VAR_c_CellChannel_Range128 (Destin->u.Range128).W), 1);
				VAR_c_CellChannel_Range128 (Destin->u.Range128).W.data [i] = SHIFT_INT (len);
			}
			VAR_c_CellChannel_Range128 (Destin->u.Range128).W.items = i;
		}
		/*---------------------------------------------------------
			DETECT BITMAP VARIABLE (signature 1000111)
		---------------------------------------------------------*/
		else if ((Signature & 0x67) == 0x47) {
			SETPRESENT_c_CellChannel_Variable (Destin);
			CURPOS += 7;

			VAR_c_CellChannel_Variable (Destin->u.Variable).OrigARFCN = SHIFT_INT (10);
			for (i=0; (CURPOS - BitOffset < Length) && i<111; i++) {
				ADDITEMS_c_CellChannel_Variable_RRFCN (&(VAR_c_CellChannel_Variable (Destin->u.Variable).RRFCN), 1);
				VAR_c_CellChannel_Variable (Destin->u.Variable).RRFCN.data [i] = (unsigned char)SHIFT_INT (1);
			}
			VAR_c_CellChannel_Variable (Destin->u.Variable).RRFCN.items = i;
		}
		/*---------------------------------------------------------
			UNKNOWN CODING!
		---------------------------------------------------------*/
		else {
			return ED_SYNTAX_ERROR;
		}

		return CURPOS - BitOffset + ((8 - (CURPOS & 7)) & 7);
	}%
}


#NAME BA_List_Pref
#BEGIN TS44.018,10.5.2.1c
#------------------------------------
# TS 44.018, 10.5.2.1c
#------------------------------------
csn.1 {
	<BA List Pref>::=
		{1 <Range: RANGE LIMITS >}**0
		{1 <BA FREQ : bit (10)>}**0
		<spare padding>;

	slave <RANGE LIMITS>::=
		<RANGE LOWER : bit (10)>
		<RANGE UPPER : bit (10)>;
}

#BEGIN TS44.018,10.5.2.1d
#------------------------------------
# TS 44.018, 10.5.2.1d
#------------------------------------
csn.1 {
	<UTRANFreqList>::=
		{ 1 < FDD_ARFCN : bit (14)> } ** 0 		-- FDD frequencies
		{ 1 < TDD_ARFCN : bit (14)> } ** 0 		-- TDD frequencies
		<spare padding>;
}


#BEGIN TS44.018,10.5.2.1e
#------------------------------------
# TS 44.018, 10.5.2.1e
#------------------------------------
csn.1 {
	<CellSelIndAfterReleaseTCHandSDCCH> ::=
		{	000 	{ 1	<GSM Description : <GSM Description struct >> } ** 0
			| 001	{ 1	<UTRAN FDD Description : < UTRAN FDD Description struct CS >> } ** 0
			| 010	{ 1	<UTRAN TDD Description : < UTRAN TDD Description struct CS >> } ** 0
			| 011	{ 1	<E-UTRAN Description : < E-UTRAN Description struct >> } ** 0 }
		<spare padding>;

	slave < GSM Description struct > ::=
		< Band_Indicator {boolean enum {
				0	= "ARFCN indicates 1800 band"
				1	= "ARFCN indicates 1900 band"
			}} : bit
		>
		< ARFCN : bit (10) >
		< BSIC : bit (6) > ;

	slave < UTRAN FDD Description struct CS > ::=
		{ 0 | 1	< Bandwidth_FDD : bit (3) > }
		< FDD-ARFCN : bit (14) >
		{ 0 | 1	< FDD_Indic0 : bit >
				{
					{
						< NR_OF_FDD_CELLS : 00001> <Diversity: bit> <Scrambling code: bit (9)>
					}
					|
					{
						< NR_OF_FDD_CELLS : bit (5) - 00001>
						< FDD_CELL_INFORMATION Field {FDD_CELL_INFORMATION}: bit (DECODE_FDD_CELL_INFORMATION_p(NR_OF_FDD_CELLS)) >  
					}
																						-- p(x) defined in table 9.1.54.1
				}
			};

	slave < UTRAN TDD Description struct CS > ::=
		{ 0 | 1	< Bandwidth_TDD : bit (3) > }
		< TDD-ARFCN : bit (14) >
		{ 0 | 1	< TDD_Indic0 : bit >
				< NR_OF_TDD_CELLS : bit (5) >
				< TDD_CELL_INFORMATION Field {TDD_CELL_INFORMATION}: bit (DECODE_TDD_CELL_INFORMATION_q(NR_OF_TDD_CELLS)) > } ;
																				-- q(x) defined in table 9.1.54.1

	slave < E-UTRAN Description struct > ::=
		< EARFCN : bit (16) >
		{ 0 | 1 < Measurement Bandwidth : bit (3) > }
		{ 0 | 1 < Not Allowed Cells: < PCID Group IE > > }
		{ 0 | 1 < TARGET_PCID : bit (9) > };


}


#BEGIN TS44.018,10.5.2.2
#------------------------------------
# TS 44.018, 10.5.2.2
#------------------------------------
bit-field CellDescription {
	size: 2 octets;
	bits 15-16: BCCHArfcnHi integer;
	bits 12-14: NCC integer;
	bits 9-11: BCC integer;
	bits 1-8: BCCHArfcnLo integer;
}
#BEGIN TS44.018,10.5.2.3
#------------------------------------
# TS 44.018, 10.5.2.3
#------------------------------------
bit-field CellOptions {
  size: 1 octet;
  bit 8: DN_IND boolean enum {
		b0 = "Dynamic ARFCN mapping is not used by the PLMN"
		b1 = "Dynamic ARFCN mapping is used by the PLMN"
  };
  bit 7: PWRC boolean enum {
		b0	= "PWRC is not set"
		b1	= "PWRC is set"
  };
  bits 5-6: DTX integer enum {
		b00	= "The MSs may use uplink discontinuous transmission"
		b01	= "The MSs shall use uplink discontinuous transmission"
		b10	= "The MS shall not use uplink discontinuous transmission"
  };
  bits 1-4: RadioLinkTimeout integer;
}
#BEGIN TS44.018,10.5.2.4
#------------------------------------
# TS 44.018, 10.5.2.4
#------------------------------------
bit-field CellSelParam {
  size: 2 octets;
  bits 14-16: CellReseHyst integer enum {
		b000 = "0 dB RXLEV hysteresis for LA re-selection"
		b001 = "2 dB RXLEV hysteresis for LA re-selection"
		b010 = "4 dB RXLEV hysteresis for LA re-selection"
		b011 = "6 dB RXLEV hysteresis for LA re-selection"
		b100 = "8 dB RXLEV hysteresis for LA re-selection"
		b101 = "10 dB RXLEV hysteresis for LA re-selection"
		b110 = "12 dB RXLEV hysteresis for LA re-selection"
		b111 = "14 dB RXLEV hysteresis for LA re-selection"
  };
  bits 9-13: MsTxpwrMaxCch integer;
  bit 8: ACS boolean;
  bit 7: NECI boolean enum {
		0	= "New establishment causes are not supported"
		1 = "New establishment causes are supported"
  };
  bits 1-6: RxLevAccessMin integer;
}

#BEGIN TS44.018,10.5.2.4a
#------------------------------------
# TS 44.018, 10.5.2.4a
#------------------------------------
bit-field MACModeAndChCodReq {
	size: 4 bits;
	bits 3-4: Mac0Mode integer;
	bits 1-2: CS integer;
}

#BEGIN TS44.018,10.5.2.5
#------------------------------------
# TS 44.018, 10.5.2.5
#------------------------------------
dcl-type TChType {
  size 5 bits;
  type struct {
    ChType: integer enum {
      b00001 = "TCH/F + ACCHs"
      b00010 = "TCH/H + ACCHs"
      b00100 = "SDCCH/4 + SACCH/C4 or CBCH (SDCCH/4)"
      b01000 = "SDCCH/8 + SACCH/C8 or CBCH (SDCCH/8)"
    };
    Subchannel: integer;
    optional TSCSet: boolean enum {
    	b0 = "TSC Set 1 shall be used"
    	b1 = "TSC Set 2 shall be used"
    };
  }

  encode %{
    int Value = 0;
    int EncodeSBit = 0;
    switch (Source->ChType) {
      case 1: Value = 1; EncodeSBit=1; break;
      case 2: Value = 2 | (Source->Subchannel & 0x01); EncodeSBit=1; break;
      case 4: Value = 4 | (Source->Subchannel & 0x03); break;
      case 8: Value = 8 | (Source->Subchannel & 0x07); break;
    }
    
    /* Encode the S (TCSSet) bit */
    if (EncodeSBit && GETPRESENT_c_TChType_TSCSet (Source) && Source->TSCSet) {
    	Value |= 16;
    }
    
    PUSH_INT (Value, 5);
    return 5;
  }%

  decode %{
    int Value = SHIFT_INT (5);
    int DecodeSBit = 0;
    if ((Value & 0x0F) == 1) {
      Destin->Subchannel = 0;
      Destin->ChType = 1;
      DecodeSBit = 1;
    }
    else if ((Value & 0x18) == 0x08) {
      Destin->Subchannel = Value & 0x07;
      Destin->ChType = 8;
    }
    else if ((Value & 0x1C) == 0x04) {
      Destin->Subchannel = Value & 0x03;
      Destin->ChType = 4;
    }
    else if ((Value & 0x0E) == 0x02) {
      Destin->Subchannel = Value & 0x01;
      Destin->ChType = 2;
      DecodeSBit = 1;
    }
    if (DecodeSBit) {
    	SETPRESENT_c_TChType_TSCSet (Destin, ED_TRUE);
    	Destin->TSCSet = (((Value & 0x10) == 0x10) ? ED_TRUE : ED_FALSE);
    }

    return 5;
  }%
}

bit-field TChDesc {
  size: 3 octets;
  octet 1 bits 4-8: ChType TChType;
  octet 1 bits 1-3: TN integer;
  octet 2 bits 6-8: TSC integer;
  octet 2 bit  5  : H boolean enum {
		0	= "Single RF channel"
		1	= "RF hopping channel"
  };

  octet 3 conditional %{DATA.H}% {
    bits 7-12: MAIO integer;
    bits 1-6: HSN integer;
  };
  octet 3 conditional %{!DATA.H}% {
    bit 11-12: spare void default=0;
    bits 1-10: ARFCN integer;
  };
}


#BEGIN TS44.018,10.5.2.5a
#------------------------------------
# TS 44.018, 10.5.2.5a
#------------------------------------
dcl-type TChType2 {
  size 5 bits;
  type struct {
    ChType: integer enum {
			b00001 = "TCH/F + ACCHs"
			b00010 = "TCH/H + ACCHs"
			b00100 = "SDCCH/4 + SACCH/C4 or CBCH (SDCCH/4)"
			b01000 = "SDCCH/8 + SACCH/C8 or CBCH (SDCCH/8)"
			b11000 = "TCH/F + ACCHs using TSC Set 2"
			b11100 = "TCH/H + ACCHs using TSC Set 2"
			b10000 = "TCH/F + FACCH/F and SACCH/M at the time slot indicated by TN and no additional timeslots"
			b10001 = "TCH/F + FACCH/F and SACCH/M at the time slot indicated by TN and additional bidirectional TCH/Fs and SACCH/Ms at timeslot n-1"
			b10010 = "TCH/F + FACCH/F and SACCH/M at the time slot indicated by TN and additional bidirectional TCH/Fs and SACCH/Ms at timeslot n+1, n-1"
			b10011 = "TCH/F + FACCH/F and SACCH/M at the time slot indicated by TN and additional bidirectional TCH/Fs and SACCH/Ms at timeslot n+1, n-1 and n-2"
			b10100 = "TCH/F + FACCH/F and SACCH/M at the time slot indicated by TN and additional bidirectional TCH/Fs and SACCH/Ms at timeslot n+1, n-1, n-2, and n-3"
			b10101 = "TCH/F + FACCH/F and SACCH/M at the time slot indicated by TN and additional bidirectional TCH/Fs and SACCH/Ms at timeslot n+1, n-1, n-2, n-3 and n-4"
			b10110 = "TCH/F + FACCH/F and SACCH/M at the time slot indicated by TN and additional bidirectional TCH/Fs and SACCH/Ms at timeslot n+1, n-1, n-2, n-3, n-4 and n-5"
			b10111 = "TCH/F + FACCH/F and SACCH/M at the time slot indicated by TN and additional bidirectional TCH/Fs and SACCH/Ms at timeslot n+1, n-1, n-2, n-3, n-4, n-5 and n-6"
			b11001 = "TCH/F + FACCH/F and SACCH/M at the time slot indicated by TN and additional unidirectional TCH/FDs and SACCH/MDs at timeslot n-1"
			b11010 = "TCH/F + FACCH/F and SACCH/M at the time slot indicated by TN and additional unidirectional TCH/FDs and SACCH/MDs at timeslot n+1, n-1"
			b11011 = "TCH/F + FACCH/F and SACCH/M at the time slot indicated by TN and additional unidirectional TCH/FDs and SACCH/MDs at timeslot n+1, n-1 and n-2"
			b11110 = "TCH/F + FACCH/F and SACCH/M at the time slot indicated by TN and additional bidirectional TCH/F and SACCH/M at timeslot n+1 and unidirectional TCH/FD and SACCH/MD at timeslot n-1"
   };
    Subchannel: integer;
  }

  encode %{
    int Value = 0;
    switch (Source->ChType) {
      case 1: Value = 1; break;
      case 2: Value = 2 | (Source->Subchannel & 0x01); break;
      case 4: Value = 4 | (Source->Subchannel & 0x03); break;
      case 8: Value = 8 | (Source->Subchannel & 0x07); break;
      case 28: Value = 28 | (Source->Subchannel & 0x01); break;
      default: Value = Source->ChType;
    }
    
    PUSH_INT (Value, 5);
    return 5;
  }%

  decode %{
    int Value = SHIFT_INT (5);
    if ((Value & 0x1E) == 0x1C) {
      Destin->Subchannel = Value & 0x01;
      Destin->ChType = 0x1C;
    }
    else if ((Value & 0x18) == 0x08) {
      Destin->Subchannel = Value & 0x07;
      Destin->ChType = 8;
    }
    else if ((Value & 0x1C) == 0x04) {
      Destin->Subchannel = Value & 0x03;
      Destin->ChType = 4;
    }
    else if ((Value & 0x1E) == 0x02) {
      Destin->Subchannel = Value & 0x01;
      Destin->ChType = 2;
    }
    else {Destin->ChType = Value;}

    return 5;
  }%
}

bit-field TChDesc2 {
  size: 3 octets;
  octet 1 bits 4-8: ChType TChType2;
  octet 1 bits 1-3: TN integer;
  octet 2 bits 6-8: TSC integer;
  octet 2 bit  5  : H boolean enum {
		0	= "Single RF channel"
		1	= "RF hopping channel"
  };

  octet 3 conditional %{DATA.H}% {
    bits 7-12: MAIO integer;
    bits 1-6: HSN integer;
  };
  octet 3 conditional %{!DATA.H}% {
    bit 11-12: spare void default=0;
    bits 1-10: ARFCN integer;
  };
}

#BEGIN TS44.018,10.5.2.5c
#------------------------------------
# TS 44.018, 10.5.2.5c
#------------------------------------
bit-field TChDesc3 {
  size: 2 octets;
  octet 1 bits 6-8: TSC integer;
  octet 1 bit  5  : H boolean enum {
		0	= "Single RF channel"
		1	= "RF hopping channel"
  };

  octet 2 conditional %{DATA.H}% {
    bits 7-12: MAIO integer;
    bits 1-6: HSN integer;
  };
  octet 2 conditional %{!DATA.H}% {
    bit 11-12: spare void default=0;
    bits 1-10: ARFCN integer;
  };
}


#BEGIN TS44.018,10.5.2.6
#------------------------------------
# TS 44.018, 10.5.2.6
#------------------------------------
bit-field ChannelMode {
	size: 1 octet;
	bits 1-8: Mode octet enum {
			b00000000 = "signalling only"
			b00000001 = "speech full rate or half rate version 1"
			b00100001 = "speech full rate or half rate version 2"
			b01000001 = "speech full rate or half rate version 3"
			b10000001 = "speech full rate or half rate version 4"
			b10000010 = "speech full rate or half rate version 5"
			b10000011 = "speech full rate or half rate version 6"
			b01100001 = "data, 43.5 kbit/s (downlink)+14.5 kbps (uplink)"
			b01100010 = "data, 29.0 kbit/s (downlink)+14.5 kbps (uplink)"
			b01100100 = "data, 43.5 kbit/s (downlink)+29.0 kbps (uplink)"
			b01100111 = "data, 14.5 kbit/s (downlink)+43.5 kbps (uplink)"
			b01100101 = "data, 14.5 kbit/s (downlink)+29.0 kbps (uplink)"
			b01100110 = "data, 29.0 kbit/s (downlink)+43.5 kbps (uplink)"
			b00100111 = "data, 43.5 kbit/s radio interface rate"
			b01100011 = "data, 32.0 kbit/s radio interface rate"
			b01000011 = "data, 29.0 kbit/s radio interface rate"
			b00001111 = "data, 14.5 kbit/s radio interface rate"
			b00000011 = "data, 12.0 kbit/s radio interface rate"
			b00001011 = "data, 6.0 kbit/s radio interface rate"
			b00010011 = "data, 3.6 kbit/s radio interface rate"
			b00010000 = "data, 64.0 kbit/s Transparent Data Bearer (Note 2)"
	};
}


#BEGIN TS44.018,10.5.2.7c
#------------------------------------
# TS 44.018, 10.5.2.7c
#------------------------------------
bit-field ClassmarkEnquiryMask {
	size: 1 octet;
	bit 8: ClassmarkChange boolean;
	bits 5-7: UTRANClassmarkChange integer;
	bit 4: CDMAClassmarkChange boolean;
	bits 1-3: spare void default=0;
}

#BEGIN TS44.018,10.5.2.8
#------------------------------------
# TS 44.018, 10.5.2.8
#------------------------------------
bit-field ChannelNeeded {
	size: 4 bits;
	bits 1-2: Channel1 integer enum {
		b00 = "Any channel"
		b01 = "SDCCH"
		b10 = "TCH/F (Full rate)"
		b11 = "TCH/H or TCH/F (Dual rate)"
	};
	bits 3-4: Channel2 integer enum {
		b00 = "Any channel"
		b01 = "SDCCH"
		b10 = "TCH/F (Full rate)"
		b11 = "TCH/H or TCH/F (Dual rate)"
	};
}

#BEGIN TS44.018,10.5.2.8a
#------------------------------------
# TS 44.018, 10.5.2.8a
#------------------------------------
bit-field ChannelRequestDesc {
	size: 5 octets;
	octet 1 bit 8: MTMO boolean;

	octet 5 conditional %{ !DATA.MTMO }% {
		bits 1-39: spare void default=0;
	};

	octet 5 conditional %{ DATA.MTMO }% {
		bit 37-39: spare2 void default=0;
		bit 35-36: Priority integer;
		bit 34: RLCMode boolean;
		bit 33: LLCFramType boolean;
		bits 17-32: ReqBandwidth integer;
		bits 1-16: RLCOctetCount integer;
	};
}
#NAME ChReqDesc2
#BEGIN TS44.018,10.5.2.8b
#------------------------------------
# TS 44.018, 10.5.2.8b
#------------------------------------
csn.1 {
	< ChReqDesc2 > ::=
		< PACKET_ESTABLISHMENT_CAUSE :bit(2) >
		< Channel Request Description : Channel Request Description IE >		-- Defined in 3GPP TS 44.060
		{ 0 | 1 < PFI : bit (7) > }
		< Multiple TBF Capability : bit >												-- Additions in Rel-6
		{	null | L			-- Receiver backward compatible with earlier version
			| H				-- Additions in Rel-7
				{	< RLC Non-persistent Mode Capability {boolean enum {
			b0 = "RLC Non-persistent Mode not supported"
			b1 = "RLC Non-persistent Mode supported"
		}}: bit >
					< Reduced Latency Capability {boolean enum {
			b0 = "The mobile station does not support Reduced TTI configurations and Fast Ack/Nack Reporting"
			b1 = "The mobile station supports Reduced TTI configurations and Fast Ack/Nack Reporting"
		}}: bit >
					< Uplink EGPRS2 {octet enum {
			b00 = "The mobile station does not support either EGPRS2-A or EGPRS2-B  in the uplink"
			b01 = "The mobile station supports EGPRS2-A in the uplink"
			b10 = "The mobile station supports both EGPRS2-A and EGPRS2-B in the uplink"
			b11 = "This value is not used in this release/version of the specifications. If received it shall be interpreted as '10'"
		}}: bit(2) >
					< Downlink EGPRS2 {octet enum {
			b00 = "The mobile station does not support either EGPRS2-A or EGPRS2-B  in the downlink"
			b01 = "The mobile station supports EGPRS2-A in the downlink"
			b10 = "The mobile station supports both EGPRS2-A and EGPRS2-B in the downlink"
			b11 = "This value is not used in this release/version of the specifications. If received it shall be interpreted as '10'"
		}}: bit(2) > }
			{ 	null | L		-- Receiver backward compatible with earlier version
				| H			-- Additions in Rel-9
					{	< EMST_MS_Capability : bit > }
					{ 	null | L		-- Receiver backward compatible with earlier version
						| H			-- Additions in Rel-10
							{	< EMSR_MS_Capability : bit > }
							{ 	null | L		-- Receiver backward compatible with earlier version
								| H			-- Additions in Rel-11
									{	< FANR_Capability : bit > }
							}	-- End of aditions for Rel-11
					} 	-- End of additions for Rel-10
			}	-- End of additions for Rel-9
	}	-- End of additions for Rel-7
		< spare padding >;
}
#BEGIN TS44.018,10.5.2.9
#------------------------------------
# TS 44.018, 10.5.2.9
#------------------------------------
bit-field CipherModeSetting {
	size: 4 bits;
	bit 1: SC boolean enum {
			b0 = "No ciphering"
			b1 = "Start ciphering"
		};
	bits 2-4: AlgIdent octet enum {
			b000 = "cipher with algorithm A5/1"
			b001 = "cipher with algorithm A5/2"
			b010 = "cipher with algorithm A5/3"
			b011 = "cipher with algorithm A5/4"
			b100 = "cipher with algorithm A5/5"
			b101 = "cipher with algorithm A5/6"
			b110 = "cipher with algorithm A5/7"
			b111 = "reserved"
		};
}
#BEGIN TS44.018,10.5.2.10
#------------------------------------
# TS 44.018, 10.5.2.10
#------------------------------------
bit-field CipherResponse {
	size: 4 bits;
	bit 1: CR boolean enum {
			b0 = "IMEISV shall not be included"
			b1 = "IMEISV shall be included"
		};
	bits 2-4: spare void default=0;
}
#BEGIN TS44.018,10.5.2.11
#------------------------------------
# TS 44.018, 10.5.2.11
#------------------------------------
bit-field CtrlChannelDesc {
  size: 3 octets;
  octet 1 {
    bit 8: MSCR boolean enum {
			0	= "MSC is Release '98 or older"
			1 = "MSC is Release '99 onwards"
    };
    bit 7: ATT boolean enum {
			0 = "MSs in the cell are not allowed to apply IMSI attach and detach procedure"
			1 = "MSs in the cell shall apply IMSI attach and detach procedure"
    };
    bits 4-6: BsAgBlksRes integer;
    bits 1-3: CCCHConf integer enum {
			b000 = "1 basic physical channel used for CCCH, not combined with SDCCHs"
			b001 = "1 basic physical channel used for CCCH, combined with SDCCHs"
			b010 = "2 basic physical channel used for CCCH, not combined with SDCCHs"
			b100 = "3 basic physical channel used for CCCH, not combined with SDCCHs"
			b110 = "4 basic physical channels used for CCCH, not combined with SDCCHs"
    };
  };
  octet 2 {
    bit  8:   spare1 void default=0;
    bits 6-7: CBQ3 integer enum {
			b00 = "Iu mode not supported"
			b01 = "Iu mode capable MSs barred"
			b10 = "Iu mode supported, cell not barred"
			b11 = "Iu mode supported, cell not barred. The network shall not use this value"
    };
    bits 4-5: spare2 void default=0;
    bits 1-3: BsPaMfrms integer enum {
			b000 = "2 multiframes period for transmission of PAGING REQUEST messages to the same paging subgroup"
			b001 = "3 multiframes period for transmission of PAGING REQUEST messages to the same paging subgroup"
			b010 = "4 multiframes period for transmission of PAGING REQUEST messages to the same paging subgroup"
    };
  };
  octet 3 {
    bits 1-8: T3212TimeOutValue integer;
  };
}

#BEGIN TS44.018,10.5.2.11a
#------------------------------------
# TS 44.018, 10.5.2.11a
#------------------------------------
csn.1 {
	<DTMInfoRestOctets> ::=
		< MAX_LAPDm : bit (3) >
		< GPRS_MS_TXPWR_MAX_CCH : bit (5) >
		< Cell identity: bit (16) >
		{
			null
			| L			-- Receiver backward compatible with earlier version
			| H				-- Additions for REL-6
				{	0			-- MBMS procedures not supported by the cell if the choice bit is set to '0'
					| 1			-- MBMS procedures supported by the cell if the choice bit is set to '1'
					< DEDICATED_MODE_MBMS_NOTIFICATION_SUPPORT: bit >
					< MNCI_SUPPORT: bit >
				}
		}
		< spare padding >;
}

#BEGIN TS44.018,10.5.2.11b
#------------------------------------
# TS 44.018, 10.5.2.11b
#------------------------------------
csn.1 {
	< DynamicARFCNMapping >::=
		-- length of value part in octets
		-- Commented because probably already included in the "L" part of TLV
		-- < LENGTH OF DYNAMIC ARFCN MAPPING : bit (8) >
		< DYNAMIC ARFCN MAPPING Description : { 1 < DYNAMIC ARFCN MAPPING > } ** 
			{{0 < spare bit >** | null} = 0}
		>;

	slave < DYNAMIC ARFCN MAPPING >::=
		< GSM_Band : bit (4) >
		< ARFCN_FIRST : bit (10) >
		< BAND_OFFSET: bit (10) >
		< ARFCN_RANGE : bit (7) > ;

}

#BEGIN TS44.018,10.5.2.12
#------------------------------------
# TS 44.018, 10.5.2.12
#------------------------------------
sequence IncSkipOfARFCN [16] integer size 4 bit;

bit-field FreqChannelSeq {
	size: 9 octets;
	octet 1 {
		bit 8: spare void default = 0;
		bits 1-7: LowestARFCN integer;
	};
	remainder: IncSkipOfARFCN IncSkipOfARFCN;
}
#NAME GrpChannelDesc
#BEGIN TS44.018,10.5.2.14b
#------------------------------------
# TS 44.018, 10.5.2.14b
#------------------------------------
sequence GrpChannelMA [72] boolean size 1 bit;

bit-field GrpChannelDesc {
	size: 3 octets;
	max size: 12 octets;
	octet 1 bits 4-8: ChType TChType;
	octet 1 bits 1-3: TN integer;
	octet 2 bits 6-8: TSC integer;
	octet 2 bit  5  : H boolean enum {
			b0 = "Single RF channel"
			b1 = "RF hopping channel"
		};

	octet 3 conditional %{DATA.H}% {
		bits 7-12: MAIO integer;
		bits 1-6: HSN integer;
	};
	octet 3 conditional %{!DATA.H}% {
		bit 11-12: spare void default=0;
		bits 1-10: ARFCN integer;
	};
	remainder: MA GrpChannelMA;
}
#BEGIN TS44.018,10.5.2.14c
#------------------------------------
# TS 44.018, 10.5.2.14c
#------------------------------------
bit-field GPRSResumption {
	size: 4 bits;
	bit 1: ACK boolean enum {
			b0 = "resumption of GPRS services not successfully acknowledged;"
			b1 = "resumption of GPRS services successfully acknowledged."
		};
	bits 2-4: spare void default=0;
}
#NAME GPRSBCastInfo
#BEGIN TS44.018,10.5.2.14d
#------------------------------------
# TS 44.018, 10.5.2.14d
#------------------------------------
csn.1 {
	< GPRSBCastInfo > ::=
		< GPRS Cell Options : < GPRS Cell Options IE > >
		< GPRS Power Control Parameters : < GPRS Power Control Parameters IE > >
		< spare padding >;
}

#BEGIN TS44.018,10.5.2.14f
#------------------------------------
# TS 44.018, 10.5.2.14f
#------------------------------------
bit-field GroupChannelDescription2 {
  size: 11 octets;
  octet 1 bits 4-8: ChType TChType;
  octet 1 bits 1-3: TN integer;
  octet 2 bits 6-8: TSC integer;
  octet 2 bit  5  : spare void default = 0;

  octet 3 {
    bits 7-12: MAIO integer;
    bits 1-6: HSN integer;
  };

  remainder: FrequencyList CellChannel;
}

#NAME IARestOctets
#BEGIN TS44.018,10.5.2.16
#------------------------------------
# TS 44.018, 10.5.2.16
#------------------------------------
csn.1 {
	<IARestOctets> ::=
		{
			{ <LL_detected {void}: null> LL <Compressed_Inter_RAT_HO_INFO_IND>
			 | <LH_detected {void}: null> LH
				{ 00 	< EGPRS Packet Uplink Assignment >
					| 01	< Multiple Blocks Packet Downlink Assignment >
				 | 1 	-- reserved for future use (however the value 7C for the first octet shall not be used)
				}
			| HL	< Length of frequency parameters : bit (6) >
					{ null 																-- Length of frequency parameters = 0
					|	0 0
						< MAIO : bit (6) >
						< Mobile Allocation : octet (val (Length of frequency parameters) - 1) >
					}
				< Compressed_Inter_RAT_HO_INFO_IND >
			 | <HH_detected {void}: null> HH
				{ 00 	< Packet Uplink Assignment >
				 | 01 	< Packet Downlink Assignment >
				 | 1 	< Second Part Packet Assignment  > }
			}
			{	null	| L		-- Receiver compatible with earlier release
				| H 				-- Additions in Release 10
					< Implicit Reject CS : bit >
					< Implicit Reject PS : bit >
			}
			<spare padding>
			|
			null
		};

  slave <Compressed_Inter_RAT_HO_INFO_IND> ::=
          L | <Compressed_Inter_RAT_HO_INFO_IND {void}: null> H;

	slave < EGPRS Packet Uplink Assignment > ::=
		< Extended RA : bit (5) >
		{ 0 | 1 < Access Technologies Request : Access Technologies Request struct > }
		{ 1
			< TFI_ASSIGNMENT : bit (5) >
			< POLLING {boolean enum {
			b0 = "no action is required from MS;"
			b1 = "MS shall send a PACKET CONTROL ACKNOWLEDGEMENT message in the uplink block specified by TBF Starting Time, on the assigned PDCH."
		}}: bit >
			{ 0 				-- Dynamic Allocation
				< USF: bit (3) >
				< USF_GRANULARITY : bit >
				{ 0 | 1 < P0 : bit (4) >
				< PR_MODE : bit (1) >}
			| 1					-- Fixed Allocation
				< ALLOCATION_BITMAP_LENGTH : bit (5) >
				< ALLOCATION_BITMAP : bit (val(ALLOCATION_BITMAP_LENGTH)) >
				{ 0 | 1 < P0 : bit (4) >
					< BTS_PWR_CTRL_MODE : bit (1) >
					< PR_MODE : bit (1) > }
			}
			< EGPRS CHANNEL_CODING_COMMAND : < EGPRS Modulation and Coding IE>>
			< TLLI_BLOCK_CHANNEL_CODING : bit (1) >
			{ 0 | 1 < BEP_PERIOD2 : bit (4) > }
			< RESEGMENT : bit (1) >
			< EGPRS Window Size : < EGPRS Window Size IE>>
			{ 0 | 1 < ALPHA : bit (4) >}
			< GAMMA : bit (5) >
			{ 0 | 1 < TIMING_ADVANCE_INDEX : bit (4) > }
			{ 0 | 1 < TBF_STARTING_TIME : bit (16) > }
			{	null | L 									-- Receiver compatible with earlier release
				| H 											-- Additions for Rel-7
					{ 0												-- An uplink  BTTI TBF is assigned
				     { 0   -- '0' indicates that FANR is not activated
				     | 1 	-- '1' indicates that FANR is  activated
								{ 0 		-- SSN-based encoding is selected
								| 1 		-- Time-based encoding is selected
									< REPORTED TIMESLOTS : bit (8) >
									< TSH : bit (2) > -- Removed in 44.018 V8.12.0, present in V10.8.0
							}
						}
					   | 1											-- An uplink RTTI TBF is assigned
						<RTTI USF MODE : bit(1)>
						<PDCH PAIR INDICATION: bit(3) >
						< Additional_USF : bit (3) >*(1-val(RTTI USF MODE))
						{ 0 														-- One PDCH Pair assigned
							|  1		< USF2 : bit(3)>							-- Two PDCH Pairs assigned
									< Additional_USF2 : bit (3) >*(1-val(RTTI USF MODE)) }
						{ 0 													-- SSN-based approach is used
						   | 	1 	< REPORTED TIMESLOTS : bit (8) >	-- Time-based approach is used
								-- < TSH : bit (2) > -- Removed in 44.018 V10.8.0
							}
					}
			}
		| 0			-- Multi Block Allocation
			{ 0 | 1 < ALPHA : bit (4) > }
			< GAMMA : bit (5) >
			< TBF_STARTING_TIME : bit (16) >
			< NUMBER OF RADIO BLOCKS ALLOCATED : bit (2) >
			{ 0 | 1 < P0 : bit (4) >
					< BTS_PWR_CTRL_MODE : bit (1) > -- Always 0 in V10
					< PR_MODE : bit (1) > }
			{	null | L 												-- Receiver compatible with earlier release
				| H 														-- Additions for Rel-6
						{ 0 | 1 < PFI : bit (7) > }
			}
		} ;

	slave < Packet Uplink Assignment > ::=
		{ 1
			< TFI_ASSIGNMENT : bit (5) >
			< POLLING {boolean enum {
			b0 = "no action is required from MS;"
			b1 = "MS shall send a PACKET CONTROL ACKNOWLEDGEMENT message in the uplink block specified by TBF Starting Time, on the assigned PDCH"
		}}: bit >
			{ 0
								-- Dynamic Allocation
				< USF: bit (3) >
				< USF_GRANULARITY {boolean enum {
			b0 = "the mobile station shall transmit one RLC/MAC block;"
			b1 = "the mobile station shall transmit four consecutive RLC/MAC blocks."
		}}: bit >
				{ 0 | 1 < P0 : bit (4) >
				< PR_MODE : bit (1) > }
			| 1
								-- Fixed Allocation
				< ALLOCATION_BITMAP_LENGTH : bit (5) >
				< ALLOCATION_BITMAP : bit (val(ALLOCATION_BITMAP_LENGTH)) >
				{ 0 | 1 < P0 : bit (4) >
					< BTS_PWR_CTRL_MODE : bit (1) >
					< PR_MODE : bit (1) > }
			}
				< CHANNEL_CODING_COMMAND {octet enum {
			b00 = "coding scheme 1, CS-1;"
			b01 = "coding scheme 2, CS-2;"
			b10 = "coding scheme 3, CS-3;"
			b11 = "coding scheme 4, CS-4."
		}}: bit (2) >
				< TLLI_BLOCK_CHANNEL_CODING : bit >
			{ 0 | 1 < ALPHA : bit (4) > }
			< GAMMA : bit (5) >
			{ 0 | 1 < TIMING_ADVANCE_INDEX : bit (4) > }
			{ 0 | 1 < TBF_STARTING_TIME : bit (16) > }
		| 0
								-- Single Block Allocation
			{ 0 | 1 < ALPHA : bit (4) >}
			< GAMMA : bit (5) >
			0 1
							-- See Note
			< TBF_STARTING_TIME : bit (16) >
			{ L | H < P0 : bit (4) >
					< BTS_PWR_CTRL_MODE : bit (1) >
					< PR_MODE : bit (1) >}
		}
		{ null | L
						-- Receiver compatible with earlier release
		| H
								-- Additions for R99
			{ 0 | 1 < Extended RA : bit (5) > }
		}
		{ 	null | L 														-- Receiver compatible with earlier release
		| H 																-- Additions for Rel-6
			{ 0 | 1 < PFI : bit (7) > }
		};

	slave < Packet Downlink Assignment > ::=
		< TLLI : bit (32) >
		{ 0 | 1
			< TFI_ASSIGNMENT : bit (5) >
			< RLC_MODE {boolean enum {
			b0 = "RLC acknowledged mode;"
			b1 = "RLC unacknowledged mode."
		}}: bit >
			{ 0 | 1 < ALPHA : bit (4) > }
			< GAMMA : bit (5) >
			< POLLING {boolean enum {
			b0 = "no action is required from MS;"
			b1 = "MS shall send a PACKET CONTROL ACKNOWLEDGEMENT message in the uplink block specified by TBF Starting Time, on the assigned PDCH"
		}}: bit >
			< TA_VALID {boolean enum {
			b0 = "the timing advance value is not valid ;"
			b1 = "the timing advance value is valid."
		}}: bit (1) > }
		{ 0 | 1 < TIMING_ADVANCE_INDEX : bit (4) > }
		{ 0 | 1 < TBF_STARTING_TIME : bit (16) > }
		{ 0 | 1 < P0 : bit (4) >
				< BTS_PWR_CTRL_MODE : bit (1) >
				< PR_MODE : bit (1) > }
		{ null | L
						-- Receiver compatible with earlier release
		| H
								-- Additions for R99

								-- indicates EGPRS TBF mode, see

								-- 3GPP TS 44.060
			< EGPRS Window Size : < EGPRS Window Size IE >>
			< LINK_QUALITY_MEASUREMENT_MODE : bit (2) >
			{ 0 | 1 < BEP_PERIOD2 : bit (4) > }
		}
		{ 	null | L 														-- Receiver compatible with earlier release
			| H 																-- Additions for Rel-6
				{ 0 | 1 < PFI : bit (7) > }
		}
		{ 	null | L															-- Receiver compatible with earlier release
			| H 																-- Additions for Rel-7
				{ 0 | 1 < NPM Transfer Time : bit (5) > }
					{ 0						-- A downlink  BTTI TBF is assigned
						{ 0						-- FANR is not activated for the assigned TBF
						| 1						-- FANR is activated for the assigned TBF
							< EVENT_BASED_FANR: bit (1) > }
					| 1						-- A downlink  RTTI TBF is assigned
						< EVENT_BASED_FANR: bit (1) >
						< PDCH PAIR INDICATION: bit(3) >
					}
					< Downlink EGPRS Level: < EGPRS Level IE > >
		};

	slave < Second Part Packet Assignment > ::=
		{ null | L
						-- Receiver compatible with earlier release
		| H
								-- Additions for R99
			{ 0 | 1	< Extended RA : bit (5) > }
		} ;

	slave <Access Technologies Request struct> ::= -- recursive structure allows any combination of Access technologies
		<Access Technology Type : bit (4)>
		{ 0 | 1 <Access Technologies Request struct> };

	slave < Multiple Blocks Packet Downlink Assignment > ::=
		< TBF_STARTING_TIME : bit (16) >
		< NUMBER_OF_ALLOCATED_BLOCKS {octet enum {
			b00001 = "radio block reserved for downlink transmission;"
			b0001 = "2 radio blocks reserved for downlink transmission;"
			b0010 = "3 radio blocks reserved for downlink transmission;"
			b0011 = "4 radio blocks reserved for downlink transmission;"
			b0100 = "5 radio blocks reserved for downlink transmission;"
			b0101 = "6 radio blocks reserved for downlink transmission;"
			b0110 = "7 radio blocks reserved for downlink transmission;"
			b0111 = "8 radio blocks reserved for downlink transmission;"
			b1000 = "9 radio blocks reserved for downlink transmission."
		}}: bit (4) >
		{ 	0																	-- Reserved for future use
			| 1
				{	0															-- MBMS Assignment (Distribution)
						< TMGI : < TMGI IE > >
						{ 0 | 1 < MBMS Session Identity : bit (8) > }
					| 1															-- MBMS Assignment (Non-distribution)
						< TLLI / G-RNTI: bit (32) >
						{ 0 | 1	< Length Indicator of MS ID : bit (2) >
								< MS_ID : bit (val (Length Indicator of MS_ID)+1) >
								< PACKET_TIMING_ADVANCE : < Packet Timing Advance IE > >
								{ 0 | 1	< ALPHA : bit (4) >
										{ 0 | 1	< GAMMA : bit (5) > }
								}
						}
				}
		} ;

}
#NAME IARRestOctets
#BEGIN TS44.018,10.5.2.17
#------------------------------------
# TS 44.018, 10.5.2.17
#------------------------------------
csn.1 {
	<IARRestOctets> ::=
		-- Save the position where the message begins: we'll need it
		-- later to pad exactly to 3 octets
		ENCODECO: %{PUSH_TAG (1, CURPOS);}%
		{ 0 | 1 < Extended RA 1 : bit (5) > }
		{ 0 | 1 < Extended RA 2 : bit (5) > }
		{ 0 | 1 < Extended RA 3 : bit (5) > }
		{ 0 | 1 < Extended RA 4 : bit (5) > }
		{bit = L} * ENCODECO_EXPR: %{24 - (CURPOS - TAG(1))}%;
}
#NAME IAXRestOctets
#BEGIN TS44.018,10.5.2.18
#------------------------------------
# TS 44.018, 10.5.2.18
#------------------------------------
csn.1 {
	<IAXRestOctets> ::= < Compressed_Inter_RAT_HO_INFO_IND : bit >
		<spare padding>;
}

#NAME MeasurementResults
#BEGIN TS44.018,10.5.2.20
#------------------------------------
# TS 44.018, 10.5.2.20
#------------------------------------
csn.1 {
 < MeasurementResults > ::=
	LIMIT_SIZE (81): %{16*8}%
	ENCODECO: %{PUSH_TAG (2, CURPOS);}%
	{ < BA_USED : bit (1) >
		< DTX_USED : bit (1) >
		< RXLEV_FULL_SERVING_CELL : bit (6) >
		< 3G_BA_USED : bit (1) >
		< MEAS_VALID : bit (1) >
		< RXLEV_SUB_SERVING_CELL : bit (6) >
		< SI23_BA_USED : bit (1) >
		< RXQUAL_FULL_SERVING_CELL : bit (3) >
		< RXQUAL_SUB_SERVING_CELL : bit (3) >
		{
			{
				< NO_NCELL_M : { bit (3) = 111 } >
				0**			-- Padding with zeroes
			} |
			{
				< NO_NCELL_M : { bit (3) - 111 } >
				{ < NCELL Report : < NCELL Report struct >> } * val (NO_NCELL_M)
				{ null | 0			-- Padding with zeroes
					| 1 < UTRAN_CSG_Measurement_Report : < UTRAN_CSG_Measurement_Report IE > >
				}
				{ null 
					| 0* ENCODE_EXPR: %{16*8-(CURPOS-TAGZ(2))}% DECODE_INFINITE
				}	-- Padding with zeroes
			}
		}
	}
	RESTORE_SIZE (81);

	< NCELL Report struct > ::=
		< RXLEV-NCELL: bit (6) >
		< BCCH-FREQ-NCELL : bit (5) >
		< BSIC-NCELL : bit (6) > ;
}

#BEGIN TS44.018,10.5.2.20a
#------------------------------------
# TS 44.018, 10.5.2.20a
#------------------------------------
bit-field GPRSMeasurementResult {
	size: 2 octets;
	bits 11-16: C_VALUE integer;
	bits 8-10: RXQUAL integer;
	bit 7: spare void default=0;
	bits 1-6: SIGN_VAR integer;
}
#NAME MobileAllocation
#BEGIN TS44.018,10.5.2.21
#------------------------------------
# TS 44.018, 10.5.2.21
#------------------------------------
dcl-type MobileAllocation {
	size 1 octet ... 8 octets;
	type sequence [64] boolean;

  encode %{
  	int i;

		/* Push the values */
		for (i=0; i<Source->items; i++) {
			PUSH_INT (Source->data [Source->items-i-1], 1);
		}
		return Source->items;
  }%

  decode %{
  	int i;

		/* Now we know exactly how many items to expect */
  	SETITEMS_c_MobileAllocation (Destin, Length);

  	/* Now we know whether digit 1 is valid or not */
		for (i=0; i < Length; i++) {
			Destin->data [Length-i-1] = (unsigned char)SHIFT_INT (1);
		}
		return Length;
  }%
}

#BEGIN TS44.018,10.5.2.21a
#------------------------------------
# TS 44.018, 10.5.2.21a
#------------------------------------
bit-field MobileTimeDiff {
	size: 3 octets;
	bits 4-24: MobileTimeDiff integer;
	bits 1-3: spare void default=0;
}

#BEGIN TS44.018,10.5.2.21ab
#------------------------------------
# TS 44.018, 10.5.2.21ab
#------------------------------------
bit-field MobileTimeDiffHyperframe {
	size: 5 octets;
	bit 8-40: MobileTimeDifferenceOnHyperframeLevelValue binary;
	bits 1-7: spare void default=0;
}


#BEGIN TS44.018,10.5.2.21aa
#------------------------------------
# TS 44.018, 10.5.2.21aa
#------------------------------------
csn.1 {
	<MultirateSpeechCfgIE> ::=
		<MR version {octet enum {
			b001 = "Adaptive Multirate speech version 1"
			b010 = "Adaptive Multirate speech version 2"
		}}: bit (3)>
		<NSCB {octet enum {
				b0 = "Noise Suppression can be used (default)"
				b1 = "Noise Suppression shall be turned off"
			}}: bit
		>
		<ICMI {octet enum {
				b0 = "The initial codec mode is defined by the implicit rule provided in 3GPP TS 05.09"
				b1 = "The initial codec mode is defined by the Start Mode field"
			}}: bit
		>
		<bit>
		<Start mode: bit (2)>
		<Set of AMR codec modes: bit (8)>
		{
			{
				<bit (2)>
				{
					<codec:
					{
						<Threshold: bit (6)>
						<Hysteresis: bit (4)>
					}
				>**
				}
				<zero padding>
			}
			| null
		}
		;
}

#BEGIN TS44.018,10.5.2.21c
#------------------------------------
# TS 44.018, 10.5.2.21c
#------------------------------------
bit-field NCMode {
	size: 4 bits;
	bit  3-4: spare void default=0;
	bits 1-2: NCMode integer;
}

#BEGIN TS44.018,10.5.2.22
#------------------------------------
# TS 44.018, 10.5.2.22
#------------------------------------
dcl-type NeighbourCellDescription {
  size 16 octets
  type struct {
    CellDescription: CellChannel;
    ExtInd: boolean enum {
			0 = "The information element carries the complete BA"
			1 = "The information element carries only a part of the BA"
    };
    BAInd: boolean;
  }

  encode %{
    int ret = ENCODE_c_CellChannel (Buffer, BitOffset, PTR_c_NeighbourCellDescription_CellDescription (THIS->CellDescription));
    EDIntToBits (Buffer, BitOffset+2, (THIS->ExtInd? 1 : 0), 1);
    EDIntToBits (Buffer, BitOffset+3, (THIS->BAInd? 1 : 0), 1);
    return ret;
  }%

  decode %{
    int ret = DECODE_c_CellChannel (Buffer, BitOffset, PTR_c_NeighbourCellDescription_CellDescription (THIS->CellDescription), Length);
    THIS->ExtInd = (EDBitsToInt (Buffer, BitOffset+2, 1) ? ED_TRUE : ED_FALSE);
    THIS->BAInd = (EDBitsToInt (Buffer, BitOffset+3, 1) ? ED_TRUE : ED_FALSE);
    return ret;
  }%
}

#BEGIN TS44.018,10.5.2.22a
#------------------------------------
# TS 44.018, 10.5.2.22a
#------------------------------------
dcl-type NeighbourCellDescription2 {
  size 16 octets
  type struct {
    CellDescription: CellChannel;
    MultibandReporting: octet enum {
      b00 = "Report of the six strongest cells"
      b01 = "Report of the strongest cell"
      b10 = "Report of the two strongest cells"
      b11 = "Report of the three strongest cells"
    };
    BAInd: boolean;
  }

  encode %{
    int ret = ENCODE_c_CellChannel (Buffer, BitOffset, PTR_c_NeighbourCellDescription_CellDescription (THIS->CellDescription));
    EDIntToBits (Buffer, BitOffset+1, THIS->MultibandReporting, 2);
    EDIntToBits (Buffer, BitOffset+3, (THIS->BAInd? 1 : 0), 1);
    return ret;
  }%

  decode %{
    int ret = DECODE_c_CellChannel (Buffer, BitOffset, PTR_c_NeighbourCellDescription_CellDescription (THIS->CellDescription), Length);
    THIS->MultibandReporting = (unsigned char)EDBitsToInt (Buffer, BitOffset+1, 2);
    THIS->BAInd = (EDBitsToInt (Buffer, BitOffset+3, 1) ? ED_TRUE : ED_FALSE);
    return ret;
  }%
}

#NAME NTNRestOctets
#BEGIN TS44.018,10.5.2.22c
#------------------------------------
# TS 44.018, 10.5.2.22c
#------------------------------------
csn.1 {
	<NTNRestOctets> ::=
		{0 | 1 <NLN PCH : bit (2)>}
		<list of Group Call NCH information>
		{ 	null		| L										-- Receiver compatible with earlier release
			| H 										-- Additions in Release 6:
				{ 0 | 1	< CELL_GLOBAL_COUNT: bit (2) >}
				< List of Reduced GCR >
				< List of VSTK_RAND information >
		}
		{ 	null		| L -- Receiver compatible with earlier release
			 | H 										-- Additions in Release 7:
				< List of Emergency information >
				{ 0 | 1 < Priority Uplink access {boolean enum {
			b0 = "RACH Access"
			b1 = "Group Channel"
		}}: bit(1)> }
				{ 0 | 1	{ 0|1	<FR AMR Config:bit(4)> }
						{ 0|1	<HR AMR Config:bit(4)> }
				}
				{ 0 | 1	< SMS Data Confidentiality Ind : bit(1)>
						< SMS Guaranteed Privacy Ind : bit(1)>
				}
		}
		<Spare padding>;

	slave <List of Group Call NCH information> ::=
		0 | 1 <Group Call information> <List of Group Call NCH information> ;

	slave < List of Emergency information > ::=
		{ 0 | 1 < Emergency_Ind > < List of Emergency information > } ;

	slave < List of VSTK_RAND information > ::=
		{ 1	< Segment Id: bit >
		 {0 | 1	< VSTK_RAND: bit (36) >}
	 } **0;

	slave < List of Reduced GCR > ::=
		{ 1< Reduced GCR: bit (28) >} **0;

}
#NAME P1RestOctets
#BEGIN TS44.018,10.5.2.23
#------------------------------------
# TS 44.018, 10.5.2.23
#------------------------------------
csn.1 {
	<P1RestOctets> ::=
		{
		{L | H <NLN PCH : bit (2)> <NLN status : bit>}
		{L | H <Priority1 {octet enum {
			b000 = "no priority applied"
			b001 = "call priority level 4"
			b010 = "call priority level 3"
			b011 = "call priority level 2"
			b100 = "call priority level 1"
			b101 = "call priority level 0"
			b110 = "call priority level B"
			b111 = "call priority level A"
		}}: Priority>}
		{L | H <Priority2 {octet enum {
			b000 = "no priority applied"
			b001 = "call priority level 4"
			b010 = "call priority level 3"
			b011 = "call priority level 2"
			b100 = "call priority level 1"
			b101 = "call priority level 0"
			b110 = "call priority level B"
			b111 = "call priority level A"
		}}: Priority>}
		{L | H <Group Call information>}
		< Packet Page Indication 1 : {L | H} >
		< Packet Page Indication 2 : {L | H} >
		{	null	 | L 				-- Receiver compatible with earlier release
			| H	 					-- Additions in Release 6 :
				{ 0 | 1
					{	00		< CELL_GLOBAL_COUNT:bit(2) >
						| 01	< CELL_GLOBAL_COUNT:bit(2) >
								< VSTK_RAND : bit (36) >
						| 10	< Reduced_GCR : bit (28) >
								< VSTK_RAND : bit (36) >
						| 11	< CELL_GLOBAL_COUNT:bit(2) >
								< Reduced_GCR : bit (28) >
								< VSTK_RAND : bit (36) >
					}
				}
				{ 0 | 1		-- MBMS parameters included
					{	0		-- MBMS pre-notification
						| 1		-- MBMS notification
							<MBMS Notification 1 : < MBMS Channel Parameters IE > >}
					{	0		-- MBMS pre-notification
						| 1		-- MBMS notification
							<MBMS Notification 2 : { 0 | 1	< MBMS Channel Parameters IE > } > }
									-- 0indicates that the same MBMS Channel Parameters as for MBMS Notification 1 apply
					{ 0 | 1 <MBMS Information> }
				}
		}
		{	null 	| L 				-- Receiver compatible with earlier release
			| H			 			-- Additions in Release 7 :
				{ 0 | 1 <AMR Config:bit(4)> }
		}
		{	null		| L				-- Receiver compatible with earlier release
			| H						-- Additions in Release 8
				< Priority Uplink Access : bit >
				{ 0 | 1 < ETWS Primary Notification : < ETWS Primary Notification struct > > }
				{	null		| L				-- Receiver compatible with earlier release
					| H						-- Additions in Release 10
						< Implicit Reject CS : bit >
						< Implicit Reject PS : bit >
				}
		}
		{	null		| L				-- Receiver compatible with earlier release
			| H						-- Additions in Release 11
				< IPA Support : bit >
		} 
		<spare padding>} //;

	slave <Priority> ::= <bit>* (3);

	slave <MBMS Information> ::=
		-- Pre-notifications
		< MBMS Sessions List : < MBMS Sessions List IE > >

								-- Notifications: listed per MBMS Channel Parameters
								-- 1) Notifications with same MBMS Channel Parameters as in Notification 1 or Notification 2
		{	0 					-- None
			| 1	{ 0 | 1 } 		-- 0: same MBMS Channel Parameters as Notification 1.
								-- 1: same MBMS Channel Parameters as Notification 2
					< MBMS Sessions List : < MBMS Sessions List IE > >
		}
								-- 2) Notifications with specific MBMS Channels Parameters
		{ 1	< MBMS Channel Parameters : < MBMS Channel Parameters IE > >
			< MBMS Sessions List : < MBMS Sessions List IE > >
		} ** 0 ;

	slave < ETWS Primary Notification struct> ::=
		{0 		-- First segment of ETWS Primary Notification, number of segments included
			< Total No Of Segments For ETWS Primary Notification : bit (4) >
		| 1		-- Not first segment, segment number included
			< Segment Number : bit (4) >
		}
		< PNI: bit (1) >		-- identifier for segments belonging to one and the same ETWS Primary Notification message
		< Length Of Segment : bit (7) >	-- length of segment in bits
		< ETWS Primary Notification Data : bit (val(Length Of Segment)) >;

	}
#NAME P2RestOctets
#BEGIN TS44.018,10.5.2.24
#------------------------------------
# TS 44.018, 10.5.2.24
#------------------------------------
csn.1 {
	<P2RestOctets> ::=
		{L | H <CN3: bit (2)>}
		{L | H <NLN : bit (2)> <NLN status : bit>}
		{L | H <Priority1: Priority>}
		{L | H <Priority2: Priority>}
		{L | H <Priority3: Priority>}
		< Packet Page Indication 3 : {L | H} >
		{ null	| L				-- Receiver compatible with earlier release
				| H	 			-- Additions in Release 6 :
					{ 0	| 1	-- MBMS parameters included
						{	0		-- MBMS pre-notification
							| 1		-- MBMS notification
								<MBMS Notification 3 : < MBMS Channel Parameters IE > > }
						{ 0 | 1 < MBMS Information P2 > }
					}
		}
		{ null	| L				-- Receiver compatible with earlier release
				| H				-- Additions in Release 10
					< Implicit Reject CS : bit >
					< Implicit Reject PS : bit >
		}
		{	null		| L				-- Receiver compatible with earlier release
			| H						-- Additions in Release 11
				< IPA Support : bit >
		} 
		<spare padding>;

	slave <MBMS Information P2> ::=
		-- Pre-notifications
		< MBMS Sessions List : < MBMS Sessions List IE > >

		-- Notifications: listed per MBMS Channel Parameters
		-- 1) Notifications with same MBMS Channel Parameters as in Notification 3
		{	0	-- None
			| 1	-- Same MBMS Channel Parameters as Notification 3
				< MBMS Sessions List : < MBMS Sessions List IE > > }
		-- 2) Notifications with specific MBMS Channels Parameters
		{ 	1	< MBMS Channel Parameters : < MBMS Channel Parameters IE > >
				< MBMS Sessions List : < MBMS Sessions List IE > > } ** 0 ;

}
#NAME P3RestOctets
#BEGIN TS44.018,10.5.2.25
#------------------------------------
# TS 44.018, 10.5.2.25
#------------------------------------
csn.1 {
	<P3RestOctets> ::=
     ENCODECO: %{PUSH_TAG (1, CURPOS);}%
     {L | H <CN3 : bit (2)> <CN4 : bit (2)>}
     {L | H <NLN : bit (2)> <NLN status : bit>}
     {L | H <Priority1 : Priority>}
     {L | H <Priority2 : Priority>}
     {L | H <Priority3 : Priority>}
     {L | H <Priority4 : Priority>}
		{ null	| L				-- Receiver compatible with earlier release
				| H				-- Additions in Release 10
					< Implicit Reject CS : bit >
					< Implicit Reject PS : bit >
		}
		{	null		| L				-- Receiver compatible with earlier release
			| H						-- Additions in Release 11
				< IPA Support : bit >
		} 
     L * ENCODECO_EXPR: %{CURPOS-TAG(1) <= 24 ? (24 - (CURPOS - TAG(1))) : 0}%
     null ENCODECO: %{
     	/* Truncate to 24 bit when too long */
     	if (CURPOS-TAG(1) > 24) CURPOS = TAG(1)+24;
     }%;
}
#NAME PacketChannelDescription
#BEGIN TS44.018,10.5.2.25a
#------------------------------------
# TS 44.018, 10.5.2.25a
#------------------------------------
csn.1 {
	< PacketChannelDescription > ::=
		< Channel type : bit (5) >
		< TN : bit (3) >
		< TSC : bit (3) >
		{
			0
			{
				0 < spare bit >
				< ARFCN : bit (10) >						-- non-hopping RF channel configuraion
				|
				1
				< spare bit >
				< MAIO : bit (6) >							-- indirect encoding of hopping RF channel configuration
				< MA_NUMBER_IND {boolean enum {
			b0 = "MA_NUMBER = 14"
			b1 = "MA_NUMBER = 15"
		}}: bit >
				{
					0	< spare bits : bit (2) >
					|
					1	< CHANGE_MARK_1 : bit (2) >
				}
			}
			|
			1
			< MAIO : bit (6) >	-- direct encoding of hopping RF channel configuration
			< HSN : bit (6) >
		};
}
#BEGIN TS44.018,10.5.2.25b
#------------------------------------
# TS 44.018, 10.5.2.25b
#------------------------------------
bit-field DedicatedModeOrTBF {
	size: 8 bits;
	bit 1: TD boolean;
	bit 2: Downlink boolean;
	bit 3: TMA boolean;
	bit 4-7: spare void default = 0;
	bit 8: DedicatedMode boolean;
}
#BEGIN TS44.018,10.5.2.25ba
#------------------------------------
# TS 44.018, 10.5.2.25ba
# 4 bit form
#------------------------------------
bit-field DedicatedModeOrTBF4b {
	size: 4 bits;
	bit 1: TD boolean;
	bit 2: Downlink boolean;
	bit 3: TMA boolean;
}
#NAME RRPacketUplinkAssignment
#BEGIN TS44.018,10.5.2.25c
#------------------------------------
# TS 44.018, 10.5.2.25c
#------------------------------------
csn.1 {
	< RRPacketUplinkAssignment > ::=
		< CHANNEL_CODING_COMMAND : bit (2) >
		< TLLI_BLOCK_CHANNEL_CODING : bit (1) >
		< Packet Timing Advance : Packet Timing Advance IE >
		{ 01 < Dynamic Allocation : Dynamic Allocation struct >
		| 10 < Single Block Allocation : Single Block Allocation struct > -- Retained from older releases
		| 11 < Fixed Allocation : Fixed Allocation struct > -- Retained from older releases
		| 00 { 	0 	< Multiple TBF Allocation : Multiple TBF Allocation struct >
					| 1 < Extension2 > }
		{ null									-- Receiver compatible with earlier release
		|										-- Additions for R99
			{
				0 | 1	< EGPRS_MCS_MODE : bit (4) >
				< RESEGMENT : bit (1) >
				< EGPRS Window Size : < EGPRS Window Size IE >>
			}
			{ 0 | 1	< Packet Extended Timing Advance : bit (2) > }
			{
				null
				| 0 {bit** = < no string >} 			-- Receiver compatible with earlier release
				| 1 											-- Additions for Rel-7
					{ 0 | 1	< RLC_MODE : bit (1) > }	-- This field may be present in case of single TBF allocation
					{ 1 { 0 | 1< NPM Transfer Time : bit (5) > } }** 0
					< Uplink EGPRS Level: < EGPRS Level IE > >
					{ 0 | 1 < Pulse Format: < Pulse Format IE > > }
					{
						  0   -- '0' indicates that FANR is not activated
				 		| 1 	-- '1' indicates that FANR is  activated
							{ 0 		-- SSN-based encoding is selected
							| 1 		-- Time-based encoding is selected
								< REPORTED TIMESLOTS : bit (8) >
								< TSH : bit (2) >
							}
					}
					{ null
						| 0 {bit** = < no string >} -- Receiver backward compatible with earlier version
						| 1 								-- Additions for REL-8
							{ 0 | 1	{ 1 < Measurement_Control_E-UTRAN : bit(1) >
										< E-UTRAN_FREQUENCY_INDEX : bit (3) >
										{ 1 < E-UTRAN_FREQUENCY_INDEX : bit (3) > } ** 0
									} ** 0
							}
							{ 0 | 1
								{
									1 < Measurement_Control_UTRAN : bit(1) >
									< UTRAN_FREQUENCY_INDEX : bit (5) >
									{ 1 < UTRAN_FREQUENCY_INDEX : bit (5) > } ** 0
								} ** 0
							}
					}
				{ null | 0 bit** = < no string >		-- Receiver backward compatible with earlier version
				| 1									-- Additions for Rel-9
					{ 0 < EMST_NW_Capability : bit (1) >		-- EMST is not used
					| 1 												-- EMST is used
						< RLC Entity 2 : <RLC Entity Struct UP> >
						{ 0
						| 1 < RLC Entity 3 : <RLC Entity Struct UP> > }
					}
						{ null | 0 bit** = < no string > -- Receiver backward compatible with earlier version
						| 1 								-- Additions for Rel-10
							{ 1 < EMSR Additional PFCs 1 : < Additional PFCs struct UP > > } ** 0
							{ 1 < EMSR Additional PFCs 2 : < Additional PFCs struct UP > > } ** 0
							{ 1 < EMSR Additional PFCs 3 : < Additional PFCs struct UP > > } ** 0
							<spare bit>**
						}	-- End of additions for Rel-10
					}	-- End of additions for Rel-9
				} 	-- End of additions for Rel-8
			}	-- End of additions for Rel-7
		} ;	-- End of additions for R99

	< Extension2 > ::=							-- Future extension can be done by modifying this structure
			null ;

	<Dynamic Allocation struct > ::=
			< Extended Dynamic Allocation : bit(1)>
			{0 | 1 < P0 : bit (4) >
				< PR_MODE : bit (1) > }
			< USF_GRANULARITY {boolean enum {
			b0 = "the mobile station shall transmit one RLC/MAC block;"
			b1 = "the mobile station shall transmit four consecutive RLC/MAC blocks."
		}}: bit (1) >
			{ 0 | 1 < UPLINK_TFI_ASSIGNMENT : bit (5) > }
			{ 0 | 1 < RLC_DATA_BLOCKS_GRANTED : bit (8) > }
				{ 0 								-- Timeslot Allocation
					{ 0 | 1 < USF_TN0 : bit (3) > }
					{ 0 | 1 < USF_TN1 : bit (3) > }
					{ 0 | 1 < USF_TN2 : bit (3) > }
					{ 0 | 1 < USF_TN3 : bit (3) > }
					{ 0 | 1 < USF_TN4 : bit (3) > }
					{ 0 | 1 < USF_TN5 : bit (3) > }
					{ 0 | 1 < USF_TN6 : bit (3) > }
					{ 0 | 1 < USF_TN7 : bit (3) > }
				| 1 							-- Timeslot Allocation with Power Control Parameters
					< ALPHA : bit (4) >
					{ 0 | 1 < USF_TN0 : bit (3) >
						< GAMMA_TN0 : bit (5) > }
					{ 0 | 1 < USF_TN1 : bit (3) >
						< GAMMA_TN1 : bit (5) > }
					{0 | 1 < USF_TN2 : bit (3) >
						< GAMMA_TN2 : bit (5) > }
					{ 0 | 1 < USF_TN3 : bit (3) >
						< GAMMA_TN3 : bit (5) > }
					{ 0 | 1 < USF_TN4 : bit (3) >
						< GAMMA_TN4 : bit (5) > }
					{ 0 | 1 < USF_TN5 : bit (3) >
						< GAMMA_TN5 : bit (5) > }
					{ 0 | 1 < USF_TN6 : bit (3) >
						< GAMMA_TN6 : bit (5) > }
					{ 0 | 1 < USF_TN7 : bit (3) >
						< GAMMA_TN7 : bit (5) > }
				};
	<Fixed Allocation struct > ::=
			{ 0 | 1 < UPLINK_TFI_ASSIGNMENT : bit (5) > }
			< FINAL_ALLOCATION : bit (1) >
			< DOWNLINK_CONTROL_TIMESLOT: bit(3) >
			{ 0 | 1 < P0 : bit (4) >
				< BTS_PWR_CTRL_MODE : bit (1) >
				< PR_MODE : bit (1) > }
			{ 0 < TIMESLOT_ALLOCATION : bit (8) >
			| 1 < Power Control Parameters : Power Control Parameters IE > }
			< HALF_DUPLEX_MODE : bit (1) >
			{ 0 { 0		-- with length of allocation bitmap
				< BLOCKS_OR_BLOCK_PERIODS : bit (1) >
				< ALLOCATION_BITMAP_LENGTH : bit (7) >
				< ALLOCATION_BITMAP : bit (val(ALLOCATION_BITMAP_LENGTH)) >
				| 1		-- without length of Allocation Bitmap (fills remainder of this IE)
					< ALLOCATION_BITMAP : bit ** > }
				! < Message escape : 1 bit (*) = null > } ;

	slave < Multiple TBF Allocation struct > ::=
		< EXTENDED_DYNAMIC_ALLOCATION : bit (1) >
		{ 0 | 1	< P0 : bit (4) >
				< PR_MODE : bit(1) > }
		{ 0 | 1	< Timeslot description : < Timeslot description struct > >
				{ 1	< Uplink TBF Assignment : < Uplink TBF Assignment struct > > } ** 0 } ;

	slave < Timeslot description struct > ::=
		{ 0														-- without power control params
			{ 0 | 1	< USF_GRANULARITY : bit(1) > }		-- 0 means TS not assigned
			{ 0 | 1	< USF_GRANULARITY : bit(1) > }
			{ 0 | 1	< USF_GRANULARITY : bit(1) > }
			{ 0 | 1	< USF_GRANULARITY : bit(1) > }
			{ 0 | 1	< USF_GRANULARITY : bit(1) > }
			{ 0 | 1	< USF_GRANULARITY : bit(1) > }
			{ 0 | 1	< USF_GRANULARITY : bit(1) > }
			{ 0 | 1	< USF_GRANULARITY : bit(1) > }
		| 1													--	with power control params
			< ALPHA : bit (4) >
			{ 0 | 1	< USF_GRANULARITY : bit(1) >	< GAMMA_TN0 : bit (5) > }
			{ 0 | 1	< USF_GRANULARITY : bit(1) >	< GAMMA_TN1 : bit (5) > }
			{ 0 | 1	< USF_GRANULARITY : bit(1) >	< GAMMA_TN2 : bit (5) > }
			{ 0 | 1	< USF_GRANULARITY : bit(1) >	< GAMMA_TN3 : bit (5) > }
			{ 0 | 1	< USF_GRANULARITY : bit(1) >	< GAMMA_TN4 : bit (5) > }
			{ 0 | 1	< USF_GRANULARITY : bit(1) >	< GAMMA_TN5 : bit (5) > }
			{ 0 | 1	< USF_GRANULARITY : bit(1) >	< GAMMA_TN6 : bit (5) > }
			{ 0 | 1	< USF_GRANULARITY : bit(1) >	< GAMMA_TN7 : bit (5) > } } ;

	slave < Uplink TBF Assignment struct > ::=					-- Recursive for multiple TBFs
		< PFI : bit (7) >
		< RLC_MODE : bit (1) >
		< UPLINK_TFI_ASSIGNMENT: bit (5) >
		{ 0 | 1	< CHANNEL_CODING_COMMAND : bit (2) > }
		{ 0 | 1	< EGPRS Channel Coding Command : < EGPRS Modulation and Coding Scheme IE > > }
		{ 0 | 1	< EGPRS Window Size : < EGPRS Window Size IE > > }
		{	0		< USF_ALLOCATION : bit (3) >
			| 1		{ 1 < USF Assignment: < USF Assignment struct > > } ** 0 } ;

	slave < USF Assignment struct > ::=									-- Recursive for multiple USFs (per TBF)
		{ 0 | 1	< USF_ALLOCATION: bit (3) > } ;					-- 0 indicates no valid USF for this TS

	slave < RLC Entity Struct UP > ::=
		< UPLINK_TFI_ASSIGNMENT : bit (5) >
		< RLC_MODE : bit (1) >
		{ 0 | 1 < EGPRS Window Size : < EGPRS Window Size IE > > }
		< PFI : bit (7) >;

	slave < Additional PFCs struct UP > ::=
		< UPLINK_TFI_ASSIGNMENT : bit (5) >
		{ 0 | 1 < NPM Transfer Time : bit (5) > }
		< PFI : bit (7) >;

}

#NAME RRPktDownlinkAssi
#BEGIN TS44.018,10.5.2.25d
#------------------------------------
# TS 44.018, 10.5.2.25d
#------------------------------------
csn.1 {
	< RRPktDownlinkAssi> ::=
		< MAC_MODE : bit (2) >
		< RLC_MODE : bit (1) >
		< TIMESLOT_ALLOCATION : bit (8) >
		< Packet Timing Advance : Packet Timing Advance IE >
		{ 0 | 1	< P0 : bit (4) >
				< BTS_PWR_CTRL_MODE : bit(1) >
				< PR_MODE : bit (1) > }
		{ 0 | 1	< Power Control Parameters : Power Control Parameters IE > }
		{ 0 | 1	< DOWNLINK_TFI_ASSIGNMENT : bit (5) > }
		{ 0 | 1	< MEASUREMENT_STARTING_TIME : bit (16) >
				< MEASUREMENT_INTERVAL : bit (5) >
				< MEASUREMENT_BITMAP : bit (8) > }
		{ null									-- Receiver compatible with earlier release
		|
			{ 0 | 1-- indicates EGPRS TBF mode, see 3GPP TS 44.060
					< EGPRS Window Size : < EGPRS Window Size IE >>
					< LINK_QUALITY_MEASUREMENT_MODE : bit (2) > }
			{ 0 | 1 	< Packet Extended Ttiming Advance : bit (2)> }
			{	null | 0 {bit** = < no string >} -- Receiver backward compatible
				| 1 		-- Additions for REL-6
					{ 1	< Multiple Downlink TBF Assignment : < Multiple Downlink TBF Assignment struct > > } ** 0
					{
						null
						| 0 bit** -- Receiver backward compatible with earlier release
						| 1 			-- Additions for REL-7
							< FANR: bit (1) >
							{ 1
								{ 0 | 1< NPM Transfer Time : bit (5) > }
								< EVENT_BASED_FANR: bit (1) >
							} ** 0
					}
			 }
				< Downlink EGPRS Level: < EGPRS Level IE > >
				{ null | 0 {bit** = < no string >} -- Receiver backward compatible with earlier version
				| 1 								-- Additions for REL-8
					{ 0 | 1	{ 1 < Measurement_Control_E-UTRAN : bit(1) >
								< E-UTRAN_FREQUENCY_INDEX : bit (3) >
								{ 1 < E-UTRAN_FREQUENCY_INDEX : bit (3) > } ** 0
							} ** 0
					}
					{ 0 | 1	{ 1<  Measurement_Control_UTRAN : bit(1) >
								< UTRAN_FREQUENCY_INDEX : bit (5) >
								{ 1 < UTRAN_FREQUENCY_INDEX : bit (5) > } ** 0
							} ** 0
						}
					{ null | 0 bit** = < no string >	-- Receiver backward compatible with earlier version
					| 1								-- Additions for Rel-9
						{ 0 		-- EMST is not used
						| 1	< RLC Entity 2 : < RLC Entity Struct DN > >
							{ 0
							| 1	< RLC Entity 3 : < RLC Entity Struct DN > > }
						}
						{ null | 0 bit** = < no string > -- Receiver backward compatible with earlier version
						| 1 								-- Additions for Rel-10
							{ 1 < EMSR Additional PFCs 1 : < Additional PFCs struct DN > > } ** 0
							{ 1 < EMSR Additional PFCs 2 : < Additional PFCs struct DN > > } ** 0
							{ 1 < EMSR Additional PFCs 3 : < Additional PFCs struct DN > > } ** 0
					<spare bit>**
						}	-- End of additions for Rel-10
					}	-- End of additions for Rel-9
				}	-- End of additions for Rel-8
	};

	slave < Multiple Downlink TBF Assignment struct> ::=
		{ 0 | 1 < Uplink Control Timeslot : bit (3) > }
		< TIMESLOT_ALLOCATION : bit (8) >
		{ 1 < Downlink TBF assignment : < Downlink TBF assignment struct > > } ** 0
		;

	slave < Downlink TBF assignment struct > ::=
		< PFI : bit (7) >
		< RLC_MODE : bit (1) >
		< DOWNLINK_TFI_ASSIGNMENT : bit (5) >
		< CONTROL_ACK : bit (1) >
		{ 0 | 1 < EGPRS Window Size : < EGPRS Window Size IE >> } ;

	slave < RLC Entity Struct DN > ::=
		< DOWNLINK_TFI_ASSIGNMENT : bit (5) >
		< RLC_MODE : bit (1) >
		{ 0 | 1 < EGPRS Window Size : < EGPRS Window Size IE > > }
		< PFI : bit (7) >;

	slave < Additional PFCs struct DN > ::=
		< DOWNLINK_TFI_ASSIGNMENT : bit (5) >
	      { 0 | 1 < NPM Transfer Time : bit (5) > }
		< PFI : bit (7) >;

}

#BEGIN TS44.018,10.5.2.25e
#------------------------------------
# TS 44.018, 10.5.2.25e
#------------------------------------
csn.1 {
	< RRPacketDownlinkAssignmentType2 > ::=
		< RLC_MODE : bit (1) >
		{ 0 | 1	< P0_C1 : bit (4) >
				< PR_MODE_C1 : bit (1) >
				{ 0 | 1	< P0_C2 : bit (4) >
				< PR_MODE_C2 : bit (1) > } }
		{ 0 | 1 < Power Control Parameters C1 : < Power Control Parameters IE > > }
		{ 0 | 1 < Power Control Parameters C2 : < Power Control Parameters IE > > }
		{ 0 | 1 < DOWNLINK_TFI_ASSIGNMENT : bit (5) > }
		< EGPRS Window Size : < EGPRS Window Size IE >>
		< LINK_QUALITY_MEASUREMENT_MODE : bit (2) >
		{ 0				-- BTTI mode
			< FANR: bit (1) >
			{ 1	< BTTI Multiple Downlink TBF Assignment : < BTTI Multiple Downlink TBF Assignment struct > > } ** 0
		| 1				-- RTTI mode
			{ 0					-- Single Carrier Assignment
			{ 00				-- Default PDCH-pair configuration
			| 01				-- Unchanged
			| 10				-- Explicit PDCH pair configuration
				< DOWNLINK_PDCH_PAIRS_C1 : bit (8) >
				< UPLINK_PDCH_PAIRS_C1 : bit (8) >
			! < PDCH pairs configuration error :  1 1 > {bit (*) = < no string >}  		-- reserved
			}
			{ 1	< RTTI Multiple Downlink Assignment SC :
				< RTTI Multiple Downlink Assignment SC struct > > } ** 0
		| 1					-- Dual  Carrier Assignment
			{ 00				-- Default PDCH pair configuration
			| 01				-- Unchanged
			| 10				-- Explicit PDCH pair configuration
				< DOWNLINK_PDCH_PAIRS_C1 : bit (8) >
				< DOWNLINK_PDCH_PAIRS_C2 : bit (8) >
				< UPLINK_PDCH_PAIRS_C1 : bit (8) >
				< UPLINK_PDCH_PAIRS_C2 : bit (8) >
			! < PDCH pairs configuration error :  1 1 > {bit (*) = < no string >}  		-- reserved
			}
			{ 1	< RTTI Multiple Downlink Assignment DC :
				< RTTI Multiple Downlink Assignment DC struct > > } ** 0
		}
	}
	< Downlink EGPRS Level: < EGPRS Level IE > >
	{ null | 0 bit** = < no string >	-- Receiver backward compatible with earlier version
	| 1 								-- Additions for REL-8
		{ 0 | 1	{ 1 < Measurement_Control_E-UTRAN : bit(1) >
					< E-UTRAN_FREQUENCY_INDEX : bit (3) >
					{ 1 < E-UTRAN_FREQUENCY_INDEX : bit (3) > } ** 0
				} ** 0
		}
		{ 0 | 1	{ 1<  Measurement_Control_UTRAN : bit(1) >
					< UTRAN_FREQUENCY_INDEX : bit (5) >
					{ 1 < UTRAN_FREQUENCY_INDEX : bit (5) > } ** 0
				} ** 0
		}
		{ null | 0 bit** = < no string >		-- Receiver backward compatible with earlier release
		| 1									-- Additions for Rel-99
			{ 0		-- EMST is not used
			| 1	< RLC Entity 2 : < RLC Entity Struct DN > >
				{ 0
				| 1	< RLC Entity 3 : < RLC Entity Struct DN > > }
			}
			{ null | 0 bit** = < no string > -- Receiver backward compatible with earlier version
			| 1 								-- Additions for Rel-10
				{ 1 < EMSR Additional PFCs 1 : < Additional PFCs struct DN > > } ** 0
				{ 1 < EMSR Additional PFCs 2 : < Additional PFCs struct DN > > } ** 0
				{ 1 < EMSR Additional PFCs 3 : < Additional PFCs struct DN > > } ** 0
				{ null | 0 bit** = < no string > -- Receiver backward compatible with earlier version
				| 1 								-- Additions for Rel-11
					< EGPRS Packet Downlink Ack/Nack Type 3 Support : bit(1) >
				<spare bit>**
				}	-- End of additions for Rel-11
			}	-- End of additions for Rel-10
		}	-- End of additions for Rel-9
	} ;	-- End of additions for Rel-8

	slave < BTTI Multiple Downlink TBF Assignment struct > ::=
		{ 0 | 1 < Uplink Control Timeslot: bit (3) > }
		{ 0 | 1 < TIMESLOT_ALLOCATION_C1 : bit (8) > }
		{ 0 | 1 < TIMESLOT_ALLOCATION_C2 : bit (8) > }
		{ 1 < Downlink TBF assignment : < Downlink TBF assignment 2 struct > > } ** 0 ;

	slave < RTTI Multiple Downlink Assignment SC struct > ::=
		< RTTI_DOWNLINK_PDCH_PAIR_ASSIGNMENT_SC : bit (4) >
		{ 1 < Downlink TBF assignment : < Downlink TBF assignment 2 struct > > } ** 0 ;

	slave < RTTI Multiple Downlink Assignment DC struct > ::=
		< RTTI_DOWNLINK_PDCH_PAIR_ASSIGNMENT_DC : bit (8) >
		{ 1 < Downlink TBF assignment : < Downlink TBF assignment 2 struct > > } ** 0 ;

	slave < Downlink TBF assignment 2 struct > ::=
		< PFI : bit (7) >
		< RLC_MODE : bit (1) >
		< TFI Assignment : bit (5) >
		< CONTROL_ACK : bit (1) >
		{ 0 | 1 < NPM Transfer Time : bit (5) > }
		< EVENT_BASED_FANR: bit (1) >
		{ 0 | 1 < Downlink EGPRS Window Size : < EGPRS Window Size IE > > } ;
}


#BEGIN TS44.018,10.5.2.26
#------------------------------------
# TS 44.018, 10.5.2.26
#------------------------------------
bit-field PageMode {
	size: 4 bits;
	bits 1-2: PM integer enum {
		b00 = "Normal paging"
		b01 = "Extended paging"
		b10 = "Paging reorganization"
		b11 = "Same as before"
	};
	bits 3-4: spare void default = 0;
}
#BEGIN TS44.018,10.5.2.28
#------------------------------------
# TS 44.018, 10.5.2.28
#------------------------------------
bit-field PowerCommand {
	size: 1 octet;
	bits 6-8: spare void default = 0;
	bits 1-5: PowerLevel integer;
}
#BEGIN TS44.018,10.5.2.28a
#------------------------------------
# TS 44.018, 10.5.2.28a
#------------------------------------
bit-field PowerCommandAndAccessType {
	size: 1 octet;
	bit 8: ATC boolean;
	bit 7: spare void default = 0;
	bit 6: FPC boolean;
	bits 1-5: PowerLevel integer;
}

#BEGIN TS44.018,10.5.2.29
#------------------------------------
# TS 44.018, 10.5.2.29
#------------------------------------
bit-field RACHCtrlParam {
  size: 3 octets;
  octet 1 {
    bits 7-8: MaxRetrans integer enum {
			b00 = "Maximum 1 retransmission"
			b01 = "Maximum 2 retransmissions"
			b10 = "Maximum 4 retransmissions"
			b11 = "Maximum 7 retransmissions"
    };
    bits 3-6: Tx integer enum {
			b0000 = "3 slots used to spread transmission"
			b0001 = "4 slots used to spread transmission"
			b0010 = "5 slots used to spread transmission"
			b0011 = "6 slots used to spread transmission"
			b0100 = "7 slots used to spread transmission"
			b0101 = "8 slots used to spread transmission"
			b0110 = "9 slots used to spread transmission"
			b0111 = "10 slots used to spread transmission"
			b1000 = "11 slots used to spread transmission"
			b1001 = "12 slots used to spread transmission"
			b1010 = "14 slots used to spread transmission"
			b1011 = "16 slots used to spread transmission"
			b1100 = "20 slots used to spread transmission"
			b1101 = "25 slots used to spread transmission"
			b1110 = "32 slots used to spread transmission"
			b1111 = "50 slots used to spread transmission"
    };
    bit 2: CellBarrAccess boolean enum {
			0	= "The cell is not barred, see 3GPP TS 23.022"
			1	= "The cell is barred, see 3GPP TS 23.022"
    };
    bit 1: RE boolean enum {
			0	= "Call Reestablishment allowed in the cell"
			1	= "Call Reestablishment not allowed in the cell"
    };
  };
  octet 3 {
    bit 16: AC_C15 boolean;
    bit 15: AC_C14 boolean;
    bit 14: AC_C13 boolean;
    bit 13: AC_C12 boolean;
    bit 12: AC_C11 boolean;
    bit 11: EC_C10 boolean enum {
			0	= "Emergency call allowed in the cell to all MSs"
			1	= "Emergency call not allowed in the cell except for the MSs that belong to one of the classes between 11 to 15"
    };
    bit 10: AC_C09 boolean;
    bit  9: AC_C08 boolean;
    bit  8: AC_C07 boolean;
    bit  7: AC_C06 boolean;
    bit  6: AC_C05 boolean;
    bit  5: AC_C04 boolean;
    bit  4: AC_C03 boolean;
    bit  3: AC_C02 boolean;
    bit  2: AC_C01 boolean;
    bit  1: AC_C00 boolean;
  };
}

#BEGIN TS44.018,10.5.2.30
#------------------------------------
# TS 44.018, 10.5.2.30
#------------------------------------
bit-field RequestReference {
	size: 3 octets;
	bits 17-24: RA integer;
	bits 12-16: T1 integer;
	bits  6-11: T3 integer;
	bits  1-5:  T2 integer;
}

#BEGIN TS44.018,10.5.2.30a
#------------------------------------
# TS 44.018, 10.5.2.30a
#------------------------------------
bit-field EstablishmentCauseRandomReference {
	size: 1 octet;
	bits 6-8: EstablishmentCause octet enum {
				b101 = "Privilege subscriber request"
				b111 = "Emergency subscriber request"
				b000 = "Reset emergency talker indication"
				default = "Reserved"
			};
	bits  1-5: RandomReference integer;
}

#BEGIN TS44.018,10.5.2.31
#------------------------------------
# TS 44.018, 10.5.2.31
#------------------------------------
bit-field RRCause {
	size: 1 octet;
	bits 1-8: Cause octet enum {
			b00000000 = "Normal event"
			b00000001 = "Abnormal release, unspecified"
			b00000010 = "Abnormal release, channel unacceptable"
			b00000011 = "Abnormal release, timer expired"
			b00000100 = "Abnormal release, no activity on the radio path"
			b00000101 = "Preemptive release"
			b00000110 = "UTRAN configuration unknown"
			b00001000 = "Handover impossible, timing advance out of range"
			b00001001 = "Channel mode unacceptable"
			b00001010 = "Frequency not implemented"
			b00001011 = "Originator or talker leaving group call area"
			b00001100 = "Lower layer failure"
			b01000001 = "Call already cleared"
			b01011111 = "Semantically incorrect message"
			b01100000 = "Invalid mandatory information"
			b01100001 = "Message type non-existent or not implemented"
			b01100010 = "Message type not compatible with protocol state"
			b01100100 = "Conditional IE error"
			b01100101 = "No cell allocation available"
			b01101111 = "Protocol error unspecified"
		};
}

#BEGIN TS44.018,10.5.2.32
#------------------------------------
# TS 44.018, 10.5.2.32
#------------------------------------
csn.1 {
  <SI1RestOctets> ::=  {
    L
    |
    H  <NCH Position {octet enum {
			b00000 = "No of blocks:1 Number of first block:0"
			b00001 = "No of blocks:1 Number of first block:1"
			b00010 = "No of blocks:1 Number of first block:2"
			b00011 = "No of blocks:1 Number of first block:3"
			b00100 = "No of blocks:1 Number of first block:4"
			b00101 = "No of blocks:1 Number of first block:5"
			b00110 = "No of blocks:1 Number of first block:6"
			b00111 = "No of blocks:2 Number of first block:0"
			b01000 = "No of blocks:2 Number of first block:1"
			b01001 = "No of blocks:2 Number of first block:2"
			b01010 = "No of blocks:2 Number of first block:3"
			b01011 = "No of blocks:2 Number of first block:4"
			b01100 = "No of blocks:2 Number of first block:5"
			b01101 = "No of blocks:3 Number of first block:0"
			b01110 = "No of blocks:3 Number of first block:1"
			b01111 = "No of blocks:3 Number of first block:2"
			b10000 = "No of blocks:3 Number of first block:3"
			b10001 = "No of blocks:3 Number of first block:4"
			b10010 = "No of blocks:4 Number of first block:0"
			b10011 = "No of blocks:4 Number of first block:1"
			b10100 = "No of blocks:4 Number of first block:2"
			b10101 = "No of blocks:4 Number of first block:3"
			b10110 = "No of blocks:5 Number of first block:0"
			b10111 = "No of blocks:5 Number of first block:1"
			b11000 = "No of blocks:5 Number of first block:2"
			b11001 = "No of blocks:6 Number of first block:0"
			b11010 = "No of blocks:6 Number of first block:1"
			b11011 = "No of blocks:7 Number of first block:0"
		}}: bit (5)> }
    < Band indicator >
    <spare padding>;

  slave < Band indicator > ::= < BAND_INDICATOR : bit>;
}

#BEGIN TS44.018,10.5.2.33
#------------------------------------
# TS 44.018, 10.5.2.33
#------------------------------------
csn.1 {
  <SI2bisRestOctets> ::= <dummy{void}:null><spare padding>;
}

#BEGIN TS44.018,10.5.2.33a
#------------------------------------
# TS 44.018, 10.5.2.33a
#------------------------------------
csn.1 {
  <SI2terRestOctets> ::=
    { L | H
      < SI2ter_MP_CHANGE_MARK : bit(1) >
      < SI2ter_3G_CHANGE_MARK : bit(1) >
      < SI2ter_INDEX : bit(3) >
      < SI2ter_COUNT : bit(3) >
      { 0 | 1 < UTRAN FDD Description : < SI2 UTRAN FDD Description struct > > }
      { 0 | 1 < UTRAN TDD Description : < SI2 UTRAN TDD Description struct > > }
      { 0 | 1 < 3G MEASUREMENT Parameters Description: < SI2 3G MEASUREMENT Parameters Description struct > > }
      { null  | L                         -- Receiver compatible with earlier release
        | H                             -- Additions in release R5:
        { 0 | 1 < 3G Additional Measurement Parameters Description :
            < SI2 3G Additional Measurement Parameters Description struct >> }
      }
    }
  <spare padding> ;

  slave < SI2 UTRAN FDD Description struct >::=               -- 21 bits are available if this structure is present on its own
    01  < FDD-ARFCN : bit (14) >              -- requires 2+14=16 bits

        -- The values '00', '10' and '11' were used in an earlier version

        -- of the protocol and shall not be used.
    { 0 | 1 < Bandwidth_FDD : bit (3) > } ;

  slave < SI2 UTRAN TDD Description struct >::=               -- 21 bits are available if this structure is present on its own

    01  < TDD-ARFCN : bit (14) >              -- requires 2+14=16 bits

        -- The values '00', '10' and '11' were used in an earlier version

        -- of the protocol and shall not be used.
    { 0 | 1 < Bandwidth_TDD {octet enum {
    		b000 = "3.84Mcps"
				b001 = "1.28Mcps"
				default = "Error"
    	}
    }: bit (3) > } ;

  slave < SI2 3G MEASUREMENT Parameters Description struct >::=
    < Qsearch_I : bit (4) >
    { 0 | 1 < FDD_Qoffset : bit (4) >           -- FDD Parameters
        < FDD_Qmin : bit (3) > }
    { 0 | 1 < TDD_Qoffset : bit (4) > } ;           -- TDD Parameters

  slave < SI2 3G Additional Measurement Parameters Description struct > ::=
    < FDD_Qmin_Offset : bit (3) >                   -- FDD Parameters
    < FDD_RSCPmin : bit (4) > ;
}

#NAME SI2quaterRestOctets
#BEGIN TS44.018,10.5.2.33b
#------------------------------------
# TS 44.018, 10.5.2.33b
#------------------------------------
csn.1 {
  < SI2quaterRestOctets > ::=
  	-- 10.5.2.33b requires this element to be exactly 20 octets long
		ENCODECO: %{PUSH_TAG (100, CURPOS + 20 * 8);}%
    < BA_IND : bit (1) >
    < p3G_BA_IND : bit (1) >
    < MP_CHANGE_MARK : bit (1) >
    < SI2quater_INDEX : bit (4) >
    < SI2quater_COUNT : bit (4) >

    { 0 | 1 < Measurement_Parameters Description : < Measurement Parameters Description struct >> }
    { 0 | 1 < GPRS_Real Time Difference Description : < GPRS_Real Time Difference Description struct >> }
    { 0 | 1 < GPRS_BSIC Description : GPRS_BSIC Description struct > }
    { 0 | 1 < GPRS_REPORT PRIORITY Description : < GPRS_REPORT_PRIORITY Description struct >> }
    { 0 | 1 < GPRS_MEASUREMENT_Parameters Description : < GPRS MEASUREMENT Parameters Description struct >> }
    { 0 | 1 < NC Measurement Parameters : < NC Measurement Parameters struct >> }
    { 0 | 1
				ENCODECO: %{
					/* Save the position of the length. This allows us to
						 write it back when encoding */
					PUSH_TAG (1, CURPOS);
				}%
					< extension length : bit (8) >
					{ < SI2q Extension Information > }
					ENCODE: %{
						/* We save the effective length in the "Extension Length" field */
						EDIntToBits (BUFFER, TAG(1), CURPOS-TAG(1)-9, 8);
					}%
					DECODE: %{CURPOS = TAG (1)+EDBitsToInt (BUFFER, TAG(1), 8)+9;}%
    } -- used for future extensions of the 2G parameters

    { 0 | 1 < p3G Neighbour Cell Description : < 3G Neighbour Cell Description struct >> }
    { 0 | 1 < p3G Measurement Parameters Description : < SI2quater 3G Measurement Parameters Description struct >> }
    { 0 | 1 < GPRS_3G_MEASUREMENT Parameters Description : < GPRS 3G MEASUREMENT Parameters Description struct >> }
		{ 	null
			| L 		-- Receiver compatible with earlier release
			| H				-- Additions in Rel-5:
				{ 0 | 1 < 3G Additional Measurement Parameters Description :
						< 3G Additional Measurement Parameters Description struct > >
			  }
		 		{ 0 | 1 < 3G ADDITIONAL MEASUREMENT Parameters Description 2 :
						< 3G ADDITIONAL MEASUREMENT Parameters Description 2 struct> >
				}
			  {
			  	null
			  	| L 		-- Receiver compatible with earlier release
					| H 				-- Additions in Rel-6:
						< 3G_CCN_ACTIVE {boolean enum {
							0 = "CCN towards 3G cells is disabled in the cell"
							1 = "CCN towards 3G cells is enabled in the cell"
						}} : bit>
						{
							null
							| L 		-- Receiver compatible with earlier release
							| H 				-- Additions in Rel-7:
								{ 0 | 1	< 700_REPORTING_OFFSET : bit (3) >
										< 700_REPORTING_THRESHOLD : bit (3) > }
								{ 0 | 1	< 810_REPORTING_OFFSET : bit (3) >
										< 810_REPORTING_THRESHOLD : bit (3) > }
								{ 	null | L 		-- Receiver compatible with earlier release
									| H 				-- Additions in Rel-8
										{ 0 | 1	< Priority and E-UTRAN Parameters Description :
												< Priority and E-UTRAN Parameters Description struct >> }
										{ 0 | 1	< 3G CSG Description : < 3G CSG Description struct >> }
										{ 0 | 1	< E-UTRAN CSG Description : < E-UTRAN CSG Description struct >> }
								{ 	null | L 		-- Receiver compatible with earlier release
								| H 				-- Additions in Rel-9
									{ 0 | 1	< Enhanced Cell Reselection Parameters Description :
											< Enhanced Cell Reselection Parameters IE >> }
									{ 0 | 1	< CSG Cells Reporting Description :
											< CSG Cells Reporting Description struct >> }
									{ 	null | L 		-- Receiver compatible with earlier release
										| H 				-- Additions in Rel-10
											{ 0 | 1	< INIT_PWR_RED : bit (1)> }
											< NC2_CSG_PCCN_permitted : bit (1) > }
											{ 	null | L 		-- Receiver compatible with earlier release
												| H 				-- Additions in Rel-11
													{ 0 | 1	< Extended EARFCNs Description:
															< Extended EARFCNs Description struct >> }
													{ 0 | 1	< Extended EARFCNs Description for CSG Cells:
															< Extended EARFCNs Description for CSG Cells struct >> }
											}
								}
								}
						}
			 }
	 	}
    {bit = L} * ENCODECO_EXPR: %{((int)CURPOS) >= TAGZ(100) ? 0 : TAGZ(100)-CURPOS}%;

  slave <MEASUREMENT PARAMETERS Description Struct > ::=
    < REPORT_TYPE : bit >
    < SERVING_BAND_REPORTING : bit (2) > ;

  slave < SI2quater 3G MEASUREMENT PARAMETERS Description struct > ::=
    < Qsearch_I : bit (4) >
    < Qsearch_C_Initial : bit (1) >
    { 0 | 1 < FDD_Qoffset : bit (4) >                 -- FDD information
        < FDD_REP_QUANT : bit (1) >
        < FDD_MULTIRAT_REPORTING : bit (2) >
        < FDD_Qmin : bit (3) > }
    { 0 | 1 < TDD_Qoffset : bit (4) >                 -- TDD information
        < TDD_MULTIRAT_REPORTING : bit (2) > } ;

  slave < GPRS Real Time Difference Description struct > ::=
    { 0 | 1 { 0 | 1 < BA_Index_Start_RTD : bit (5) > }    --default value=0
      < RTD : < RTD6 Struct >>
      { 0 < RTD : < RTD6 Struct >> } **1 }         -- '0' : increment by 1 the index of the BA (list) frequency

    { 0 | 1 { 0 | 1 < BA_Index_Start_RTD : bit (5) > }    --default value=0
      < RTD : < RTD12 Struct >>
      { 0 < RTD : < RTD12 Struct >> } **1 };         -- '0' : increment by 1 the index of the BA (list) frequency

  slave < RTD6 Struct > ::=  { 0 < RTD : bit (6) > } ** 1;   -- Repeat until '1' ; '1' means last RTD for this frequency
  slave < RTD12 Struct > ::= { 0 < RTD : bit (12) > } ** 1;    -- Repeat until '1' ; '1' means last RTD for this frequency

  slave < GPRS BSIC Description struct > ::=
    { 0 | 1 < BA_Index_Start_BSIC : bit (5) > }       -- default value=0
    < BSIC : bit (6) >
    < Number_Remaining_BSIC: bit (7) >
    <Remaining_BSICs:
    { < Frequency_Scrolling : bit >             -- 0 means same frequency
      < BSIC : bit (6) > } * (val(Number_Remaining_BSIC)) >;

  slave < GPRS REPORT PRIORITY Description struct > ::=
    < Number_Cells : bit (7) >
    < REP_PRIORITY {boolean enum {
				0 = "Normal reporting priority"
				1 = "High reporting priority"
    	}}: bit > * (val(Number_Cells)) ;

  slave < 3G Neighbour Cell Description struct > ::=
    { 0 | 1 < Index_Start_3G : bit (7) > }
    { 0 | 1 < Absolute_Index_Start_EMR : bit (7) > }
    { 0 | 1 < UTRAN FDD Description : < UTRAN FDD Description struct >> }
    { 0 | 1 < UTRAN TDD Description : < UTRAN TDD Description struct >> };

  slave < REMOVED_3GCELL_Description struct > ::=
    < N1 : bit (2) >
    <n1: 
    { < N2 : bit (5) >
    	<n2:
      { < REMOVED_3GCELL_INDEX : bit (7) >
        < p3G_CELL_DIFF_LENGTH : bit (3) >
        < p3GCELL_DIFF : bit (val(p3G_CELL_DIFF_LENGTH)) >
      } * (1+val(N2))>
    } * (1+val(N1)) >;

  slave < UTRAN FDD Description struct > ::=
    { 0 | 1 < Bandwidth_FDD : bit (3) > }
    { 1 < Repeated UTRAN FDD Neighbour Cells : < Repeated UTRAN FDD Neighbour Cells struct >> } ** 0 ;

  slave < Repeated UTRAN FDD Neighbour Cells struct > ::=
    0 < FDD-ARFCN : bit (14) >    -- The value '1' was used in an earlier
                      -- version of the protocol and shall not be used.
    < FDD_Indic0 : bit >
    < NR_OF_FDD_CELLS : bit (5) > ENCODECO: %{PUSH_TAG(7, (EDBitsToInt(BUFFER, CURPOS-5, 5)));}%
    < FDD_CELL_INFORMATION Field {FDD_CELL_INFORMATION}: bit* ENCODECO_EXPR: %{DECODE_FDD_CELL_INFORMATION_p (TAG(7))}% [122] > ; -- p(x) defined in table 11.2.9b.2.a/3GPP TS 44.060

  slave < UTRAN TDD Description struct > ::=
    { 0 | 1 < Bandwidth_TDD : bit (3) > }
    { 1 < Repeated UTRAN TDD Neighbour Cells : < Repeated UTRAN TDD Neighbour Cells struct >> } ** 0 ;

  slave < Repeated UTRAN TDD Neighbour Cells struct > ::=
    { 0 < TDD-ARFCN : bit (14) > | 1 < TDD-ARFCN-INDEX : bit (3) > }
                      -- The value '1' is not used anymore
                      -- the protocol and shall not be used.
    < TDD_Indic0 : bit >
    < NR_OF_TDD_CELLS : bit (5) > ENCODECO: %{PUSH_TAG(6, (EDBitsToInt(BUFFER, CURPOS-5, 5)));}%
    < TDD_CELL_INFORMATION Field {TDD_CELL_INFORMATION}: bit * ENCODECO_EXPR: %{DECODE_TDD_CELL_INFORMATION_q (TAG(6))}% [126]> ; -- q(x) defined in table 9.1.54.1/3GPP TS 44.060

  slave < SI2q Extension Information > ::=
    { 0 | 1 < CCN Support Description : < CCN Support Description struct >> }
    <spare bit>** ;

  slave < CCN Support Description struct > ::=
    < Number_Cells : bit (7) >
    < CCN_SUPPORTED{boolean enum {
				0 = "CCN is enabled towards the corresponding cell"
				1 = "CCN is disabled towards the corresponding cell"
    	}} : bit> * (val(Number_Cells)) [40];

	slave < 3G Additional Measurement Parameters Description struct > ::=
		< FDD_Qmin_Offset : bit (3) > 										-- FDD information
		< FDD_RSCPmin : bit (4) > ;

	slave < 3G Additional Measurement Parameters Description 2 struct > ::=
 		{ 0 | 1 < FDD_REPORTING_THRESHOLD_2 : bit (6) > } ;		-- FDD information


	slave < GPRS MEASUREMENT PARAMETERS Description struct > ::=
		< REPORT_TYPE : bit >
		< REPORTING_RATE : bit >
		< INVALID_BSIC_REPORTING : bit >
		{ 0 | 1	< MULTIBAND_REPORTING : bit (2) > }
		{ 0 | 1	< SERVING_BAND_REPORTING : bit (2) > }
		< SCALE_ORD : bit(2) >

		{ 0 | 1	< p900_REPORTING_OFFSET : bit (3) >
				< p900_REPORTING_THRESHOLD : bit (3) > }

		{ 0 | 1	< p1800_REPORTING_OFFSET : bit (3) >
				< p1800_REPORTING_THRESHOLD : bit (3) > }

		{ 0 | 1	< p400_REPORTING_OFFSET : bit (3) >
				< p400_REPORTING_THRESHOLD : bit (3) > }

		{ 0 | 1	< p1900_REPORTING_OFFSET : bit (3) >
				< p1900_REPORTING_THRESHOLD : bit (3) > }

		{ 0 | 1	< p850_REPORTING_OFFSET : bit (3) >
				< p850_REPORTING_THRESHOLD : bit (3) > } ;


	slave < GPRS 3G MEASUREMENT PARAMETERS Description struct > ::=
		< Qsearch_P : bit (4) >
		< p3G_SEARCH_PRIO : bit >
		{ 0 | 1 < FDD_REP_QUANT : bit >
					-- FDD Parameters
				< FDD_MULTIRAT_REPORTING : bit (2) > }

		{ 0 | 1	< FDD_REPORTING_OFFSET : bit (3) >
				< FDD_REPORTING_THRESHOLD : bit (3) > }

		{ 0 | 1	< TDD_MULTIRAT_REPORTING : bit (2) > }
			-- TDD Parameters
		{ 0 | 1	< TDD_REPORTING_OFFSET : bit (3) >
				< TDD_REPORTING_THRESHOLD : bit (3) > } ;

	slave < NC Measurement Parameters struct > ::=
		< NETWORK_CONTROL_ORDER : bit (2) >
		{ 0 | 1 < NC_NON_DRX_PERIOD : bit (3) >
				< NC_REPORTING_PERIOD_I : bit (3) >
				< NC_REPORTING_PERIOD_T : bit (3) > }
		;


	slave < Priority and E-UTRAN Parameters Description struct > ::=
		{ 0 | 1	< Serving Cell Priority Parameters Description :
				< Serving Cell Priority Parameters Description struct >> }
		{ 0 | 1	< 3G Priority Parameters Description :
				< 3G Priority Parameters Description struct >> }
		{ 0 | 1	< E-UTRAN Parameters Description :
				< E-UTRAN Parameters Description struct >> } ;

	slave < Serving Cell Priority Parameters Description struct > ::=
		< GERAN_PRIORITY : bit(3) >
		< THRESH_Priority_Search : bit(4) >
		< THRESH_GSM_low : bit(4) >
		< H_PRIO : bit(2) >
		< T_Reselection : bit(2) >;

	slave < 3G Priority Parameters Description struct > ::=
		< UTRAN_Start : bit >
		< UTRAN_Stop : bit >
		{ 0 | 1	< DEFAULT_UTRAN_PRIORITY : bit(3) >
				< DEFAULT_THRESH_UTRAN: bit(5) >
				< DEFAULT_UTRAN_QRXLEVMIN: bit(5) > }
		{ 1 < Repeated UTRAN Priority Parameters : < Repeated UTRAN Priority Parameters struct >> } ** 0 ;

	slave < Repeated UTRAN Priority Parameters struct > ::=
		{ 1 < UTRAN_FREQUENCY_INDEX : bit (5) > } ** 0
		{ 0 | 1	< UTRAN_PRIORITY : bit(3) > }
		< THRESH_UTRAN_high : bit(5) >
		{ 0 | 1	< THRESH_UTRAN_low : bit(5) > }
		{ 0 | 1	< UTRAN_QRXLEVMIN: bit(5) > } ;

	slave < E-UTRAN Parameters Description struct > ::=
		< E-UTRAN_CCN_ACTIVE : bit >
		< E-UTRAN_Start : bit >
		< E-UTRAN_Stop : bit >
		{ 0 | 1	<E-UTRAN Measurement Parameters Description :
				< E-UTRAN Measurement Parameters Description struct >> }
		{ 0 | 1	<GPRS E-UTRAN Measurement Parameters Description :
				< GPRS E-UTRAN Measurement Parameters Description struct >> }
		{ 1 < Repeated E-UTRAN Neighbour Cells : < Repeated E-UTRAN Neighbour Cells struct >> } ** 0
		{ 1 < Repeated E-UTRAN Not Allowed Cells : < Repeated E-UTRAN Not Allowed Cells struct >> } ** 0
		{ 1 < Repeated E-UTRAN PCID to TA mapping : < Repeated E-UTRAN PCID to TA mapping struct >> } ** 0 ;

	slave < E-UTRAN Measurement Parameters Description struct > ::=
		< Qsearch_C_E-UTRAN_Initial : bit(4) >
		< E-UTRAN_REP_QUANT : bit >
		< E-UTRAN_MULTIRAT_REPORTING : bit(2) >
		{ 0		{ 0 | 1	< E-UTRAN_FDD_REPORTING_THRESHOLD : bit(3) > 				-- FDD 6 bit reporting
						{ 0 | 1	< E-UTRAN_FDD_REPORTING_THRESHOLD_2 : bit(6) > }
						{ 0 | 1	< E-UTRAN_FDD_REPORTING_OFFSET : bit(3) > } }
				{ 0 | 1	< E-UTRAN_TDD_REPORTING_THRESHOLD : bit(3) > 				-- TDD 6 bit reporting
						{ 0 | 1	< E-UTRAN_TDD_REPORTING_THRESHOLD_2 : bit(6) > }
						{ 0 | 1	< E-UTRAN_TDD_REPORTING_OFFSET : bit(3) > } }
		| 1		{ 0 | 1	< E-UTRAN_FDD_MEASUREMENT_REPORT_OFFSET: bit(6) >		-- FDD 3 bit reporting
						{ 0 | 1	< E-UTRAN_FDD_REPORTING_THRESHOLD_2 : bit(6) > }
						{ 0 | 1	< E-UTRAN_FDD_REPORTING_OFFSET : bit(3) > } }
				{ 0 | 1	< E-UTRAN_TDD_MEASUREMENT_REPORT_OFFSET: bit(6) >		-- TDD 3 bit reporting
						{ 0 | 1	< E-UTRAN_TDD_REPORTING_THRESHOLD_2 : bit(6) > }
						{ 0 | 1	< E-UTRAN_TDD_REPORTING_OFFSET : bit(3) > } }
				< REPORTING_GRANULARITY : bit(1) > } ;

	slave < GPRS E-UTRAN Measurement Parameters Description struct > ::=
		< Qsearch_P_E-UTRAN : bit(4) >
		< E-UTRAN_REP_QUANT : bit >
		< E-UTRAN_MULTIRAT_REPORTING : bit(2) >
		{ 0 | 1	< E-UTRAN_FDD_REPORTING_THRESHOLD : bit(3) >
				{ 0 | 1	< E-UTRAN_FDD_REPORTING_THRESHOLD_2 : bit(6) > }
				{ 0 | 1	< E-UTRAN_FDD_REPORTING_OFFSET : bit(3) > } }
		{ 0 | 1	< E-UTRAN_TDD_REPORTING_THRESHOLD : bit(3) >
				{ 0 | 1	< E-UTRAN_TDD_REPORTING_THRESHOLD_2 : bit(6) > }
				{ 0 | 1	< E-UTRAN_TDD_REPORTING_OFFSET : bit(3) > } } ;

	slave < Repeated E-UTRAN Neighbour Cells struct > ::=
		{ 1 <cell: < EARFCN : bit (16) >
			{ 0 | 1 < Measurement Bandwidth : bit (3) > }> } ** 0
		{ 0 | 1	< E-UTRAN_PRIORITY : bit(3) > }
		< THRESH_E-UTRAN_high: bit(5) >
		{ 0 | 1	< THRESH_E-UTRAN_low: bit(5) > }
		{ 0 | 1	< E-UTRAN_QRXLEVMIN : bit(5) > };

	slave < Repeated E-UTRAN Not Allowed Cells struct > ::=
		< Not Allowed Cells : < PCID Group IE >>
		{ 1 < E-UTRAN_FREQUENCY_INDEX : bit(3) > } ** 0 ;

	slave < Repeated E-UTRAN PCID to TA mapping struct > ::=
		{ 1																	-- each repetition corresponds to a different TA
			< PCID to TA mapping : < PCID Group IE >>				-- group of PCIDs belonging to the same TA
		} ** 0
		{ 1 < E-UTRAN_FREQUENCY_INDEX : bit(3) > } ** 0 ;

	slave < 3G CSG Description struct > ::=
		{ 1	< CSG_PSC_SPLIT : < PSC Group IE >>
				{ 1	< UTRAN_FREQUENCY_INDEX : bit (5) > } ** 0 } ** 0
		{ 1 { 0 < CSG_FDD_UARFCN : bit (14) > | 1 < CSG_TDD_UARFCN : bit (14) > } } ** 0 ;
																						-- UTRAN CSG Dedicated Frequencies

	slave < E-UTRAN CSG Description struct > ::=
		{ 1	<CSG_PCI: < CSG_PCI_SPLIT : <PCID Group IE >>
				{ 1	< E-UTRAN_FREQUENCY_INDEX : bit (3) > } ** 0> } ** 0
		{ 1 < CSG_EARFCN : bit (16) > } ** 0 ;										-- E-UTRAN CSG Dedicated Frequencies

	slave < CSG Cells Reporting Description struct > ::=
		{ 0 | 1 < UTRAN CSG Cells Reporting Description : < UTRAN CSG Cells Reporting Description struct >> }
		{ 0 | 1 < E-UTRAN CSG Cells Reporting Description : <E-UTRAN CSG Cells Reporting Description struct >> } ;
	
	slave < UTRAN CSG Cells Reporting Description struct > ::=
		{ 0 | 1	< UTRAN_CSG_FDD_REPORTING_THRESHOLD : bit (3) >
				< UTRAN_CSG_FDD_REPORTING_THRESHOLD_2 : bit (6) > }
		{ 0 | 1	< UTRAN_CSG_TDD_REPORTING_THRESHOLD : bit (3) > } ;

	slave < E-UTRAN CSG Cells Reporting Description struct > ::=
		{ 0 | 1	< E-UTRAN_CSG_FDD_REPORTING_THRESHOLD : bit (3) >
				< E-UTRAN_CSG_FDD_REPORTING_THRESHOLD_2 : bit (6) > }
		{ 0 | 1	< E-UTRAN_CSG_TDD_REPORTING_THRESHOLD : bit (3) >
				< E-UTRAN_CSG_FDD_REPORTING_THRESHOLD_2 : bit (6) > } ;

	slave < Extended EARFCNs Description struct > ::=
     { 1 < EARFCN_extended : bit(18) >} ** 0 ;

	slave < Extended EARFCNs Description for CSG Cells struct > ::=
     { 1 < CSG_EARFCN_extended : bit(18) >} ** 0 ;


}


#BEGIN TS44.018,10.5.2.34
#------------------------------------
# TS 44.018, 10.5.2.34
#------------------------------------
csn.1 {
  <SI3RestOctet> ::=
					ENCODECO: %{PUSH_TAG (1, CURPOS);}%
          <Optional selection parameters>
          <Optional Power offset>
          <System Information 2ter Indicator>
          <Early Classmark Sending Control>
          <Scheduling if and where>
          { L | H   <SI13 GPRS Indicator> }
          <3G Early Classmark Sending Restriction>
          { L | H < SI2quater Indicator : < SI2quater Indicator struct > > }
          {null | <Iu Indicator> {null | <System Information 21 Indicator> } }	-- Conditional
					{bit = L} * ENCODECO_EXPR: %{32 - (CURPOS - TAG(1))}%;

  slave <Optional Selection Parameters> ::=
          L | H <Selection Parameters>;
  slave <Selection Parameters> ::=
          <CBQ: bit (1)>
          <CELL_RESELECT_OFFSET: bit (6)>
          <TEMPORARY_OFFSET: bit (3)>
          <PENALTY_TIME: bit (5)>;
  slave <Optional Power Offset> ::=
          L | H <Power Offset {octet enum {
						b00 = "0 dB power offset"
						b01 = "2 dB power offset"
						b10 = "4 dB power offset"
						b11 = "6 dB power offset"
          }}: bit (2)>;
  slave <System Information 2ter Indicator> ::=
          L | <System Information 2ter {void}: null> H;
  slave <Early Classmark Sending Control> ::=
          L | <Early Classmark Sending Control {void}: null> H;
  slave <Scheduling if and where>::=
          L | H <WHERE: bit (3)>;
  slave <SI13 GPRS Indicator> ::=
          < RA COLOUR : bit (3) >
          < SI13 POSITION {boolean enum {
						0 = "SYSTEM INFORMATION TYPE 13 message is sent on BCCH Norm"
						1 = "SYSTEM INFORMATION TYPE 13 message is sent on BCCH Ext"
          }}: bit >;
  slave <3G Early Classmark Sending Restriction>::=
          L | <3G Early Classmark Sending Restriction {void}: null> H;
  slave < SI2quater Indicator struct > ::=
           < SI2quater_POSITION {
							boolean enum {
								0 = "SYSTEM INFORMATION TYPE 2 quater message is sent on BCCH Norm"
								1 = "SYSTEM INFORMATION TYPE 2 quater message is sent on BCCH Ext"
							}
           }: bit > ;
  slave <Iu Indicator> ::= <SI13alt POSITION {boolean enum {
			0 = "SYSTEM INFORMATION TYPE 13alt message is sent on BCCH Norm"
			1 = "SYSTEM INFORMATION TYPE 13alt message is sent on BCCH Ext"
  	}}: bit >;
  slave <System Information 21 Indicator> ::=		L | H < SI21_POSITION : bit > ;
}

#NAME SI4_Rest_Octets
#BEGIN TS44.018,10.5.2.35
#------------------------------------
# TS 44.018, 10.5.2.35
#------------------------------------
csn.1 {
  <SI4 Rest Octets> ::=
  {
    <SI4 Rest Octets_O>
    {L <Break indicator> | H <SI4 Rest Octets_S>}
  } // -- truncation allowed, bits 'L' assumed
    <spare padding>
  ;  

  slave <SI4 Rest Octets_O> ::=
  {         <Optional selection parameters>
          <Optional Power offset>
          {L | H < GPRS Indicator >}
  } // -- truncation allowed, bits 'L' assumed
  ;
  slave <SI4 Rest Octets_S> ::=
          {L | H <LSA Parameters>}
          {L | H <Cell Identity : bit(16)>}
          {L | H <LSA ID information>}
					{L | H < CBQ3 : bit (2) >
						{0 | 1 < SI13alt Position {boolean enum {
			0 = "SYSTEM INFORMATION TYPE 13alt message is sent on BCCH Norm"
			1 = "SYSTEM INFORMATION TYPE 13alt message is sent on BCCH Ext"
  	}}: bit >}
					};

  slave <Break Indicator> ::= L | <Break Indicator {void}: null> H ;

  <SI7 Rest Octets> ::= <SI4 Rest Octets_O><SI4 Rest Octets_S> |<SI4 Rest Octets_S> ;

  <SI8 Rest Octets> ::= <SI4 Rest Octets_O><SI4 Rest Octets_S> |<SI4 Rest Octets_S> ;

  -- slave <Optional Selection Parameters> ::=   L | H <Selection Parameters>  ;

  -- slave <Selection Parameters> ::=    <CBQ : bit (1)>
  --                 <CELL_RESELECT_OFFSET : bit (6)>
  --                     <TEMPORARY_OFFSET : bit (3)>
  --                 < PENALTY_TIME : bit (5)> ;

  -- slave <Optional Power Offset> ::=   L | H <Power Offset {octet enum {
	-- 					b00 = "0 dB power offset"
	-- 					b01 = "2 dB power offset"
	-- 					b10 = "4 dB power offset"
	-- 					b11 = "6 dB power offset"
  --         }}: bit(2)> ;

  slave <GPRS Indicator> ::=      < RA COLOUR : bit (3) >
                        < SI13 POSITION {boolean enum {
													0 = "SYSTEM INFORMATION TYPE 13 message is sent on BCCH Norm"
													1 = "SYSTEM INFORMATION TYPE 13 message is sent on BCCH Ext"
                        }}: bit > ;

  slave <LSA Parameters> ::=      <PRIO_THR : bit (3)>
                    <LSA_OFFSET : bit (3)>
                    {0 | 1 <MCC : bit (12)>
                     <MNC : bit (12)>} ;

  slave <LSA ID information> ::=    <LSA identity>
                      {0 | 1 <LSA ID information>} ;

  slave <LSA identity> ::=      {0 <LSA_ID : bit (24)>
                     |1 <ShortLSA_ID : bit (10)>} ;
}

#NAME SI6RestOctet
#BEGIN TS44.018,10.5.2.35a
#------------------------------------
# TS 44.018, 10.5.2.35a
#------------------------------------
csn.1 {
	<SI6RestOctet> ::=
			{L | H <PCH and NCH info>}
			{L | H <VBS/VGCS options : bit(2)>}
		{
			L
		|
			< DTM_support {void}: null> H
			< RAC : bit (8) >
			< MAX_LAPDm : bit (3) > }
			< Band indicator >
		{ L | H	< GPRS_MS_TXPWR_MAX_CCH : bit (5) > }
		{ L | H 			-- MBMS procedures supported by the cell
			< DEDICATED_MODE_MBMS_NOTIFICATION_SUPPORT: bit >
			< MNCI_SUPPORT: bit >}
			{	L 				-- Receiver compatible with earlier release
				| H	 			-- Additions in Release 7 :
					{ 0 | 1 <AMR Config:bit(4)> }
			}
	      { H	< Random bit stream : bit **>
		| L
		-- Extension must be made in expanding the "L" branch with a new structure including a 'Random bit stream'
		}
		<spare padding>;

	slave <PCH and NCH info> ::=
		<Paging channel restructuring>
		<NLN SACCH : bit(2)>
		{0 | 1 <Call priority : bit (3)>}
		<NLN status : bit >;

   slave <paging channel restructuring> ::= <paging channel restructuring {boolean enum {
     1 = "paging channel is restructured"
     0 = "paging channel is not restructured"
   	}}: bit>;

   slave <VBS VGCS options> ::=
       <inband notifications>
       <inband pagings>;

   slave <inband notifications> ::= <inband notifications {boolean enum {
       0 = "the network does not provide notification on FACCH so that the mobile should    inspect the NCH for notifications"
       1 = "the mobile shall be notified on incoming high priority VBS/VGCS calls through NOTIFICATION/FACCH, the mobile need not to inspect the NCH"
		}}: bit>;

   slave <inband pagings>::= <inband pagings {boolean enum {
       0 = "the network does not provide paging information on FACCH so that the mobile should inspect the PCH for pagings"
       1 = "the mobile shall be notified on incoming high priority point-to-point calls through NOTIFICATION/FACCH, the mobile need not to inspect the PCH"
		}}: bit>;

	-- slave < Band indicator > ::=
	--	  < BAND_INDICATOR : L|H >;	L=ARFCN indicates 1800 band R=ARFCN indicates 1900 band
}

#NAME SI13RestOctets
#BEGIN TS44.018,10.5.2.37b
#------------------------------------
# TS 44.018, 10.5.2.37b
#------------------------------------
csn.1 {
  < SI13RestOctets > ::=
    -- Save the position where the message begins: we'll need it
    -- later to pad exactly to 20 octets
    ENCODECO: %{PUSH_TAG (5, CURPOS);}%
    {
      L
      |
      H < BCCH_CHANGE_MARK : bit (3) >
        < SI_CHANGE_FIELD {
            octet enum {
              0 = "Update of unspecified SI message or SI messages"
              1 = "Update of SI1 message"
              2 = "Update of SI2, SI2 bis or SI2 ter message or any instance of SI2quater messages"
              3 = "Update of SI3, SI4, SI7 or SI8 message"
              4 = "Update of SI9 message;"
              5 = "Update of SI18 or SI20 message"
              6 = "Update of SI19 message"
              default = "update of unknown SI message type"
            }
          }: bit (4) >
        {
          0
          |
          1 < SI13_CHANGE_MARK : bit (2) >
            < GPRS Mobile Allocation : GPRS Mobile Allocation IE >
        }     -- Defined in 3GPP TS 44.060
        {
          0 -- PBCCH not present in cell :
          <NoPBCCH:
            < RAC : bit (8) >
            < SPGC_CCCH_SUP {
              boolean enum {
                0 = "SPLIT_PG_CYCLE is not supported on CCCH in this cell"
                1 = "SPLIT_PG_CYCLE is supported on CCCH in this cell"
              }
            }: bit >
            < PRIORITY_ACCESS_THR {
              octet enum {
                b000 = "packet access is not allowed in the cell"
                b001 = "spare, shall be interpreted as '000' (packet access not allowed)"
                b010 = "spare, shall be interpreted as '000' (packet access not allowed)"
                b011 = "packet access is allowed for priority level 1"
                b100 = "packet access is allowed for priority level 1 to 2"
                b101 = "packet access is allowed for priority level 1 to 3"
                b110 = "packet access is allowed for priority level 1 to 4"
                b111 = "spare, shall be interpreted as '110' (packet access allowed)"
              }
            }: bit (3) >
            < NETWORK_CONTROL_ORDER {
              octet enum {
                b00 = "NC0: MS controlled cell re-selection, no measurement reporting"
                b01 = "NC1: MS controlled cell re-selection, MS sends measurement reports"
                b10 = "NC2: Network controlled cell re-selection, MS sends measurement reports"
                b11 = "Reserved for future use, interpreted as NC0 by mobile station"
              }
            }: bit (2) >
            < GPRS Cell Options : GPRS Cell Options IE >  -- Defined in 3GPP TS 44.060
            < GPRS Power Control Parameters : GPRS Power Control Parameters IE >
          >
        | 1           -- PBCCH present in cell :
          < PSI1_REPEAT_PERIOD : bit (4) >
          < PBCCH Description : PBCCH Description struct >
        }
        {
          null
          |
          L   -- Receiver compatible with ealier release
          |
          H   -- Additions in release 99 :
            < SGSNR : bit >
						{	null
							| L 		-- Receiver compatible with earlier release
				 			| H 		-- Additions in release Rel-4:
								< SI_STATUS_IND : bit >
								{	null
									| L -- Receiver compatible with earlier release
				 					| H -- Additions in release Rel-6:
										{ 0	| 1	< LB_MS_TXPWR_MAX_CCH : bit (5) > }
										< SI2n_SUPPORT : bit(2) > }
											{ 
								 				-- Additions in release Rel-11:
												< SI_CHANGE_ALT >
								 				-- Additions in future releases shall be indicated above this line
											} //		-- truncation according to sub-clause 8.9 is allowed, bits "L" assumed
						}

        }
    } { bit = L } * ENCODECO_EXPR: %{160 - (CURPOS - TAG(5))}%;

  slave < PBCCH Description struct > ::=
    < Pb : bit (4) >
    < TSC : bit (3) >
    < TN : bit (3) >
    { 00 -- default to BCCH carrier
    | 10  < ARFCN : bit (10) >
    | 1  < MAIO : bit (6) > } ;

	< SI_CHANGE_ALT > ::=	L | <SI_CHANGE_ALT_H {void}: null> H ;    
}

#NAME SI16RestOctet
#BEGIN TS44.018,10.5.2.37e
#------------------------------------
# TS 44.018, 10.5.2.37e
#------------------------------------
csn.1 {
	<SI16RestOctet> ::=	{L | H <SI16 LSA Parameters>}
		<spare padding> ;

	slave <SI16 LSA Parameters> ::=
		<PRIO_THR : bit (3)>
		<LSA_OFFSET : bit (3)>
		{0 | 1 <MCC : bit (12)>	<MNC : bit (12)>}
		<LSA ID information>;

	-- Defined also at 10.5.2.35
	-- slave <LSA ID information> ::=
	--	<LSA identity>
	--	{0 | 1 <LSA ID information>} ;

	-- Defined also at 10.5.2.35
	-- slave <LSA identity> ::=
	--	{0 <LSA_ID : bit (24)>
	--	|1 <ShortLSA_ID : bit (10)>} ;
}

#BEGIN TS44.018,10.5.2.37h
#------------------------------------
# TS 44.018, 10.5.2.37h
#------------------------------------
csn.1 {
	< SI18RestOctet > ::=
		< SI18_CHANGE_MARK : bit (2) >
		< SI18_INDEX : bit (3) >
		< SI18_LAST : bit (1) >
		< spare bit > * 2

		< Non-GSM Message : < Non-GSM Message struct > > **
					-- The Non-GSM Message struct is repeated until:
					--	A) val(NR_OF_CONTAINER_OCTETS) = 0, or
					--	B) the SI message is fully used
		< spare padding > ;

	slave < Non-GSM Message struct > ::=
		< Non-GSM Protocol Discriminator : bit(3) >
		< NR_OF_CONTAINER_OCTETS : bit(5) >
		{ < CONTAINER : bit(8) > } * (val(NR_OF_CONTAINER_OCTETS)) ;
}

#BEGIN TS44.018,10.5.2.37j
#------------------------------------
# TS 44.018, 10.5.2.37j
#------------------------------------
csn.1 {
	< SI14RestOctets > ::=
		< SI14_INDEX : bit (2) >
		< SI14_COUNT : bit (2) >
		< DM_CHANGE_MARK : bit (4) >
		< DYNAMIC ARFCN MAPPING Description : { 1 < DYNAMIC ARFCN MAPPING > } ** 0 >
		< spare padding > ;

	-- slave < DYNAMIC ARFCN MAPPING >::=
	-- 	< GSM_Band : bit (4) >
	-- 	< ARFCN_FIRST : bit (10) >									-- Dynamic ARFCN mapping parameters
	-- 	< BAND_OFFSET : bit (10) >
	-- 	< ARFCN_RANGE : bit (7) > ;
}

#BEGIN TS44.018,10.5.2.37k
#------------------------------------
# TS 44.018, 10.5.2.37k
#------------------------------------
csn.1 {
	< SI15RestOctets > ::=
		< SI15_INDEX : bit (2) >
		< SI15_COUNT : bit (2) >
		< DM_CHANGE_MARK : bit (4) >
		< DYNAMIC ARFCN MAPPING Description : { 1 < DYNAMIC ARFCN MAPPING > } ** 0 >
		< spare padding > ;

	-- slave < DYNAMIC ARFCN MAPPING >::=
	-- 	< GSM_Band : bit (4) >
	-- 	< ARFCN_FIRST : bit (10) >								-- Dynamic ARFCN mapping parameters
	-- 	< BAND_OFFSET: bit (10) >
	-- 	< ARFCN_RANGE : bit (7) > ;
};

#BEGIN TS44.018,10.5.2.37L
#------------------------------------
# TS 44.018, 10.5.2.37L
#------------------------------------
csn.1 {
	< SI13altRestOctets > ::=

		< PBCCH Description : < PBCCH Description 2 struct >>
		< spare padding > ;

	slave < PBCCH Description 2 struct > ::=
		< PSI1_REPEAT_PERIOD : bit (4) >
		< Pb : bit (4) >
		< TN : bit (3) >
		< PBCCH Frequency Description : < Frequency Parameters IE >> ;					-- Defined in 3GPP TS 44.060
}

#BEGIN TS44.018,10.5.2.37m
#------------------------------------
# TS 44.018, 10.5.2.37m
#------------------------------------
csn.1 {
	< SI21RestOctets > ::=
		< SI 21_CHANGE_MARK : bit (2) >
		< SI 21_INDEX : bit (3) >
		< SI 21_COUNT : bit (3) >
		{ 0 | 1	< EAB Authorization Mask: bit (10) >
				< EAB Subcategory : bit (2) > }
		< spare padding > ;
}

#BEGIN TS44.018,10.5.2.37n
#------------------------------------
# TS 44.018, 10.5.2.37n
#------------------------------------
csn.1 {
	< SI22RestOctets > ::=
		ENCODECO: %{PUSH_TAG (1, CURPOS);}%
		< SI 22_CHANGE_MARK : bit (2) >
		< SI 22_INDEX : bit (3) >
		< SI 22_COUNT : bit (3) >
		{ 0 | 1	< Network Sharing Information : < Network Sharing Information struct >> }
		-- Padding to fixed length of 20 octets
		{bit = L} * ENCODE_EXPR: %{CURPOS-TAGZ(1) < 160 ? 160-(CURPOS-TAGZ(1)) : 0}% DECODE_INFINITE;
	
	slave < Network Sharing Information struct > ::=
		< SI23 Indicator : bit >	
		< Common_PLMN_Allowed : bit >
		{ 0		 | 1 < Common_PLMN_PS_ACC : bit(16) > } 
		< Nb_Additional_PLMNs : bit (2) >
		{	{ 0 | 1 < MCC : bit (12) > } < MNC : bit (12) >
			< NCC Permitted : bit (8) >
			{ 0		-- The previously listed Access Control Class bitmap applies
			| 1		-- The indicated Access Control Class bitmap applies  
					< Additional_ACC: bit (16) > }
			{ 0			-- Domain-specific access control not in use
			| 1			-- Domain specific access control in use
				{ 0		-- The previously listed PS Access Control Class bitmap applies 
				| 1 < PS_ACC: bit(16) > }		-- The indicated PS Access Control Class bitmap applies
			} 
		} * ( val (Nb_Additional_PLMNs)+1) ;
}

#BEGIN TS44.018,10.5.2.37o
#------------------------------------
# TS 44.018, 10.5.2.37o
#------------------------------------
csn.1 {
	< SI23RestOctets > ::=
		ENCODECO: %{PUSH_TAG (1, CURPOS);}%
		< SI 23_BA_IND : bit (1) >
		< SI 23_CHANGE_MARK : bit (2) >
		< SI 23_INDEX : bit (3) >
		< SI 23_COUNT : bit (3) >
		{ 0 | 1	< IRAT Cell Reselection Information : < IRAT Cell Reselection Information struct >> }
		-- Padding to fixed length of 20 octets
		{bit = L} * ENCODE_EXPR: %{CURPOS-TAGZ(1) < 160 ? 160-(CURPOS-TAGZ(1)) : 0}% DECODE_INFINITE;
	
	slave < IRAT Cell Reselection Information struct > ::=
		{ < Priority and UTRAN Parameters Description for the Common PLMN :
		< Priority and UTRAN Parameters Description struct >> }
		{ < Priority and E-UTRAN Parameters Description for the Common PLMN : 
		< Priority and E-UTRAN Parameters Description struct 37o >> }
		< Nb_Additional_PLMNs : bit (2) >		
		{ < PLMN index : bit (2) >
			{ < Priority and UTRAN Parameters Description : 
			< Priority and UTRAN Parameters Description struct >> }
			{ < Priority and E-UTRAN Parameters Description : 
			< Priority and E-UTRAN Parameters Description struct 37o>> }
		} * ( val (Nb_Additional_PLMNs)+1) ;
	
	slave < Priority and UTRAN Parameters Description struct > ::=
		{ 0	-- Inter RAT Cell Reselection information for UTRAN not provided for the corresponding PLMN
			| 1
			{ 0		-- UTRAN default threshold information not provided for the corresponding PLMN 
				| 1
				{ 0 | 1	< DEFAULT_UTRAN_PRIORITY : bit(3) > }
				{ 0 | 1	< DEFAULT_THRESH_UTRAN_low : bit(5) > }
				{ 0 | 1	< DEFAULT_UTRAN_QRXLEVMIN : bit(5) > } }
			{ 0 | 1 < UTRAN FDD/TDD Description : < UTRAN FDD/TDD Description struct >> }
		} ;
	
	slave < UTRAN FDD/TDD Description struct > ::=
		{{ 0 | 1 < Bandwidth_FDD : bit (3) > } | { 0 | 1 < Bandwidth_TDD : bit (3) > }}
		{ 1 < Repeated UTRAN FDD/TDD Neighbour Frequency and Priority : 
		< Repeated UTRAN FDD/TDD Neighbour Frequency and Priority struct >> } ** 0 ;
	
	slave < Repeated UTRAN FDD/TDD Neighbour Frequency and Priority struct > ::=
		{ 1 < UTRAN-ARFCN : bit (14) > } ** 0
		{ 0 | 1  < UTRAN_PRIORITY : bit(3) > }
		< THRESH_UTRAN_high : bit(5) >
		{ 0 | 1	< THRESH_UTRAN_low : bit(5) > }
		{ 0 | 1	< UTRAN_QRXLEVMIN: bit(5) > }  ;
	
	slave < Priority and E-UTRAN Parameters Description struct 37o> ::= 
		{ 0	-- Inter RAT Cell Reselection information for E-UTRAN not provided for the corresponding PLMN
			| 1
			{ 0		-- E-UTRAN threshold information not provided for the corresponding PLMN
				| 1
				{ 0 | 1	< DEFAULT_E-UTRAN_PRIORITY: bit(3) > }
				{ 0 | 1	< DEFAULT_THRESH_E-UTRAN_low: bit(5) > }
				{ 0 | 1	< DEFAULT_E-UTRAN_QRXLEVMIN : bit(5) > } }
			{ 1 < Repeated E-UTRAN Neighbour Frequency and Priority : < Repeated E-UTRAN Neighbour Frequency and Priority struct >> } ** 0
			{ 1 < Repeated E-UTRAN Not Allowed Cells : < Repeated E-UTRAN Not Allowed Cells struct >> } ** 0 -- See table 10.5.2.33b.2
			{ 1 < Repeated E-UTRAN PCID to TA mapping : < Repeated E-UTRAN PCID to TA mapping struct >> } ** 0 
			{ 0 | 1	< Enhanced Cell Reselection Parameters Description : < Enhanced Cell Reselection Parameters IE >> }
		} ;
	
	slave < Repeated E-UTRAN Neighbour Frequency and Priority struct > ::=
		{ 1 < EARFCN_extended : bit (18) >
				{ 0 | 1 < Measurement Bandwidth : bit (3) > }} ** 0
		{ 0 | 1 < E-UTRAN_PRIORITY : bit(3) > }
		< THRESH_E-UTRAN_high: bit(5) >
		{ 0 | 1	< THRESH_E-UTRAN_low : bit(5) > }
		{ 0 | 1	< E-UTRAN_QRXLEVMIN : bit(5) > };
}

#BEGIN TS44.018,10.5.2.38
#------------------------------------
# TS 44.018, 10.5.2.38
#------------------------------------
bit-field StartingTime {
	size: 2 octets;
	bits 12-16: T1 integer;
	bits  6-11: T3 integer;
	bits  1-5:  T2 integer;
}
#BEGIN TS44.018,10.5.2.39
#------------------------------------
# TS 44.018, 10.5.2.39
#------------------------------------
bit-field SyncInd {
	size: 4 bits;
	bit 4: NCI boolean;
	bit 3: ROT boolean;
	bits 1-2: SI integer;
}
#BEGIN TS44.018,10.5.2.40
#------------------------------------
# TS 44.018, 10.5.2.40
#------------------------------------
bit-field TimingAdvance {
	size: 1 octet;
	bits 7-8: spare void default=0;
	bits 1-6: value integer;
}
#BEGIN TS44.018,10.5.2.42a
#------------------------------------
# TS 44.018, 10.5.2.42a
#------------------------------------
bit-field VGCSTargeModeIndication {
	size: 1 octet;
	bits 7-8: TargetMode integer;
	bits 3-6: GroupCipherKeyNumber integer;
	bits 1-2: spare void default=0;
}

#BEGIN TS44.018,10.5.2.42b
#------------------------------------
# TS 44.018, 10.5.2.42b
#------------------------------------
csn.1 {
	<VGCSCipheringParameters> ::=
		<bit> * 2  -- spare padding
		<RAND_IND : bit >
		<LAC_IND  : bit >
		<CELL_IND : bit >
		<B22 COUNT: bit >
		<CELL_GLOBAL_COUNT : bit (2) >
		{
			< Cell Identity: bit (16) >
			< Location Area Identification: bit (32) >
			{
				< VSTK_RAND: bit (40) >
				<bit> * 4
			}
		} //
		;
}

#NAME ExtMeasurementResults
#BEGIN TS44.018,10.5.2.45
#------------------------------------
# TS 44.018, 10.5.2.45
#------------------------------------
sequence TRXLEVCarriers [21] integer size 6 bits;

bit-field ExtMeasurementResults {
	size: 2 bits;
	max size: 16 octets;
	bit 1: DTXUsed boolean;
	bit 2: SCUsed boolean;
	remainder: RXLEVCarriers TRXLEVCarriers;
}
#BEGIN TS44.018,10.5.2.49
#------------------------------------
# TS 44.018, 10.5.2.49
#------------------------------------
bit-field APDUFlags {
	size: 4 bits;
	bit 4: spare void default=0;
	bit 3: CR boolean;
	bit 2: FirstSet boolean;
	bit 1: LastSet boolean;
}

#BEGIN TS44.018,10.5.2.56
#------------------------------------
# TS 44.018, 10.5.2.56
#------------------------------------
csn.1 {
< 3GTargetCell >::=
		{ 0 | 1  < FDD ARFCN : bit (14) >
	-- 3G UTRAN FDD
				< Diversity : bit >
				{ 0 | 1 < Bandwidth_FDD : bit (3) > }
				< SCRAMBLING_CODE : bit (9) > }
		{ 0 | 1 < TDD ARFCN : bit (14) >
	-- 3G UTRAN TDD
				< Diversity : bit >
				{ 0 | 1 < Bandwidth_TDD : bit (3) > }
				< Cell Parameter : bit (7) >
				< Sync Case : bit > }
	<spare padding>**;

}

#BEGIN TS44.018,10.5.2.57
#------------------------------------
# TS 44.018, 10.5.2.57
#------------------------------------
bit-field ServiceSupport {
	size: 8 bits;
	bits 3-8: spare void default=0;
	bit 2: MBMSMulticast boolean;
	bit 1: MBMSBroadcast boolean;
}

#BEGIN TS44.018,10.5.2.59
#------------------------------------
# TS 44.018, 10.5.2.59
#------------------------------------
bit-field DedicatedServiceInformation {
	size: 8 bits;
	bits 2-8: spare void default=0;
	bit 1: SIS boolean;
}

#BEGIN TS44.018,10.5.2.63
#------------------------------------
# TS 44.018, 10.5.2.63
#------------------------------------
bit-field ReducedGroupCallReference {
	size: 4 octet;
	bits 6-32: Reference integer;
	bit 5: SF boolean enum {
			0 = "VBS (broadcast call reference)"
			1 = "VGCS (group call reference)"
		};
	bits 1-4: spare void default = 0;
}

#BEGIN TS44.018,10.5.2.64
#------------------------------------
# TS 44.018, 10.5.2.64
#------------------------------------
bit-field TalkerPriorityStatus {
	size: 1 octet;
	bit 8: ES boolean enum {
		0 = "Emergency mode not set"
		1 = "Emergency mode set"
	};
	bits 5-7: spare void default=0;
	bit 4: UAI boolean enum {
		0 = "Group Channel"
		1 = "RACH Access"
	};
	bits 1-3: Priority integer enum {
		b000 = "Normal Priority"
		b001 = "Privileged Priority"
		b010 = "Emergency Priority"
		default = "reserved for future use"
	};
}


#BEGIN TS44.018,10.5.2.65
#------------------------------------
# TS 44.018, 10.5.2.65
#------------------------------------
bit-field TalkerIdentity {
	size: 1 octet;
	max size: 18 octets;
	bits 4-8: spare void default = 0;
	bits 1-3: FillerBits integer;
	remainder: TalkerIdentityfield binary;
}

#BEGIN TS44.018,10.5.2.68
#------------------------------------
# TS 44.018, 10.5.2.68
#------------------------------------
bit-field VGCSAMRConfiguration {
	size: 1 octet;
	bits 5-8: AMRConfiguration integer;
	bits 1-4: spare void default = 0;
}

#BEGIN TS44.018,10.5.2.70
#------------------------------------
# TS 44.018, 10.5.2.70
#------------------------------------
csn.1 {
	<SI10bis Rest Octets> ::=
		< SI10bis Sequence : bit (2) >
		{ H 	<Position in SI5 list : bit(5)>
				{ 0 | 1  < BCCH ARFCN : bit (10) > }
				{ 0 | 1 < BSIC : bit (6) > }
				< SI10bis Neighbour Cell Info >  } ** L
		<spare padding>;

	slave <SI10bis Neighbour Cell Info> ::=
		< Group Channel Description >
		{ 0 		-- no additional frequency list is included
		| 1	{ 0 < Frequency Short List : bit (64) >
			| 1 < Frequency List : bit**> } }< CELL_GLOBAL_COUNT : bit (2) >
		< B22_COUNT : bit >
		{ 0		-- all following parameters are same as in current cell
		| 1	{  0  		-- talker priority not supported
			| 1  < Priority Uplink access : bit > }
				{ 0 | 1	{ 0 | 1 < FR AMR Config : bit (4) > }
						{ 0 | 1 < HR AMR Config : bit (4) > } }
				{ 0 | 1	< SMS Data Confidentiality Ind : bit (1) >
						< SMS Guaranteed Privacy Ind : bit (1) >}
				{ 0 | 1 < Max retrans : bit (2) > < Tx-Integer : bit (4) > }
			};
}


#BEGIN TS44.018,10.5.2.73
#------------------------------------
# TS 44.018, 10.5.2.73
#------------------------------------
bit-field DataIdentity {
	size: 1 octet;
	bit 8: DistributeToTalkersAndListeners boolean;
	bit 7: DistributeToDispatchers boolean;
	bit 6: DistributeToNetworkApplication boolean;
	bits 2-5: DI integer;
	bit 1: AI boolean  enum {
			0 = "Application-specific data"
			1 = "Confirmation of receiving application-specific data"
		};
}

#BEGIN TS44.018,10.5.2.75
#------------------------------------
# TS 44.018, 10.5.2.75
#------------------------------------
csn.1 {
	< IndividualPriorities > ::=
		{ 0 |		-- delete all stored individual priorities
		  1			-- provide individual priorities
			< GERAN_PRIORITY : bit(3) >
			{ 0 | 1	< 3G Individual Priority Parameters Description :
					< 3G Individual Priority Parameters Description struct >> }
			{ 0 | 1	< E-UTRAN Individual Priority Parameters Description :
					< E-UTRAN Individual Priority Parameters Description struct >> }
			{ 0 | 1	< T3230 timeout value : bit(3) >}
			{ null | L       -- Receiver compatible with earlier release
			    | H           -- Additions in Rel-11
			         { 0 | 1 < E-UTRAN IPP with extended EARFCNs Description :
			                   < E-UTRAN IPP with extended EARFCNs Description struct >> }
			}
			
		};

	slave < 3G Individual Priority Parameters Description struct > ::=
		{ 0 | 1	< DEFAULT_UTRAN_PRIORITY : bit(3) >}
		{ 1 < Repeated Individual UTRAN Priority Parameters : < Repeated Individual UTRAN Priority Parameters struct >> } ** 0 ;

	slave < Repeated Individual UTRAN Priority Parameters struct > ::=
		{ 0 { 1 < FDD-ARFCN : bit (14) > } ** 0 | 1 { 1 < TDD-ARFCN : bit (14) > } ** 0 }
		< UTRAN_PRIORITY : bit(3) > ;

	slave < E-UTRAN Individual Priority Parameters Description struct > ::=
		{ 0 | 1	< DEFAULT_E-UTRAN_PRIORITY : bit(3) > }
		{ 1	< Repeated Individual E-UTRAN Priority Parameters :
			< Repeated Individual E-UTRAN Priority Parameters Description struct >> } ** 0 ;

	slave < Repeated Individual E-UTRAN Priority Parameters Description struct > ::=
		{ 1 < EARFCN : bit (16) > } ** 0
		< E-UTRAN_PRIORITY : bit(3) > ;

	slave < E-UTRAN IPP with extended EARFCNs Description struct > ::=
			{ 0 | 1	< DEFAULT_E-UTRAN_PRIORITY : bit(3) > }
		{ 1	< Repeated Individual E-UTRAN PP with extended EARFCNs : 
			< Repeated Individual E-UTRAN PP with extended EARFCNs Description struct >> } ** 0 ;
	
	slave < Repeated Individual E-UTRAN PP with extended EARFCNs Description struct > ::=
		{ 1 < EARFCN_extended : bit (18) > } ** 0
		< E-UTRAN_PRIORITY : bit(3) > ;
	
		
};


#BEGIN TS44.018,10.5.2.76
#------------------------------------
# TS 44.018, 10.5.2.76
#------------------------------------
bit-field FeatureIndicator {
	size: 4 bits;
	bits 3-4: spare void default=0;
	bit 2: CS_IR integer;
	bit 1: PS_IR integer;
}

#BEGIN TS44.018,10.5.2.78
#------------------------------------
# TS 44.018, 10.5.2.78
#------------------------------------
csn.1 {
	<IPARestOctets> ::=
		{ 0 | 1	< IPA Uplink Assignment struct >}
		{ 0 | 1	< IPA Downlink Assignment struct >}
		{ 0 | 1	< IPA Single Block Uplink Assignment struct >}
		<spare padding>;
	
	slave <IPA Uplink Assignment struct> ::=
		{ 1	< Random Reference : bit (11) >
			< FN_OFFSET: bit (8) >
			< GAMMA : bit (5) >
			< TIMING_ADVANCE_VALUE : bit (6) >
			< TFI_ASSIGNMENT : bit (5) >
			< USF: bit (3) > 
			< EGPRS_CHANNEL_CODING_COMMAND : bit (4) >
			< Radio Access Capabilities Request: bit (1) >
		} ** 0	--Repeated as many times as necessary, once for each addressed device
		< TN : bit (3) >
		{ 0 	--'0' indicates that BCCH frequency shall be used
		| 1	{< Frequency Parameters: Frequency Parameters IE >}
		};
	
	slave < IPA Downlink Assignment struct> ::=
		{ 1	< TLLI : bit (32) >
			< TFI_ASSIGNMENT : bit (5) >
			< GAMMA : bit (5) >
			{ 0 |1 < TIMING_ADVANCE_VALUE : bit (6) > }
		} ** 0	--Repeated as many times as necessary, limited by the space in the message
		{ 0 | 1	< LINK_QUALITY_MEASUREMENT_MODE: bit (2) > }
		< RLC_MODE : bit >
		< TN : bit (3) >
		{ 0					--'0' indicates that BCCH frequency shall be used
		| 1	{< Frequency Parameters: Frequency Parameters IE >}
		};
	
	slave <IPA Single Block Uplink Assignment struct> ::=
		{ 1 	< Random Reference : bit (11) >
			< FN_OFFSET: bit (8) >
			< GAMMA : bit (5) >
			< TIMING_ADVANCE_VALUE : bit (6) >
			< STARTING_TIME_OFFSET: bit (6) > 
		} ** 0		--Repeated as many times as necessary, limited by the space in the message
		< TN : bit (3) >
		{ 0		--'0' indicates that BCCH frequency shall be used
		| 1 {< Frequency Parameters: Frequency Parameters IE >}
		};
}

#BEGIN TS44.018,10.5.2.82
#------------------------------------
# TS 44.018, 10.5.2.82
#------------------------------------
bit-field ExtendedTSCSet {
	size: 8 bits;
	bits 6-8: SecondaryPSDomainTSCValue integer;
	bit 5: SecondaryPSDomainTSCSet integer;
	bit 4: PrimaryPSDomainTSCSet integer;
	bit 3: SecondPSDomainTSCAssigned integer;
	bit 1-2: CSDomainTSCSet integer;
}

#BEGIN TS44.018,10.5.3.5
#------------------------------------
# TS 44.018, 10.5.3.5
#------------------------------------
bit-field LocationUpdType {
	size: 4 bits;
	bit 4: FOR boolean;
	bit 3: spare void default=0;
	bits 1-2: LUT integer;
}

#BEGIN TS44.018,10.5.5.17
#------------------------------------
# TS 44.018, 10.5.5.17
#------------------------------------
bit-field UpdateResult {
	size: 4 bits;
	bits 4: spare void default=0;
	bits 1-3: value integer;
}



#BEGIN TS24.008,10.5.1.3
#------------------------------------
# TS 24.008, 10.5.1.3
#------------------------------------
bit-field RRLocationAreaId {
	size: 5 octets;
	octet 1	bits 5-8: MCC2 integer;
	octet 1	bits 1-4: MCC1 integer;
	octet 2	bits 5-8: MNC3 integer;
	octet 2	bits 1-4: MCC3 integer;
	octet 3	bits 5-8: MNC2 integer;
	octet 3	bits 1-4: MNC1 integer;
	octet 5 bits 1-16: LAC integer;
}

#BEGIN TS24.008,10.5.1.4
#------------------------------------
# TS 24.008, 10.5.1.4
#------------------------------------
dcl-type RRMobileId {
	size 1 octet ... 9 octets;
	type struct {
		# If TMSI/P-TMSI it is coded using 4 digits of IdentityDigit
		IdentityDigit: sequence [17] integer;
		IdentityType:  integer enum {
			b001 = "IMSI"
			b010 = "IMEI"
			b011 = "IMEISV"
			b100 = "TMSI/P-TMSI/M-TMSI"
			b101 = "TMGI and optional MBMS Session Identity"
			b000 = "No Identity"
		};
	}

  encode %{
  	int i;

		if (Source->IdentityType == 4) {
	  	/* Push digit 1 */
 			PUSH_INT (0xf4, 8);

 			/* Push the values */
 			for (i=0; i<Source->IdentityDigit.items; i++) {
 				PUSH_INT (Source->IdentityDigit.data [i], 8);
 			}
			return (Source->IdentityDigit.items + 1) << 3;
		} else {

	  	/* Push digit 1 */
	 		PUSH_INT (Source->IdentityDigit.items == 0? 15 : Source->IdentityDigit.data [0], 4);

	 		/* Push odd/even indicator */
	  	PUSH_INT ((Source->IdentityDigit.items & 1) ? 1 : 0, 1);

	  	/* Push identity type */
	  	PUSH_INT (Source->IdentityType, 3);

	  	/* Push remaining digits */
	  	for (i=1; i<Source->IdentityDigit.items; i+=2) {
	  		PUSH_INT (i+1 >= Source->IdentityDigit.items? 15 : Source->IdentityDigit.data [i+1], 4);
	  		PUSH_INT (Source->IdentityDigit.data [i], 4);
	  	}
			return ((Source->IdentityDigit.items >> 1) << 3) + 8;
	  }
  }%

  decode %{
  	int i, odd;

  	/* Shift digit 1 (we don't know yet whether it is valid or not) */
  	i = SHIFT_INT (4);

  	/* Shift odd indicator */
  	odd = SHIFT_INT (1);

		/* Now we know exactly how many items to expect */
  	SETITEMS_c_RRMobileId_IdentityDigit (&Destin->IdentityDigit, (Length >> 2) - (odd ? 1 : 2));

  	/* Now we know whether digit 1 is valid or not */
  	if (Destin->IdentityDigit.items > 0) Destin->IdentityDigit.data [0] = i;

		/* Extract identity type */
		Destin->IdentityType = SHIFT_INT (3);

		/* If decoding a TMSI/P-TMSI, just get the following bytes */
		if (Destin->IdentityType == 4) {
			SETITEMS_c_RRMobileId_IdentityDigit (&(Destin->IdentityDigit), (Length>>3) - 1);
			for (i=0; i < Destin->IdentityDigit.items; i++) {
				Destin->IdentityDigit.data [i] = SHIFT_INT (8);
			}
		}
		else {
	  	/* Get the remaining digits */
	  	for (i=1; i < Destin->IdentityDigit.items; i+=2) {
	  		if (i+1 >= Destin->IdentityDigit.items) {
	  			SHIFT_INT (4); /* Discard it! */
	  		}
	  		else {
	  			Destin->IdentityDigit.data [i+1] = SHIFT_INT (4);
	  		}
	 			Destin->IdentityDigit.data [i] = SHIFT_INT (4);
	  	}
		}
		return Length;
  }%
}

#BEGIN TS24.008,10.5.1.7
#------------------------------------
# TS 24.008, 10.5.1.7
#------------------------------------
csn.1 {

	<RRClassmark3Value> ::=
		< spare bit >
		{	< Multiband supported : { 000 } >
				< A5_CM3 bits >
		|	< Multiband supported : { 101 | 110 } >
				< A5_CM3 bits >
				< Associated Radio Capability 2 : bit(4) >
				< Associated Radio Capability 1 : bit(4) >
		|	< Multiband supported : { 001 | 010 | 100 } >
				< A5_CM3 bits >
				< spare bit >(4)
				< Associated Radio Capability 1 : bit(4) > }
		{ 0 | 1 < R Support > }
		{ 0 | 1 < HSCSD Multi Slot Capability > }
		< UCS2 treatment: bit >
		< Extended Measurement Capability : bit >
		{ 0 | 1 < MS measurement capability > }
		{ 0 | 1 < MS Positioning Method Capability > }
		{ 0 | 1 < ECSD Multi Slot Capability > }
		{ 0 | 1 < 8-PSK Struct > }
		{ 0 | 1 < GSM 400 Bands Supported {octet enum {
			b01 = "T-GSM 380 supported, T-GSM 410 not supported"
			b10 = "T-GSM 410 supported, T-GSM 380 not supported"
			b11 = "T-GSM 410 supported, T-GSM 380 supported"
		}}: { 01 | 10 | 11 } >
				< GSM 400 Associated Radio Capability: bit(4) > }

		{ 0 | 1 <GSM 850 Associated Radio Capability : bit(4) > }
		{ 0 | 1 <GSM 1900 Associated Radio Capability : bit(4) > }
		< UMTS FDD Radio Access Technology Capability : bit >
		< UMTS 3.84 Mcps TDD Radio Access Technology Capability : bit >
		< CDMA 2000 Radio Access Technology Capability : bit >

		{ 0 | 1	< DTM GPRS Multi Slot Class : bit(2) >
				< Single Slot DTM : bit >
				{0 | 1< DTM EGPRS Multi Slot Class : bit(2) > } }
		{ 0 | 1 < Single Band Support > } 								-- Release 4 starts here:
		{ 0 | 1 <GSM 750 Associated Radio Capability : bit(4)>}

		< UMTS 1.28 Mcps TDD Radio Access Technology Capability : bit >
		< GERAN Feature Package 1 : bit >

		{ 0 | 1 < Extended DTM GPRS Multi Slot Class {octet enum {
			b00 = "Unused. If received, the network shall interpret this as '01'"
			b01 = "Multislot class 5 supported"
			b10 = "Multislot class 9 supported"
			b11 = "Multislot class 11 supported"
		}}: bit(2) >
				< Extended DTM EGPRS Multi Slot Class : bit(2) > }

		{ 0 | 1 < High Multislot Capability : bit(2) > }								---Release 5 starts here.

		{ 0 | 1 < GERAN Iu Mode Capabilities > }	-- 1 also means support of GERAN Iu mode (not used on Rev.12, kept for backward compatibility)
		< GERAN Feature Package 2 : bit >

		< GMSK Multislot Power Profile : bit (2) >
		< 8-PSK Multislot Power Profile : bit (2) >

		{ 0 | 1 < T-GSM 400 Bands Supported : { 01 | 10 | 11 } >		-- Release 6 starts here.
				< T-GSM 400 Associated Radio Capability: bit(4) > }

		{ 0 | 1 < T-GSM 900 Associated Radio Capability: bit(4) > }
		< Downlink Advanced Receiver Performance : bit (2)>

		< DTM Enhancements Capability : bit >

		{ 0 | 1	< DTM GPRS High Multi Slot Class : bit(3) >
				< Offset required : bit>
				{ 0 | 1 < DTM EGPRS High Multi Slot Class : bit(3) > } }

		< Repeated ACCH Capability: bit >
		{ 0 | 1 <GSM 710 Associated Radio Capability : bit(4)>} 		-- Release 7 starts here.
		{ 0 | 1 <T-GSM 810 Associated Radio Capability : bit(4)>}
		< Ciphering Mode Setting Capability : bit >

		< Additional Positioning Capabilities : bit >

		< E-UTRA FDD support : bit >											-- Release 8 starts here
		< E-UTRA TDD support : bit >
		< E-UTRA Measurement and Reporting support : bit >
		< Priority-based reselection support : bit >

		< UTRA CSG Cells Reporting : bit >							-- Release 9 starts here
		< VAMOS Level : bit(2) >
		< TIGHTER Capability : bit(2) >									-- Release 10 starts here
		< Selective Ciphering of Downlink SACCH : bit >
		< CS to PS SRVCC from GERAN to UTRA : bit(2) >			 -- Release 11 starts here
		< CS to PS SRVCC from GERAN to E-UTRA : bit(2)>
	
		< GERAN Network Sharing support : bit >
		< E-UTRA Wideband RSRQ measurements support : bit >
	
		< ER Band Support : bit >										 -- Release 12 starts here
		< UTRA Multiple Frequency Band Indicators support : bit >
		< E-UTRA Multiple Frequency Band Indicators support: bit >
		< Extended TSC Set Capability support: bit >
		< Extended EARFCN value range : bit >						-- Late addition of a release 11 feature
		< spare padding > ;

	slave < A5_CM3 bits > ::=
		< A5/7 : bit > < A5/6 : bit > < A5/5 : bit > < A5/4 : bit >  ;

	slave <R Support>::=
		< R-GSM band Associated Radio Capability : bit(3) > ;

	slave < HSCSD Multi Slot Capability > ::=
		< HSCSD Multi Slot Class : bit(5) >  ;

	slave < MS Measurement capability > ::=
		< SMS_VALUE : bit (4) >
		< SM_VALUE : bit (4) > ;

	slave < MS Positioning Method Capability > ::=
		< MS Positioning Method : bit(5) > ;

	slave < ECSD Multi Slot Capability > ::=
		< ECSD Multi Slot Class : bit(5) > ;

	slave < 8-PSK Struct> ::=
		< Modulation Capability : bit >
		{ 0 | 1 < 8-PSK RF Power Capability 1: bit(2) > }
		{ 0 | 1 < 8-PSK RF Power Capability 2: bit(2) > };

	slave < Single Band Support > ::=
		< GSM Band {octet enum {
			b0000 = "E-GSM is supported"
			b0001 = "P-GSM is supported"
			b0010 = "GSM 1800 is supported"
			b0011 = "GSM 450 is supported"
			b0100 = "GSM 480 is supported"
			b0101 = "GSM 850 is supported"
			b0110 = "GSM 1900 is supported"
			b0111 = "GSM 750 is supported"
			b1000 = "GSM 710 is supported"
			b1001 = "T-GSM 810 is supported"
		}}: bit (4) > ;

	slave < GERAN Iu Mode Capabilities > ::=
			< Length : bit (4) >		-- length in bits of Iu mode only capabilities and spare bits
			ENCODE: %{PUSH_TAG (2, CURPOS);}%
			DECODE: %{PUSH_TAG (1, Context->FinalOffset);	Context->FinalOffset = CURPOS+EDBitsToInt (BUFFER, CURPOS-4, 4);}%
		-- Additions in release 6
			< FLO Iu Capability : bit >
			<spare bits>** -- expands to the indicated length
			ENCODE: %{EDIntToBits (BUFFER, TAG(2)-7, CURPOS-TAG(2), 4);}%
			DECODE: %{Context->FinalOffset = TAG(1);}%;
}

#BEGIN TS24.008,10.5.3.14 [3GPP TS 24.008 V12.10.0 (2015-06)]
#------------------------------------
# TS 24.008, 10.5.3.14
#------------------------------------
bit-field AdditionalUpdateParameters {
	size: 4 bits;
	bits 3-4: spare void default=0;
	bit  2  : CSMO boolean;
	bit  1  : CSMT boolean;
}

#BEGIN TS24.008,10.5.5.15
#------------------------------------
# TS 24.008, 10.5.5.15
#------------------------------------
bit-field RoutingAreaIdentity {
	size: 6 octets;
	octet 1	bits 5-8: MCC2 integer;
	octet 1	bits 1-4: MCC1 integer;
	octet 2	bits 5-8: MNC3 integer;
	octet 2	bits 1-4: MCC3 integer;
	octet 3	bits 5-8: MNC2 integer;
	octet 3	bits 1-4: MNC1 integer;
	octet 5 bits 1-16: LAC integer;
	octet 6 bits 1-8: RAC integer;
}

#BEGIN TS24.008,10.5.1.6
#------------------------------------
# TS 24.008, 10.5.1.6
#------------------------------------
bit-field RRMobileStationClassmark2 {
	size: 3 octets;
	octet 1 {
		bit 8: spare1 void default = 0;
		bits 6-7: RevisionLevel octet enum {
			b00 = "Reserved for GSM phase 1"
			b01 = "Used by GSM phase 2 mobile stations"
			b10 = "Used by mobile stations supporting R99 or later versions of the protocol"
			b11 = "Reserved for future use. If the network receives a revision level specified as 'reserved for future use', then it shall use the highest revision level supported by the network."
		};
		bit 5: EsInd boolean enum {
			b0 = "Controlled Early Classmark Sending option is not implemented in the MS"
			b1 = "Controlled Early Classmark Sending option is implemented in the MS"
		};
		bit 4: A5_1 boolean enum {
			b0 = "encryption algorithm A5/1 available"
			b1 = "encryption algorithm A5/1 not available"
		};
		bits 1-3: RFPowerCapability octet enum {
			b000 = "class 1"
			b001 = "class 2"
			b010 = "class 3"
			b011 = "class 4"
			b100 = "class 5"
			b111 = "RF Power capability is irrelevant in this information element"
		};
	};
	octet 2 {
		bit 8: spare2 void default = 0;
		bit 7: PSCapability boolean enum {
			b0 = "PS capability not present"
			b1 = "PS capability present"
		};
		bits 5-6: SSScreenIndicator integer;
		bit 4: SMCapability boolean enum {
			b0 = "Mobile station does not support mobile terminated point to point SMS"
			b1 = "Mobile station supports mobile terminated point to point SMS"
		};
		bit 3: VBS boolean enum {
			b0 = "no VBS capability or no notifications wanted"
			b1 = "VBS capability and notifications wanted"
		};
		bit 2: VGCS boolean enum {
			b0 = "no VGCS capability or no notifications wanted"
			b1 = "VGCS capability and notifications wanted"
		};
		bit 1: FC boolean enum {
			b0 = "The MS does not support the E-GSM or R-GSM band (For definition of frequency bands see 3GPP TS 45.005 [33])"
			b1 = "The MS does support the E-GSM or R-GSM (For definition of frequency bands see 3GPP TS 45.005 [33])"
		};
	};
	octet 3 {
		bit 8: CM3 boolean enum {
			b0 = "The MS does not support any options that are indicated in CM3"
			b1 = "The MS supports options that are indicated in classmark 3 IE"
		};
		bit 7: spare3 void default = 0;
		bit 6: LCSVA_CAP boolean enum {
			b0 = "location request notification via CS domain not supported"
			b1 = "location request notification via CS domain supported"
		};
		bit 5: UCS2 boolean enum {
			b0 = "the ME has a preference for the default alphabet (defined in 3GPP TS 23.038 [8b]) over UCS2."
			b1 = "the ME has no preference between the use of the default alphabet and the use of UCS2."
		};
		bit 4: SoLSA boolean enum {
			b0 = "The ME does not support SoLSA."
			b1 = "The ME supports SoLSA."
		};
		bit 3: CMSP boolean enum {
			b0 = "Network initiated MO CM connection request not supported."
			b1 = "Network initiated MO CM connection request supported for at least one CM protocol."
		};
		bit 2: A5_3 boolean enum {
			b0 = "encryption algorithm A5/3 not available"
			b1 = "encryption algorithm A5/3 available"
		};
		bit 1: A5_2 boolean enum {
			b0 = "encryption algorithm A5/2 not available"
			b1 = "Not used. This value was allocated in earlier versions of the protocol."
		};
	};
}


#BEGIN TS44.060,12.5.2
#------------------------------------
# TS 44.060, 12.5.2
# EGPRS Window Size IE
#------------------------------------
csn.1 {
	slave < EGPRS Window Size IE > ::= <Window Size: bit (5)>;
}

#BEGIN TS44.060,12.5.5
#------------------------------------
# TS 44.060, 12.5.5
# EGPRS Channel Quality Report Type 2
#------------------------------------
csn.1 {
	slave < PDCH Pairs Description IE > ::=
		{ 0						-- Single Carrier Assignment
			{ 00					-- Default PDCH pair configuration
			| 01					-- Unchanged
			| 10					-- Explicit PDCH pair configuration
				< DOWNLINK_PDCH_PAIRS_C1 : bit (8) >
				< UPLINK_PDCH_PAIRS_C1 : bit (8) >
			! < PDCH pairs configuration error : { 1 1 } {bit (*) = < no string >} >  		-- reserved
			}
		| 1						-- Dual  Carrier Assignment
			{ 00					-- Default PDCH pair configuration
			| 01					-- Unchanged
			| 10					-- Explicit PDCH pair configuration
				< DOWNLINK_PDCH_PAIRS_C1 : bit (8) >
				< DOWNLINK_PDCH_PAIRS_C2 : bit (8) >
				< UPLINK_PDCH_PAIRS_C1 : bit (8) >
				< UPLINK_PDCH_PAIRS_C2 : bit (8) >
			! < PDCH pairs configuration error : { 1 1 } {bit (*) = < no string >} >  		-- reserved
			}
		} ;
}

#BEGIN TS44.060,12.10a
#------------------------------------
# TS 44.060, 12.10a
# GPRS Mobile Allocation
#------------------------------------
csn.1 {
	slave < GPRS Mobile Allocation IE > ::=
		< HSN : bit (6) >
		{ 0 | 1	< RFL number list : < RFL number list struct > > }
		{ 0	< MA_LENGTH : bit (6) >
			< MA_BITMAP : bit (val(MA_LENGTH) + 1) >
		| 1	{ 0 | 1	< ARFCN index list : < ARFCN index list struct > > } } ;
	slave < RFL number list struct > ::=
		< RFL_NUMBER : bit (4) >
		{ 0 | 1	< RFL number list struct > } ;
	slave < ARFCN index list struct > ::=
		< ARFCN_INDEX : bit (6) >
		{ 0 | 1	< ARFCN index list struct > } ;
}

#BEGIN TS44.060,12.10d
#------------------------------------
# TS 44.060, 12.10d
#------------------------------------
csn.1 {

	-- The definition of the entries below is missing from 44.060
	-- It could be incorrect.
	slave < EGPRS Modulation and Coding IE > ::= <Scheme: bit (4)>;

	slave < EGPRS Modulation and Coding Scheme IE > ::= < EGPRS Modulation and coding Scheme >;
	slave < EGPRS Modulation and coding Scheme > ::= <Scheme {octet enum {
			b0000 = "MCS-1"
			b0001 = "MCS-2"
			b0010 = "MCS-3"
			b0011 = "MCS-4"
			b0100 = "MCS-5"
			b0101 = "MCS-6"
			b0110 = "MCS-7"
			b0111 = "MCS-8"
			b1000 = "MCS-9"
			b1001 = "MCS-5-7"
			b1010 = "MCS-6-9"
			default = "reserved"
		}}: bit (4)>;
}

#BEGIN TS44.060,12.10f
#------------------------------------
# TS 44.060, 12.10f
# RESEGMENT IE
#------------------------------------
csn.1 {
	slave < EGPRS Level IE > ::= <EGPRS Level: bit (2)>;
}

#BEGIN TS44.060,12.12
#------------------------------------
# TS 44.060, 12.12
# Packet Timing Advance
#------------------------------------
csn.1 {
	slave < Packet Timing Advance IE > ::=
		{ 0 | 1	< TIMING_ADVANCE_VALUE : bit (6) > }
		{ 0 | 1	< TIMING_ADVANCE_INDEX : bit (4) >
				< TIMING_ADVANCE_TIMESLOT_NUMBER : bit (3) > } ;
}

#BEGIN TS44.060,12.13
#------------------------------------
# TS 44.060, 12.13
# Power Control Parameters
#------------------------------------
csn.1 {
	slave < Power Control Parameters IE > ::=
		< ALPHA : bit (4) >
		{ 0 | 1 < GAMMA_TN0 : bit (5) > }
		{ 0 | 1 < GAMMA_TN1 : bit (5) > }
		{ 0 | 1 < GAMMA_TN2 : bit (5) > }
		{ 0 | 1 < GAMMA_TN3 : bit (5) > }
		{ 0 | 1 < GAMMA_TN4 : bit (5) > }
		{ 0 | 1 < GAMMA_TN5 : bit (5) > }
		{ 0 | 1 < GAMMA_TN6 : bit (5) > }
		{ 0 | 1 < GAMMA_TN7 : bit (5) > } ;

}

#BEGIN TS44.060,12.21
#------------------------------------
# TS 44.060, 12.21
# Starting Frame Number Description
#------------------------------------
csn.1 {
	slave < Starting Frame Number Description IE > ::=
		{ 0 < Absolute Frame Number Encoding >
		| 1 < Relative Frame Number Encoding > } ;
}

#BEGIN TS44.060,12.21.1
#------------------------------------
# TS 44.060, 12.21.1
#------------------------------------
csn.1 {
	slave < Absolute Frame Number Encoding > ::=
		<T1: bit (5)>
		<T3: bit (6)>
		<T2: bit (5)> ;
}

#BEGIN TS44.060,12.21.2
#------------------------------------
# TS 44.060, 12.21.2
#------------------------------------
csn.1 {
	slave < Relative Frame Number Encoding > ::=
		<k: bit (13)>;
}

#BEGIN TS44.060,12.24
#------------------------------------
# TS 44.060, 12.24
# GPRS Cell Options
#------------------------------------
csn.1 {
	slave < GPRS Cell Options IE > ::=
		< NMO {octet enum {
				b00 = "Network Mode of Operation I"
				b01 = "Network Mode of Operation II"
				b10 = "Network Mode of Operation III"
				b11 = "Reserved."

			}} : bit (2) >
		< T3168 : bit (3) >
		< T3192 {octet enum {
				b000 = "500 ms"
				b001 = "1000 ms"
				b010 = "1500 ms"
				b011 = "0 ms"
				b100 = "80 ms"
				b101 = "120 ms"
				b110 = "160 ms"
				b111 = "200 ms"

			}} : bit (3) >
		< DRX_TIMER_MAX : bit (3) >
		< ACCESS_BURST_TYPE {boolean enum {
				b0 = "8-bit format shall be used"
				b1 = "11-bit format shall be used"

			}} : bit >
		< CONTROL_ACK_TYPE {boolean enum {
				b0 = "default format is four access bursts"
				b1 = "default format is RLC/MAC control block."

			}} : bit >
		< BS_CV_MAX : bit (4) >
		{ 0
			|
			1 < PAN_DEC : bit (3) >
			< PAN_INC : bit (3) >
			< PAN_MAX : bit (3) >
		}

		-- Optional extension information:
		{
			0
			|
			1 <ext:
				ENCODE: %{
					/* Save the position of the length. This allows us to
					   write it back when encoding */
					PUSH_TAG (1, CURPOS);
				}%
				DECODE: %{
					PUSH_TAG (20, Context->FinalOffset);
					Context->FinalOffset = CURPOS + EDBitsToInt (BUFFER, CURPOS, 6)+7;
				}%
				<bit>*6 -- Extension Length: we removed the label because we manage it automatically
					{
						<Extension Information>
					}
					ENCODE: %{
						/* We save the effective length-1 in the "Extension Length" field */
						EDIntToBits (BUFFER, TAG(1), CURPOS-TAG(1)-7, 6);
					}%
					DECODE: %{
						Context->FinalOffset = TAG (20);
					}%
			>
		} ;

	slave < Extension Information> ::=
		{{ -- R99 Extension
		{ 0 | 1 -- EGPRS supported by the cell if the choice bit is set to '1'
			<EGPRS_PACKET_ CHANNEL_REQUEST {boolean enum {
				b0 = "EGPRS capable MSs shall use EGPRS PACKET CHANNEL REQUEST message for uplink TBF establishment on the PRACH when there is a PBCCH in the cell or on the RACH when there is no PBCCH in the cell."
				b1 = "EGPRS capable MSs shall use two phase packet access with PACKET CHANNEL REQUEST message on the PRACH for uplink TBF establishment when there is a PBCCH in the cell. EGPRS capable MSs shall use two phase packet access with CHANNEL REQUEST message on the RACH when there is no PBCCH in the cell."

			}} : bit>
			< BEP_PERIOD : bit (4) >
		}
		<PFC_FEATURE_MODE {boolean enum {
				b0 = "The network does not support packet flow context procedures."
				b1 = "The network supports packet flow context procedures."

			}}: bit>
		<DTM_SUPPORT {boolean enum {
				b0 = "The cell does not support DTM procedures."
				b1 = "The cell supports DTM procedures."

			}}: bit>
		<BSS_PAGING_COORDINATION {boolean enum {
				b0 = "The cell does not support Circuit-Switched paging coordination"
				b1 = "The cell supports Circuit-Switched paging coordination"

			}}: bit>}
		{	-- REL-4 extension:
			< CCN_ACTIVE {boolean enum {
				b0 = "CCN is disabled in the cell."
				b1 = "CCN is enabled in the cell."

			}} : bit >
			< NW_EXT_UTBF {boolean enum {
				b0 = "The extended uplink TBF mode is not supported by the network."
				b1 = "The extended uplink TBF mode is supported by the network."

			}} : bit > }
			{	-- REL 6 extension:
					< MULTIPLE_TBF_CAPABILITY : bit >
					< EXT_UTBF_NODATA : bit >
					< DTM_ENHANCEMENTS_CAPABILITY : bit >
					{ 0			-- MBMS procedures not supported by the cell if the choice bit is set to '0'
					| 1			-- MBMS procedures supported by the cell if the choice bit is set to '1'
						< DEDICATED_MODE_MBMS_NOTIFICATION_SUPPORT: bit >
						< MNCI_SUPPORT : bit > } }
			{	-- Rel-7 extension:
				< REDUCED_LATENCY_ACCESS : bit >}

			< spare bit > ** } // ;		-- Extension information may be truncated between released versions of the protocol.
										-- The receiver shall assume the value zero for any truncated bit.

}

#BEGIN TS44.060,12.33
#------------------------------------
# TS 44.060, 12.33
#------------------------------------
csn.1 {
	slave <TMGI struct> ::= < TMGI IE >;
	slave < TMGI IE > ::=
		{ 0													-- without MCC and MNC parameters
			< MBMS SERVICE ID : bit (24) >
		| 1													-- with MCC and MNC parameters
			< MBMS SERVICE ID : bit (24) >
			< MCC : bit (12) >
			< MNC : bit (12) > } ;

}

#BEGIN TS44.060,12.36
#------------------------------------
# TS 44.060, 12.36
#------------------------------------
csn.1 {
	slave < MBMS Channel Parameters IE >::=
		{ 0										-- counting is off
			{ 0 | 1	< MBMS p-t-m channel description : < MBMS p-t-m channel description IE > >
					< MBMS Session Parameters List : < MBMS Session Parameters List IE >> }
		| 1										-- counting is on
			{ 0 | 1	< MPRACH description : < MPRACH description IE > > } };

}

#BEGIN TS44.060,12.37
#------------------------------------
# TS 44.060, 12.37
#------------------------------------
csn.1 {
	slave < MBMS p-t-m channel description IE > ::=
		{ 0 | 1 < Frequency Parameters : < Frequency Parameters IE > > }
		< DL_TIMESLOT_ALLOCATION : bit (8) >;
}

#BEGIN TS44.060,12.38
#------------------------------------
# TS 44.060, 12.38
#------------------------------------
csn.1 {
	slave < MPRACH description IE > ::=
		{ 0 | 1 < Frequency Parameters : < Frequency Parameters IE > > }
		< MPRACH_TIMESLOT NUMBER : bit (3) >
		< USF : bit (3) >
		{ 0 | 1		< MPRACH Control Parameters : < MPRACH Control Parameters IE > > } ;

}

#BEGIN TS44.060,12.39
#------------------------------------
# TS 44.060, 12.39
#------------------------------------
csn.1 {
	slave < MBMS Sessions List IE > ::=
		{ 1	< TMGI : < TMGI IE >>
			{ 0 | 1 < MBMS Session Identity : bit (8) > } } ** 0;

}

#BEGIN TS44.060,12.40
#------------------------------------
# TS 44.060, 12.40
#------------------------------------
csn.1 {
	slave< MBMS Session Parameters List IE > ::=
		{ 1	< Length of MBMS Bearer Identity : bit (3) > -- Configurations 000, 110 and 111 are reserved
		< MBMS Bearer Identity : bit (val (Length of MBMS Bearer Identity)) >
		< Estimated Session Duration : bit (8) >
		{ 0 | 1	< MBMS Radio Bearer Starting Time : bit (16) > }
		{ 0 | 1	< EGPRS Window Size : < EGPRS Window Size IE >> }
		{ 0 | 1	< NPM Transfer Time : bit (5) > } } ** 0;
}

#BEGIN TS44.060,12.41
#------------------------------------
# TS 44.060, 12.41
#------------------------------------
csn.1 {
	slave < MPRACH Control Parameters IE > ::=
		{ 0 | 1< ACC_CONTR_CLASS : bit (16) > }
		{ 0 | 1< MAX_RETRANS : bit (2) > }
		< S : bit (4) >
		{ 0 | 1 < TX_INT : bit (4) > }
		{ 0 | 1 < PERSISTENCE_LEVEL : bit (4) > } ;

}

#BEGIN TS44.060,12.57
#------------------------------------
# TS 44.060, 12.57
# PCID Group
#------------------------------------
csn.1 {
	slave < PCID Group IE > ::=
		{ 1 < PCID : bit (9) > } ** 0   -- explicit PCID coding
		{ 0 | 1	< PCID_BITMAP_GROUP : bit (6) > }
		{ 1 < PCID_Pattern_length : bit (3) >
			< PCID_Pattern : bit (val(PCID_Pattern_length) + 1) >
			< PCID_pattern_sense : bit (1) >
		} ** 0 ;
}

#BEGIN TS44.060,12.58
#------------------------------------
# TS 44.060, 12.58
# PSC Group
#------------------------------------
csn.1 {
	slave < PSC Group IE > ::=
		{ 1 < PSC : bit (9) > } ** 0				-- explicit PSC coding
		{ 1 < PSC_Pattern_length : bit (3) >
			< PSC_Pattern : bit (val(PSC_Pattern_length) + 1) >
			< PSC_pattern_sense : bit (1) >
		} ** 0 ;
}

#BEGIN TS44.060,12.59
#------------------------------------
# TS 44.060, 12.59
# Enhanced Cell Reselection Parameters
#------------------------------------
csn.1 {
	slave < Enhanced Cell Reselection Parameters IE > ::=
		{ 1	< Repeated E-UTRAN Enhanced Cell Reselection Parameters :
			< Repeated E-UTRAN Enhanced Cell Reselection Parameters struct >> } ** 0 ;

	slave < Repeated E-UTRAN Enhanced Cell Reselection Parameters struct > ::=
		{ 1	< E-UTRAN_FREQUENCY_INDEX : bit (3) > } ** 0
		{ 0										-- reselection based on target cell RSRP (RSRQ checked for suitability)
			< E-UTRAN_Qmin: bit(4) >
		| 1										-- reselection based on target cell RSRQ (RSRP checked for suitability)
			< THRESH_E-UTRAN_high_Q: bit(5) >
			{ 0 | 1	< THRESH_E-UTRAN_low_Q: bit(5) > }
			{ 0 | 1	< E-UTRAN_QQUALMIN : bit(4) > }
			{ 0 | 1	< E-UTRAN_RSRPmin : bit(5) > }
		} ;

}

#BEGIN TS44.060,12.60
#------------------------------------
# TS 44.060, 12.60
# E-UTRAN CSG Measurement Report
#------------------------------------
csn.1 {
	slave < E-UTRAN CSG Measurement Report IE > ::=
		< E-UTRAN CI : bit (28) >
		< Tracking Area Code : bit (16) >
		{ 0	| 1	< PLMN-ID : < PLMN-ID struct > > }
		< CSG-ID : bit (27) >
		< Access Mode : bit (1) >
		< REPORTING_QUANTITY : bit (6) > ;

	slave < PLMN-ID struct > ::=
		< MCC : bit (12) >
		< MNC : bit (12) > ;
}

#BEGIN TS44.060,12.61
#------------------------------------
# TS 44.060, 12.61
# UTRAN CSG Measurement Report
#------------------------------------
csn.1 {
	slave < UTRAN CSG Measurement Report IE > ::=
		{ 0	| 1	< UTRAN CGI : bit (28) > }
		{ 0	| 1	< PLMN-ID : < PLMN-ID struct > > }
		< CSG-ID : bit (27) >
		< Access Mode : bit (1) >
		< REPORTING_QUANTITY : bit (6) > ;
}

#BEGIN TS44.060,12.7
#------------------------------------
# TS 44.060, 12.7
# Channel Request Description
#------------------------------------
csn.1 {
	slave < Channel Request Description IE > ::=
		< PEAK_THROUGHPUT_CLASS : bit (4) >
		< RADIO_PRIORITY : bit (2) >
		< RLC_MODE {boolean enum {
				b0 = "RLC acknowledged mode"
				b1 = "RLC unacknowledged mode"

			}} : bit (1) >
		< LLC_ PDU_TYPE {boolean enum {
				b0 = "LLC PDU is SACK or ACK"
				b1 = "LLC PDU is not SACK or ACK"

			}} : bit (1) >
		< RLC_OCTET_COUNT : bit (16) > ;
}

#BEGIN TS44.060,12.8
#------------------------------------
# TS 44.060, 12.8
# Frequency Parameters
#------------------------------------
csn.1 {
	slave < Frequency Parameters IE > ::=
		< TSC : bit (3) >
		{ 00 < ARFCN : bit (10) >
		| 01 < Indirect encoding : < Indirect encoding struct > >
		| 10 < Direct encoding 1 : < Direct encoding 1 struct > >
		| 11 < Direct encoding 2 : < Direct encoding 2 struct > > } ;

	slave < Indirect encoding struct > ::=
		< MAIO : bit (6) >
		< MA_NUMBER : bit (4) >
		{ 0 | 1	< CHANGE_MARK_1 : bit (2) >
				{ 0 | 1 < CHANGE_MARK_2 : bit (2) > } } ;

	slave < Direct encoding 1 struct > ::=
		< MAIO : bit (6) >
		< GPRS Mobile Allocation : < GPRS Mobile Allocation IE > > ;

	slave < Direct encoding 2 struct > ::=
		< MAIO : bit (6) >
		< HSN : bit (6) >
		< Length of MA Frequency List contents : bit (4) >
		< MA Frequency List contents : octet (val(Length of MA Frequency List contents) + 3) > ;

}

#BEGIN TS44.060,12.8.2
#------------------------------------
# TS 44.060, 12.8.2
# Dual Carrier Frequency Parameters
#------------------------------------
csn.1 {
	slave < Dual Carrier Frequency Parameters IE > ::=
		< TSC : bit (3) >
		{ 00
			{ 0 | 1 < ARFCN1 : bit (10) >
				< ARFCN2 : bit (10) > }
		| 01 < Indirect encoding : < Dual Carrier Indirect encoding struct > >
		| 10 < Direct encoding 1 : < Dual Carrier Direct encoding 1 struct > >
		| 11 < Direct encoding 2 : < Dual Carrier Direct encoding 2 struct > > } ;

	slave < Dual Carrier Direct encoding 1 struct > ::=
		{ 0 | 1 < MAIO1 : bit (6) > }
		{ 0 | 1 < MAIO2 : bit (6) > }
		< GPRS Mobile Allocation : < GPRS Mobile Allocation IE > > ;

	slave < Dual Carrier Indirect encoding struct > ::=
		{ 0 | 1 < MAIO1 : bit (6) > }
		{ 0 | 1 < MAIO2 : bit (6) > }
		< MA_NUMBER : bit (4) >
		{ 0 | 1	< CHANGE_MARK_1 : bit (2) >
				{ 0 | 1 < CHANGE_MARK_2 : bit (2) > } } ;

	slave < Dual Carrier Direct encoding 2 struct > ::=
		{ 0 | 1 < MAIO1 : bit (6) > }
		{ 0 | 1 < MAIO2 : bit (6) > }
		< HSN : bit (6) >
		< Length of MA Frequency List contents : bit (4) >
		< MA Frequency List contents : octet (val(Length of MA Frequency List contents) + 3) > ;
}

#BEGIN TS44.060,12.8.3
#------------------------------------
# TS 44.060, 12.8.3
# Pulse Format description
#------------------------------------
csn.1 {
	slave < Pulse Format IE > ::=
		{ 0 < Pulse Format Coding 1 : bit (3) >
	| 1 < Pulse Format Coding 2 : < Pulse Format Coding 2 struct > > };

	slave < Pulse Format Coding 2 struct > ::=
		{  0	< Pulse Format Bitmap Length: bit (7) >
			< Pulse Format Bitmap:
				bit (val (Pulse Format Bitmap Length) + 1)
	 			& { { 1 | 01 | 00 } ** ! { bit** = <no string> } } >
		| 1	< Non Hopping Carrier Pulse Format : 1 | 01 | 00 >
		} ;
}

#BEGIN TS44.060,12.9a
#------------------------------------
# TS 44.060, 12.9a
#------------------------------------
csn.1 {
	slave < GPRS Power Control Parameters IE > ::=
		< ALPHA : bit (4) >
		< T_AVG_W : bit (5) >
		< T_AVG_T : bit (5) >
		< PC_MEAS_CHAN : bit >
		< N_AVG_I : bit (4) > ;
}

#BEGIN TS44.060,12.10
#------------------------------------
# TS 44.060, 12.10
# Global TFI
#------------------------------------
csn.1 {
	slave < Global TFI IE > ::=
		{ 0 < UPLINK_TFI : bit (5) >
		| 1 < DOWNLINK_TFI : bit (5) > } ;

}

#BEGIN TS44.060,12.11
#------------------------------------
# TS 44.060, 12.11
# Packet Request Reference
#------------------------------------
csn.1 {
	slave < Packet Request Reference IE > ::=
		< RANDOM_ACCESS_INFORMATION value : bit (11) >
		< FRAME_NUMBER : bit (16) > ;

}

#BEGIN TS44.060,12.16
#------------------------------------
# TS 44.060, 12.16
# TLLI / G-RNTI IE
#------------------------------------
csn.1 {
	slave < TLLI / G-RNTI IE > ::= <TLLI / G-RNTI: bit (32)>;
}

#BEGIN TS44.060,12.29
#------------------------------------
# TS 44.060, 12.29
# COMPACT reduced MA
#------------------------------------
csn.1 {
	slave < COMPACT reduced MA IE > ::=
		<Length of Reduced MA bitmap : bit (7) >
		<Reduced MA bitmap : bit( val( Length of Reduced MA bitmap ) ) >
		{ 0 | 1 <MAIO_2 : bit(6) >};
}

#BEGIN TS44.060,11.2.29
#------------------------------------
# TS 44.060, 11.2.29
# Packet Uplink Assignment
#------------------------------------
csn.1 {
	slave <Single Block Allocation struct > ::=
		< TIMESLOT_NUMBER : bit (3) >
		{ 0 | 1 < ALPHA : bit (4) >
		< GAMMA_TN : bit (5) >}
		{ 0 | 1 < P0 : bit (4) >
				0				-- The value '1' was allocated in an earlier version of the protocol and shall not be used.
				< PR_MODE {boolean enum {
				b0 = "PR mode A: for one addressed MS"
				b1 = "PR mode B: for all MS"

			}} : bit (1) > }
		< TBF Starting Time : < Starting Frame Number Description IE > > ;

}

#------------------------------------
# TS 44.018, Table 9.1.54.1a
#------------------------------------
bit-field FDD_CELL_INFORMATION_ITEM {
	size: 10 bits;
	bits 10: Diversity boolean;
	bits 1-9: ScramblingCode integer;
}

#------------------------------------
# TS 44.018, Table 9.1.54.1a
#------------------------------------
dcl-type FDD_CELL_INFORMATION {
	size 0 octets ... 122 bits;
	type sequence [16] FDD_CELL_INFORMATION_ITEM;
	
	encode %{
		/* ENCODING NOT YET SUPPORTED */
		return 0;
	}%
	decode %{
		/* FDD "W" words, encoded in Range-1024 format */
		#define MAX_FDD_Ws 16
		unsigned W [MAX_FDD_Ws];
		unsigned CellInfo [16];
		unsigned remaining = (unsigned)Length;
		unsigned i;
		int used = 0;
		unsigned records;
		static const unsigned R1024 [] = {10, 9, 9, 8, 8, 8, 8, 7, 7, 7, 7, 7, 7, 7, 7, 6};
		
		/* Decode the Range-1024 bits locally */
		for (i=0; i<MAX_FDD_Ws; i++) {
			if (remaining >= R1024 [i]) {
				W [i] = SHIFT_INT (R1024 [i]);
				remaining -= R1024 [i];
				used ++;
			}
			else break;
		}
		
		records = DECODE_AnnexJ (W, used, CellInfo, 16, 1023, 1);
		
		SETITEMS_c_FDD_CELL_INFORMATION (Destin, records);
		for (i=0; i<records; i++) {
			VAR_c_FDD_CELL_INFORMATION_data (Destin->data [i]).Diversity = ((CellInfo[i] & 0x400) != 0);
			VAR_c_FDD_CELL_INFORMATION_data (Destin->data [i]).ScramblingCode = (CellInfo[i] & 0x3FF);
		}
		
		return Length;
		#undef MAX_FDD_Ws
	}%
}

#------------------------------------
# TS 44.018, Table 9.1.54.1b
#------------------------------------
dcl-type TDD_CELL_INFORMATION {
	size 0 octets ... 126 bits;
	type sequence [20] integer;
	
	encode %{
		/* ENCODING NOT YET SUPPORTED */
		return 0;
	}%
	decode %{
		/* TDD "W" words, encoded in Range-512 format */
		#define MAX_TDD_Ws 20
		unsigned W [MAX_TDD_Ws];
		unsigned CellInfo [20];
		unsigned remaining = (unsigned)Length;
		unsigned i;
		int used = 0;
		unsigned records;
		static const unsigned R512 [] = {9, 8, 8, 7, 7, 7, 7, 6, 6, 6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5};
		
		/* Decode the Range-512 bits locally */
		for (i=0; i<MAX_TDD_Ws; i++) {
			if (remaining >= R512 [i]) {
				W [i] = SHIFT_INT (R512 [i]);
				remaining -= R512 [i];
				used ++;
			}
			else break;
		}
		
		records = DECODE_AnnexJ (W, used, CellInfo, 16, 511, 1);
		
		SETITEMS_c_TDD_CELL_INFORMATION (Destin, records);
		for (i=0; i<records; i++) {
			Destin->data [i] = CellInfo[i];
		}
		
		return Length;
		#undef MAX_TDD_Ws
	}%
}
